!function(e){function t(a){if(n[a])return n[a].exports;var i=n[a]={exports:{},id:a,loaded:!1};return e[a].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){e.exports=n(118)},,function(e,t){"use strict";e.exports={env:"production",chat:"https://eco-api.meiqia.com",upload:"https://eco-api-upload.meiqia.com",socket:"https://eco-push-api-client.meiqia.com/pusher",widget:"https://eco-api.meiqia.com/dist",cdn:"https://static.meiqia.com/dist",tail:"krls1it1pnqxgvi"}},function(e,t,n){var a,i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function o(e,t){return(/string|function/.test("undefined"==typeof t?"undefined":i(t))?f:d)(e,t)}function r(e,t){return"string"!=typeof e&&(t="undefined"==typeof e?"undefined":i(e),"number"===t?e+="":e="function"===t?r(e.call(e)):""),e}function s(e){return v[e]}function l(e){return r(e).replace(/&(?![\w#]+;)|[<>"']/g,s)}function u(e,t){if(h(e))for(var n=0,a=e.length;a>n;n++)t.call(e,e[n],n,e);else for(n in e)t.call(e,e[n],n)}function c(e,t){var n=/(\/)[^\/]+\1\.\.\1/,a=("./"+e).replace(/[^\/]+$/,""),i=a+t;for(i=i.replace(/\/\.\//g,"/");i.match(n);)i=i.replace(n,"/");return i}function d(e,t){var n=o.get(e)||p({filename:e,name:"Render Error",message:"Template not found"});return t?n(t):n}function f(e,t){if("string"==typeof t){var n=t;t=function(){return new m(n)}}var a=g[e]=function(n){try{return new t(n,e)+""}catch(a){return p(a)()}};return a.prototype=t.prototype=b,a.toString=function(){return t+""},a}function p(e){var t="{Template Error}",n=e.stack||"";if(n)n=n.split("\n").slice(0,2).join("\n");else for(var a in e)n+="<"+a+">\n"+e[a]+"\n\n";return function(){return"object"==("undefined"==typeof console?"undefined":i(console))&&console.error(t+"\n\n"+n),t}}var g=o.cache={},m=this.String,v={"<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","&":"&#38;"},h=Array.isArray||function(e){return"[object Array]"==={}.toString.call(e)},b=o.utils={$helpers:{},$include:function(e,t,n){return e=c(n,e),d(e,t)},$string:r,$escape:l,$each:u},y=o.helpers=b.$helpers;o.get=function(e){return g[e.replace(/^\.\//,"")]},o.helper=function(e,t){y[e]=t},a=function(){return o}.call(t,n,t,e),!(void 0!==a&&(e.exports=a)),o("audio",function(e){"use strict";var t=this,n=(t.$helpers,t.$escape),a=e.cdn,i="";return i+='<audio id="newChat" preload="preload"> <source src="',i+=n(a),i+='/audio/new-chat.ogg" type="audio/ogg" /> <source src="',i+=n(a),i+='/audio/new-chat.mp3" type="audio/mpeg" /> </audio> <audio id="newMessage" preload="preload"> <source src="',i+=n(a),i+='/audio/new-message.ogg" type="audio/ogg" /> <source src="',i+=n(a),i+='/audio/new-message.mp3" type="audio/mpeg" /> </audio> <audio id="sentMessage" preload="preload"> <source src="',i+=n(a),i+='/audio/sent-message.ogg" type="audio/ogg" /> <source src="',i+=n(a),i+='/audio/sent-message.mp3" type="audio/mpeg" /> </audio>',new m(i)}),o("chat-has-end",'对话已结束，您可以<a class="btn-restart-chat">开始新的对话</a>或<a class="btn-go-ticket">留言</a>'),o("emoji",function(e){"use strict";var t=this,n=(t.$helpers,t.$each),a=e.list,i=(e.v,e.k,t.$escape),o="";return n(a,function(e){o+=' <i class="emoji-control emoji-',o+=i(e),o+='" onclick="window.CHOSE_EMOJI(\':',o+=i(e),o+=":')\"></i> "}),o+=' <div class="clearfix"></div>',new m(o)}),o("evaluation-basic",function(e){"use strict";var t=this,n=(t.$helpers,t.$escape),a=e.intro,i="";return i+='<div class="evaluation-header"> <a id="evaluationHide"> <i class="icon icon-times"></i> </a> <div class="intro">',i+=n(a),i+='</div> </div> <div class="evaluation-body"> <div class="evaluation-btn-group"> <input id="evaluationLevel" type="hidden" /> <div id="evaluation2" class="evaluation-btn"> <i class="icon icon-smile"></i> <span>好评</span> </div> <div id="evaluation1" class="evaluation-btn"> <i class="icon icon-neutral"></i> <span>中评</span> </div> <div id="evaluation0" class="evaluation-btn"> <i class="icon icon-angry"></i> <span>差评</span> </div> </div> <div class="evaluation-reason"> <label for="evaluationContent">请填写评价内容（选填）</label> <textarea id="evaluationContent"></textarea> <button id="evaluationSubmit">提交</button> </div> </div> ',new m(i)}),o("evaluation",function(e){"use strict";var t=this,n=(t.$helpers,t.$escape),a=e.intro,i="";return i+='<div class="evaluation-header"> <a id="evaluationHide"> <i class="icon icon-times"></i> </a> <div class="intro">',i+=n(a),i+='</div> </div> <div class="evaluation-body"> <div class="evaluation-btn-group"> <input id="evaluationLevel" type="hidden" /> <div id="evaluation2" class="evaluation-btn"> <i class="icon icon-smile"></i> <span>好评</span> </div> <div id="evaluation1" class="evaluation-btn"> <i class="icon icon-neutral"></i> <span>中评</span> </div> <div id="evaluation0" class="evaluation-btn"> <i class="icon icon-angry"></i> <span>差评</span> </div> </div> <div class="evaluation-reason"> <textarea id="evaluationContent" placeholder="请填写评价内容（选填）"></textarea> <button id="evaluationSubmit">提交</button> </div> </div> ',new m(i)}),o("features",function(e){"use strict";var t=this,n=(t.$helpers,e.emoji),a=e.photo,i=e.upload,o=e.evaluation,r="";return n&&(r+=' <a id="emojiBtn" class="feature-btn" title="表情"> <i class="icon icon-emoji"></i> </a> '),r+=" ",a&&(r+=' <label id="photoBtn" class="feature-btn" title="发送图片"> <i class="icon icon-photo"></i> <input id="photoFile" type="file" accept="image/gif, image/jpeg, image/jpg, image/png"> </label> '),r+=" ",i&&(r+=' <label id="uploadBtn" class="feature-btn" title="发送文件"> <i class="icon icon-upload"></i> <input id="uploadFile" type="file"> </label> '),r+=" ",o&&(r+=' <a id="evaluationBtn" class="feature-btn" title="评价"> <i class="icon icon-evaluation"></i> </a> '),new m(r)}),o("header-customer",function(e){"use strict";var t=this,n=(t.$helpers,e.photoType),a=t.$escape,i=e.avatar,o=e.signature,r=e.name,s="";return"small"===n&&(s+=' <img class="agent-avatar" src="',s+=a(i),s+='" alt="avatar"> '),s+=" ",s+="small"===n?' <div class="agent-info" style="margin-left: 54px"> ':' <div class="agent-info"> ',s+=' <div class="agent-name ',o||(s+="without-signature"),s+='"> ',s+=a(r),s+=' <span id="agentInputting">对方输入消息中...</span> </div> <div class="agent-signature" title="',s+=a(o),s+='">',s+=a(o),s+="</div> </div> ",new m(s)}),o("header-fusion",function(e){"use strict";var t=this,n=(t.$helpers,e.signature),a=t.$escape,i=e.name,o="";return o+='<div class="agent-info"> <div class="agent-name ',n||(o+="without-signature"),o+='"> ',o+=a(i),o+=' <span id="agentInputting">对方输入消息中...</span> </div> <div class="agent-signature" title="',o+=a(n),o+='">',o+=a(n),o+="</div> </div>",new m(o)}),o("header-loading",'<div id="loading"> 连接中<span class="dot1">.</span><span class="dot2">.</span><span class="dot3">.</span> </div>'),o("header-mondeo",function(e){"use strict";var t=this,n=(t.$helpers,e.signature),a=t.$escape,i=e.name,o="";return o+='<div class="agent-info"> <div class="agent-name ',n||(o+="without-signature"),o+='"> ',o+=a(i),o+=' <span id="agentInputting">对方输入消息中...</span> </div> <div class="agent-signature" title="',o+=a(n),o+='">',o+=a(n),o+="</div> </div>",new m(o)}),o("header",function(e){"use strict";var t=this,n=(t.$helpers,t.$escape),a=e.avatar,i=e.signature,o=e.name,r="";return r+='<img class="agent-avatar" src="',r+=n(a),r+='" alt="avatar"> <div class="agent-info"> <div class="agent-name ',i||(r+="without-signature"),r+='"> ',r+=n(o),r+=' <span id="agentInputting">对方输入消息中...</span> </div> <div class="agent-signature" title="',r+=n(i),r+='">',r+=n(i),r+="</div> </div>",new m(r)}),o("msg",function(e){"use strict";var t=this,n=(t.$helpers,t.$each),a=e.list,i=(e.v,e.k,t.$escape),o=t.$string,r=(e.rv,e.rk,e.mv,e.mk,e.historyTimes),s="";return n(a,function(e){s+=" ","bot"===e.from_type?(s+=' <div id="',s+=i(e.id),s+='" class="msg-bot"> <div class="name"> ',s+=i(e.agent.nickname),s+=" ",e.displayDate&&(s+=' <span id="date',s+=i(e.id),s+='" class="date">',s+=o(e.displayDate),s+="</span> "),s+=" </div> ","welcome"===e.content_type?(s+=' <div class="bubble"> <span class="arrow-bg"></span> <span class="arrow"></span> <div class="text"> ',s+=o(e.content),s+=" </div> </div> "):"text"===e.content_type||"bot"===e.content_type?(s+=' <div class="bubble rich-text-bubble"> <span class="arrow-bg"></span> <span class="arrow"></span> ',e.content_robot&&e.content_robot.length?(s+=" ",n(e.content_robot,function(e){s+=" ","text"===e.type?(s+=" ",e.rich_text?(s+=' <div class="text rich_text">',s+=o(e.rich_text),s+="</div> "):(s+=' <div class="text">',s+=o(e.text),s+="</div> "),s+=" "):("menu"===e.type||"related"===e.type)&&(s+=" ",e.text_before&&(s+=' <div class="menu-tips">',s+=i(e.text_before),s+="</div> "),s+=' <div class="menu"> ',e.items&&e.items.length&&(s+=" <ol>",n(e.items,function(e){s+=" <li> ",e.link?(s+=' <a class="menu-item" data-value="',s+=o(e.value),s+='" href="',s+=o(e.link),s+='" target="_blank">',s+=o(e.text),s+="</a> "):(s+=' <span class="menu-item" data-value="',s+=o(e.value),s+='">',s+=o(e.text),s+="</span> "),s+=" </li> "}),s+='</ol> <div class="menu-tips">点击问题或回复数字查看答案</div> '),s+=" </div> "),s+=" "}),s+=" "):e.content&&(s+=' <div class="text">',s+=o(e.content),s+="</div> "),s+=" ","evaluate"===e.sub_type&&(s+=' <div class="rating" data-question-id="',s+=o(e.question_id),s+='"> <a href="javascript:;;" class="option" data-option="useful">解决</a> <a href="javascript:;;" class="option" data-option="useless">未解决</a> <span class="rated-text">已反馈</span> <span class="pending-text">提交中</span> <span class="split"></span> </div> '),s+=" </div> "):"rich_text"===e.content_type?(s+=' <div class="bubble rich-text-bubble"> <span class="arrow-bg"></span> <span class="arrow"></span> <div class="text rich_text">',s+=o(e.extra.content),s+="</div> ","evaluate"===e.sub_type&&(s+=' <div class="rating" data-question-id="',s+=o(e.question_id),s+='"> <a href="javascript:;;" class="option" data-option="useful">解决</a> <a href="javascript:;;" class="option" data-option="useless">未解决</a> <span class="rated-text">已反馈</span> <span class="pending-text">提交中</span> <span class="split"></span> </div> '),s+=" </div> "):"photo"===e.content_type&&(s+=' <div class="photo"> <a href="',s+=i(e.media_url),s+='" target="_blank"> ',r>1?(s+=' <img src="',s+=i(e.media_url),s+='" /> '):(s+=' <img src="',s+=i(e.media_url),s+='" onload="window.SCROLL_TO_LAST()" /> '),s+=" </a> </div> "),s+=" </div> "):"agent"===e.from_type&&(s+=' <div id="',s+=i(e.id),s+='" class="msg-agent"> <div class="name"> ',s+=i(e.agent.nickname),s+=" ",e.displayDate&&(s+=' <span id="date',s+=i(e.id),s+='" class="date">',s+=o(e.displayDate),s+="</span> "),s+=" </div> ","welcome"===e.content_type?(s+=' <div class="bubble"> <span class="arrow-bg"></span> <span class="arrow"></span> <div class="text">',s+=o(e.content),s+="</div> </div> "):"text"===e.content_type?(s+=' <div class="bubble"> <span class="arrow-bg"></span> <span class="arrow"></span> <div class="text">',s+=o(e.content),s+="</div> </div> "):"rich_text"===e.content_type?(s+=' <div class="bubble rich-text-bubble"> <span class="arrow-bg"></span> <span class="arrow"></span> <div class="text rich_text">',s+=o(e.extra.content),s+="</div> </div> "):"photo"===e.content_type?(s+=' <div class="photo"> <a href="',s+=i(e.media_url),s+='" target="_blank"> ',r>1?(s+=' <img src="',s+=i(e.media_url),s+='" /> '):(s+=' <img src="',s+=i(e.media_url),s+='" onload="window.SCROLL_TO_LAST()" /> '),s+=" </a> </div> "):"file"===e.content_type&&(s+=' <div class="file"> <span class="arrow-bg"></span> <span class="arrow"></span> <i class="icon icon-file"></i> <div class="content"> <div class="title"> <span class="file-name" title="',s+=i(e.extra.filename),s+='">',s+=i(e.extra.filename),s+='</span> <span class="file-size">',s+=i(e.extra.convert_size),s+='</span> </div> <div class="sub"> ',e.extra.cancel?s+=' <span class="file-state">对方取消发送</span> ':(s+=" ",e.extra.has_expired?(s+=' <span class="file-state">',s+=i(e.extra.has_expired),s+='后过期</span> <a class="btn-download" name="',s+=i(e.id),s+=",",s+=i(e.conversation_id),s+='" href="',s+=i(e.media_url),s+='" target="_blank"> <i class="icon icon-download"></i> <span>下载</span> </a> '):s+=' <span class="file-state">已过期</span> ',s+=" "),s+=" </div> </div> </div> "),s+=" </div> "),s+=" ","client"===e.from_type&&(s+=' <div id="',s+=i(e.id),s+='" class="msg-client"> ',e.displayDate&&(s+=' <div id="date',s+=i(e.id),s+='" class="date">',s+=o(e.displayDate),s+="</div> "),s+=" ","text"===e.content_type?(s+=' <div class="bubble"> <span class="arrow"></span> <div class="text">',s+=o(e.content),s+="</div> ","sending"===e.status&&(s+=' <span id="status',s+=i(e.id),s+='" class="status icon"></span> '),s+=" </div> "):"photo"===e.content_type?(s+=' <div class="photo"> <a href="',s+=i(e.media_url),s+='" target="_blank"> ',r>1?(s+=' <img id="photo',s+=i(e.id),s+='" src="',s+=i(e.media_url),s+='" /> '):(s+=' <img id="photo',s+=i(e.id),s+='" src="',s+=i(e.media_url),s+='" onload="window.SCROLL_TO_LAST()" /> '),s+=" </a> ","sending"===e.status&&(s+=' <span id="status',s+=i(e.id),s+='" class="status icon"></span> '),s+=" </div> "):"file"===e.content_type&&(s+=' <div class="file"> <span class="arrow-bg"></span> <span class="arrow"></span> <i class="icon icon-file"></i> <div class="content"> <div class="title"> <span class="file-name" title="',s+=i(e.extra.filename),s+='">',s+=i(e.extra.filename),s+='</span> <span class="file-size">',s+=i(e.extra.convert_size),s+='</span> </div> <div class="sub"> ',e.uploading?(s+=' <span id="progress',s+=i(e.id),s+='" class="progress-holder"> <span class="progress-bg"> <span id="progressBar',s+=i(e.id),s+='" class="progress-bar"></span> </span> </span> <a id="cancelUpload',s+=i(e.id),s+='" class="btn-cancel-upload"> <i class="icon icon-cancel-upload"></i> </a> <span id="fileState',s+=i(e.id),s+='" class="file-state">上传中&nbsp;<span id="speed',s+=i(e.id),s+='"></span></span> '):(s+=" ",e.extra.cancel?s+=' <span class="file-state">取消上传</span> ':(s+=" ",e.extra.has_expired?(s+=' <span class="file-state">',s+=i(e.extra.has_expired),s+="后过期</span> "):s+=' <span class="file-state">已过期</span> ',s+=" "),s+=" "),s+=" </div> </div> </div> "),s+=" </div> "),s+=" ","redirect"===e.from_type&&(s+=' <div id="',s+=i(e.id),s+='" class="msg-redirect"> 接下来由<span>',s+=i(e.toNickname),s+="</span>为您服务 </div> "),s+=" ","evaluation"===e.from_type&&(s+=' <div id="',s+=i(e.id),s+='" class="msg-evaluation"> 你给出了 <span class="evaluation-level evaluation-level-',s+=i(e.level),s+='">',s+=i(e.levelText),s+="</span> ",e.content&&(s+=' <div class="evaluation-content">',s+=i(e.content),s+="</div> "),s+=" </div> "),s+=" ","blacklist"===e.from_type&&(s+=' <div id="',s+=i(e.id),s+='" class="msg-blacklist">你被移出了黑名单</div> '),s+=" "}),s+=" ",new m(s)}),o("profile-customer",function(e){"use strict";var t=this,n=(t.$helpers,t.$escape),a=e.bgColor,i=e.photoType,o=e.avatar,r=e.name,s=t.$string,l=e.content,u="";return u+='<div class="profile-contact" style="background-color: #',u+=n(a),u+='"> ',"big"===i&&(u+=' <img class="profile-avatar" src="',u+=n(o),u+='" alt="avatar"> <div class="profile-name">',u+=n(r),u+="</div> "),u+=" ",u+=s(l),u+=" </div> ",new m(u)}),o("profile",function(e){"use strict";var t=this,n=(t.$helpers,t.$escape),a=e.avatar,i=e.name,o=e.tel,r=e.cellphone,s=e.email,l=e.qq,u=e.weixin,c="";return c+='<img class="profile-avatar" src="',c+=n(a),c+='" alt="avatar"> <div class="profile-name">',c+=n(i),c+='</div> <div class="profile-contact"> ',o&&(c+=' <a> <i class="icon icon-tel"></i> <span>',c+=n(o),c+="</span> </a> "),c+=" ",r&&(c+=' <a> <i class="icon icon-cellphone"></i> <span>',c+=n(r),c+="</span> </a> "),c+=" ",s&&(c+=' <a> <i class="icon icon-email"></i> <span>',c+=n(s),c+="</span> </a> "),c+=" ",l&&(c+=' <a> <i class="icon icon-qq"></i> <span>',c+=n(l),c+="</span> </a> "),c+=" ",u&&(c+=' <a> <i class="icon icon-weixin"></i> <span>',c+=n(u),c+="</span> </a> "),c+=" </div>",new m(c)}),o("queueing",function(e){"use strict";var t=this,n=(t.$helpers,t.$escape),a=e.intro,i=e.position,o="";return o+='<div class="queue-header">',o+=n(a),o+='</div> <div class="queue-body"> <div class="queue-position-title">当前等待人数</div> <span id="queueingPosition">',o+=n(i),o+='</span> </div> <div class="queue-footer"> <p>如果等不及，可以选择</p> <a class="btn-go-ticket">给我们留言</a> </div>',new m(o)}),o("support",function(e){"use strict";var t=this,n=(t.$helpers,e.disableBrandLink),a=t.$escape,i=e.entId,o="";return o+="<a ",n!==!0&&(o+='href="http://meiqia.com?utm_source=widget-badge&utm_term=',o+=a(i),o+='"'),o+=' target="_blank"> <i class="icon icon-logo-gray"></i> <span>客服软件由美洽提供</span> </a>',new m(o)}),o("survey",function(e){"use strict";var t=this,n=(t.$helpers,e.menus),a=t.$escape,i=t.$each,o=(e.v,e.k,e.inputs),r=e.val,s=(e.key,e.captcha),l="";return"open"===n.status&&(l+=' <div id="surveyStep1" class="active"> <div class="step-title">',l+=a(n.title),l+="</div> ",i(n.assignments,function(e,t){l+=' <div class="menus-item"> <a id="',l+=a(e.target_kind),l+="_",l+=a(e.target),l+='" name="surveyMenus" title="',l+=a(e.description),l+='">',l+=a(t+1),l+=". ",l+=a(e.description),l+="</a> </div> "}),l+=" </div> "),l+=" ","open"===o.status&&(l+=' <div id="surveyStep2" ',"close"===n.status&&(l+='class="active"'),l+='> <div class="step-title">',l+=a(o.title),l+="</div> ",i(o.fields,function(e){l+=" ",e.ignore||(l+=' <div class="form-group"> <div class="group-title">',l+=a(e.display_name),e.optional||(l+="<span>*</span>"),l+='</div> <div class="group-content"> ',"text"===e.type?(l+=' <input name="',l+=a(e.field_name),l+='" ',l+=e.optional?'class="survey-input-text"':'class="survey-input-text required"',l+=' type="text" value="',l+=a(r),l+='" placeholder="请输入" /> '):"single_choice"===e.type?(l+=" ",i(e.choices,function(t){l+=' <div class="choice-item"> <label> <input name="',l+=a(e.field_name),l+='" ',e.optional||(l+='class="required"'),l+=' type="radio" value="',l+=a(t),l+='" /> <span>',l+=a(t),l+="</span> </label> </div> "}),l+=" "):"multiple_choice"===e.type&&(l+=" ",i(e.choices,function(t){l+=' <div class="choice-item"> <label> <input name="',l+=a(e.field_name),l+='" ',e.optional||(l+='class="required"'),l+=' type="checkbox" value="',l+=a(t),l+='" /> <span>',l+=a(t),l+="</span> </label> </div> "}),l+=" "),l+=" </div> </div> "),l+=" "}),l+=" ",s&&(l+=' <div class="captcha-group"> <div class="group-title">验证码<span>*</span></div> <div class="group-content"> <div class="captcha-input"> <input id="surveyCaptcha" class="required" type="text" /> </div> <div class="captcha-img"> <img id="surveyCaptchaImg" src="" /> </div> </div> </div> '),l+=' <div class="btn-group"> <a id="surveySubmit">提交</a> </div> </div> '),new m(l)}),o("ticket-basic",function(e){"use strict";var t=this,n=(t.$helpers,e.intro),a=t.$escape,i=e.categories,o=t.$each,r=(e.val,e.key,t.$string),s=e.name,l=e.contactRule,u=e.tel,c=e.email,d=e.wechat,f=e.qq,p=e.defaultTemplate,g=e.defaultTemplateContent,v=e.captcha,h="";return h+='<div id="ticketV2" class="active"> ',n&&(h+=' <div class="step-title">',h+=a(n),h+="</div> "),h+=" ",i&&i.length>0&&(h+=' <div class="form-group"> <div class="group-title">分类<span>*</span></div> <div class="group-content"> ',o(i,function(e){h+=' <div class="choice-item"> <label> <input name="categories" type="radio" value="',h+=r(e.id),h+='" /> <span>',h+=r(e.name),h+="</span> </label> </div> "}),h+=" </div> </div> "),h+=" ","open"===s&&(h+=' <div class="form-group"> <div class="group-title"> 姓名 ',"multi"===l&&(h+=" <span>*</span> "),h+=' </div> <div class="group-content"> <input id="ticketName" type="text"> </div> </div> '),h+=" ","open"===u&&(h+=' <div class="form-group"> <div class="group-title"> 手机 ',"multi"===l&&(h+=" <span>*</span> "),h+=' </div> <div class="group-content"> <input id="ticketTel" type="text"> </div> </div> '),h+=" ","open"===c&&(h+=' <div class="form-group"> <div class="group-title"> 邮箱 ',"multi"===l&&(h+=" <span>*</span> "),h+=' </div> <div class="group-content"> <input id="ticketEmail" type="text"> </div> </div> '),h+=" ","open"===d&&(h+=' <div class="form-group"> <div class="group-title"> 微信 ',"multi"===l&&(h+=" <span>*</span> "),h+=' </div> <div class="group-content"> <input id="ticketWechat" type="text"> </div> </div> '),h+=" ","open"===f&&(h+=' <div class="form-group"> <div class="group-title"> QQ ',"multi"===l&&(h+=" <span>*</span> "),h+=' </div> <div class="group-content"> <input id="ticketQq" type="text"> </div> </div> '),h+=' <div class="form-group"> <div class="group-title">留言内容<span>*</span></div> <div class="group-content"> ',"open"===p?(h+=' <textarea id="ticketContent">',h+=a(g),h+="</textarea> "):h+=' <textarea id="ticketContent"></textarea> ',h+=" </div> </div> ","open"===v&&(h+=' <div class="captcha-group"> <div class="group-title">验证码<span>*</span></div> <div class="group-content"> <div class="captcha-input"> <input id="ticketCaptcha" class="required" type="text"/> </div> <div class="captcha-img"> <img id="ticketCaptchaImg" src="" /> </div> </div> </div> '),h+=' <div class="btn-group"> <a id="ticketSubmit">提交</a> </div> </div> ',new m(h)}),o("ticket",function(e){"use strict";var t=this,n=(t.$helpers,e.intro),a=t.$escape,i=e.categories,o=t.$each,r=(e.val,e.key,t.$string),s=e.name,l=e.contactRule,u=e.tel,c=e.email,d=e.wechat,f=e.qq,p=e.defaultTemplate,g=e.defaultTemplateContent,v=e.captcha,h="";return h+='<div id="ticketV2" class="active"> ',n&&(h+=' <div class="step-title">',h+=a(n),h+="</div> "),h+=" ",i&&i.length>0&&(h+=' <div class="form-group"> <div class="group-title">分类<span>*</span></div> <div class="group-content"> ',o(i,function(e){h+=' <div class="choice-item"> <label> <input name="categories" type="radio" value="',h+=r(e.id),h+='" /> <span>',h+=r(e.name),h+="</span> </label> </div> "}),h+=" </div> </div> "),h+=" ","open"===s&&(h+=' <div class="form-group"> <div class="group-title"> 姓名 ',"multi"===l&&(h+=" <span>*</span> "),h+=' </div> <div class="group-content"> <input id="ticketName" type="text" placeholder=" 请输入姓名"> </div> </div> '),h+=" ","open"===u&&(h+=' <div class="form-group"> <div class="group-title"> 手机 ',"multi"===l&&(h+=" <span>*</span> "),h+=' </div> <div class="group-content"> <input id="ticketTel" type="text" placeholder=" 请输入手机号"> </div> </div> '),h+=" ","open"===c&&(h+=' <div class="form-group"> <div class="group-title"> 邮箱 ',"multi"===l&&(h+=" <span>*</span> "),h+=' </div> <div class="group-content"> <input id="ticketEmail" type="text" placeholder=" 请输入邮箱"> </div> </div> '),h+=" ","open"===d&&(h+=' <div class="form-group"> <div class="group-title"> 微信 ',"multi"===l&&(h+=" <span>*</span> "),h+=' </div> <div class="group-content"> <input id="ticketWechat" type="text" placeholder=" 请输入微信号"> </div> </div> '),h+=" ","open"===f&&(h+=' <div class="form-group"> <div class="group-title"> QQ ',"multi"===l&&(h+=" <span>*</span> "),h+=' </div> <div class="group-content"> <input id="ticketQq" type="text" placeholder=" 请输入QQ号"> </div> </div> '),h+=' <div class="form-group"> <div class="group-title">留言内容<span>*</span></div> <div class="group-content"> ',"open"===p?(h+=' <textarea id="ticketContent" placeholder="请输入留言内容">',h+=a(g),h+="</textarea> "):h+=' <textarea id="ticketContent" placeholder="请输入留言内容"></textarea> ',h+=" </div> </div> ","open"===v&&(h+=' <div class="captcha-group"> <div class="group-title">验证码<span>*</span></div> <div class="group-content"> <div class="captcha-input"> <input id="ticketCaptcha" class="required" type="text" placeholder=" 请输入右侧验证码"/> </div> <div class="captcha-img"> <img id="ticketCaptchaImg" src="" /> </div> </div> </div> '),h+=' <div class="btn-group"> <a id="ticketSubmit">提交</a> </div> </div> ',new m(h)}),o("unable-service",function(e){"use strict";var t=this,n=(t.$helpers,t.$escape),a=e.src,i="";return i+='<img src="',i+=n(a),i+='"> <div>客服繁忙或已离线，给我们留言吧</div> <a class="btn-go-ticket">给我们留言</a>',new m(i)}),o("icon-css",function(e){"use strict";var t=this,n=(t.$helpers,t.$escape),a=e.cdn,i=e.tail,o="";return o+='.icon { background-image: url("',o+=n(a),o+="/images/icon-desktop.png?v=",o+=n(i),o+='"); background-size: 44px auto; background-repeat: no-repeat; } .emoji-control { background-image: url("',o+=n(a),o+="/images/emoji.png?v=",o+=n(i),o+='"); background-size: 25px auto; background-repeat: no-repeat; } @media only screen and (-webkit-min-device-pixel-ratio: 2), only screen and (min--moz-device-pixel-ratio: 2), only screen and (-o-min-device-pixel-ratio: 2/1), only screen and (min-device-pixel-ratio: 2) { .icon { background-image: url("',o+=n(a),o+="/images/icon-desktop@2x.png?v=",o+=n(i),o+='"); } .emoji-control { background-image: url("',o+=n(a),o+="/images/emoji@2x.png?v=",o+=n(i),o+='"); } } ',new m(o)}),o("theme-css",function(e){"use strict";var t=this,n=(t.$helpers,t.$escape),a=e.bgColor,i=e.textColor,o=e.subTextColor,r=e.color2,s="";return s+="#pageChat .header, #pageTicket .header, #pageCall .header, #pageSurvey .header { background-color: ",s+=n(a),s+="; color: ",s+=n(i),s+="; } #pageChat #agentInputting { background-color: ",s+=n(a),s+="; } #pageChat .agent-signature { color: ",s+=n(o),s+=" } #pageChat .msg-client .bubble { background-color: ",s+=n(a),s+="; color: ",s+=n(i),s+="; } #pageChat .msg-client .bubble a { color: ",s+=n(i),s+="; } #pageChat .msg-client .arrow { border-left: 6px solid ",s+=n(a),s+="; } #pageChat .footer .feature-holder #btnSend.active { background-color: ",s+=n(a),s+="; color: ",s+=n(i),s+="; } #pageChat #unableService .btn-go-ticket { background-color: ",s+=n(a),s+="; color: ",s+=n(i),s+="; } #pageChat #evaluationSubmit { background-color: ",s+=n(a),s+="; color: ",s+=n(i),s+="; } #pageChat #queueingTips .queue-position-title { color: ",s+=n(a),s+="; } #pageChat #queueingTips #queueingPosition { color: ",s+=n(a),s+="; } #pageChat #queueingTips .btn-go-ticket { background-color: ",s+=n(a),s+="; color: ",s+=n(i),s+='; } #pageSurvey .body .menus-item > a, #pageChat .body-left .msg-bot .bubble .menu-item, #pageChat .body-left .msg-bot .rating a, #pageChat .body-left .msg-bot div.rich-text-bubble a, #pageChat .body-left .msg-agent div.rich-text-bubble a, #pageChat .body-left .msg-common-tips a, #autocomplete li em, #autocomplete li a[data-current="true"] { /*color: ',s+=n(a),s+=";*/ color: #6088e6; } #autocomplete li a:hover { background-color: ",s+=n(a),s+="; } ",s+="white"===r?" .icon-angel-down, .icon-ring-open, .icon-ring-close { opacity: .6; filter: alpha(opacity=60); } .icon-angel-down:hover, .icon-ring-open:hover, .icon-ring-close:hover { opacity: .8; filter: alpha(opacity=80); } .icon-angel-down { background-position: -22px -66px; } .icon-ring-open { background-position: -22px -89px; } .icon-ring-close { background-position: -22px -111px; } ":" .icon-angel-down, .icon-ring-open, .icon-ring-close { opacity: .3; filter: alpha(opacity=30); } .icon-angel-down:hover, .icon-ring-open:hover, .icon-ring-close:hover { opacity: .5; filter: alpha(opacity=50); } .icon-angel-down { background-position: 0 -66px; } .icon-ring-open { background-position: 0 -89px; } .icon-ring-close { background-position: 0 -111px; } ",s+=" #pageTicket #ticketSubmit { background-color: ",s+=n(a),s+="; color: ",s+=n(i),s+="; } #pageTicket #ticketDone { background-color: ",s+=n(a),s+="; color: ",s+=n(i),s+="; } #pageCall .input-active { border-color: ",s+=n(a),s+=" !important; } #pageCall .submit-active { background-color: ",s+=n(a),s+=" !important; } #pageCall .submit-intro { color: ",s+=n(a),s+="; } #pageCall .call-success-icon { background-color: ",s+=n(a),s+="; } #pageSurvey .menus-item >a { color: ",s+=n(a),s+="; } #pageSurvey #surveySubmit { background-color: ",s+=n(a),s+="; color: ",s+=n(i),s+="; } ",new m(s)})}()},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={agentToken:null,browserId:null,clientMsgNum:0,convId:null,convNewCreate:!1,device:null,emojiGroup:["smile","laughing","blush","heart_eyes","smirk","flushed","grin","kissing_smiling_eyes","wink","kissing_closed_eyes","stuck_out_tongue_winking_eye","sleeping","worried","sweat_smile","cold_sweat","joy","sob","angry","mask","scream","sunglasses","thumbsup","clap","ok_hand"],entId:null,fakeSentMsg:[],agentSchedulingMsg:null,features:{emoji:!0,evaluation:!0,photo:!1,upload:!1},groupToken:null,historyArray:[],historyTimes:0,isBasie:null,isEnd:!1,inputting:!1,isReconnect:!1,lastMsgDate:null,limit:5,loserClub:[],language:"zh",messenger:null,msgId:[],msgLimit:10,page:0,ring:!1,ringing:!1,scheduler:!1,scheduling:!1,servability:!1,socket:!0,style:null,tpl:null,trackId:null,type:null,visitId:null,blacklist:!1,fallback:null,surveyRendered:!1,surveyDone:!1,initializeBodyHeight:1,msgHolderFlag:!1,isStandalone:!1,schedulerMsg:!1,chatHasEnd:!1,shenmaActionData:{}}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),o=a(i),r=n(6),s=a(r),l=n(4),u=a(l),c=function(e){s["default"](u["default"].tpl(e,{cdn:o["default"].cdn,tail:o["default"].tail}))},d=function(e){var t=u["default"].tpl("theme-css",{bgColor:"#"+e[0],color2:e[1],textColor:"white"===e[1]?"#fff":"#000",subTextColor:"white"===e[1]?"#fff":"#8a8b8c"});s["default"](t)};t["default"]={loadBtnBgi:c,setTheme:d}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e,t){var n=document.createElement("style");n.type="text/css",t&&(n.id=t);try{n.appendChild(document.createTextNode(e))}catch(a){n.styleSheet.cssText=e}var i=document.getElementsByTagName("head")[0];i.appendChild(n)}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(8),o=a(i),r=n(9),s=a(r),l=n(10),u=a(l),c=n(12),d=a(c),f=n(13),p=a(f),g=n(14),m=a(g),v=n(4),h=a(v),b=n(5),y=a(b),_=n(15),w=a(_),k=n(30),x=a(k),T=n(31),E=a(T),C=n(32),I=a(C),S=n(67),j=a(S),M=n(70),O=a(M),B=n(71),A=a(B),L=n(72),N=a(L),P=n(59),q=a(P),D=n(73),$=a(D),H=n(76),R=a(H),z=n(78),U=a(z),F=n(28),Q=a(F);t["default"]=function(){h["default"].messenger=new o["default"]("iframe1","MEIQIA-ECOBOOST"),h["default"].messenger.addTarget(window.parent,"parent"),h["default"].messenger.listen(function(e){e=e.split("^@#");var t=e[0];switch(t){case"startUp":var n=JSON.parse(e[1]);h["default"].entId=n.entId,h["default"].trackId=n.trackId,h["default"].history=n.history,h["default"].visitId=n.visitId,h["default"].browserId=n.browserId,h["default"].initData=n.initData,h["default"].url=n.url,h["default"].title=n.title,h["default"].fallback=n.fallback,h["default"].robot=n.initData.robot_settings||{},h["default"].sendFileStatus=n.initData.send_file_settings.widget_status,h["default"].disableBrandLink=n.disableBrandLink,h["default"].metadata=n.metadata,h["default"].isBasic||(h["default"].ring=void 0===s["default"].get("MEIQIA_RING")?n.initData.widget_settings.ring:s["default"].get("MEIQIA_RING")),s["default"].set("MEIQIA_TRACK_ID",n.trackId,{expires:1/0}),m["default"]("set","MEIQIA_TRACK_ID",n.trackId),s["default"].set("MEIQIA_PANEL_VISIBILITY",n.panelVisibility,{expires:1/0});for(var a=h["default"].tpl("support",{entId:h["default"].entId,disableBrandLink:h["default"].disableBrandLink}),i=document.getElementsByName("supportHolder"),o=0;o<i.length;o++)i[o].innerHTML=a;y["default"].setTheme(n.initData.widget_settings.desktop.panel.theme),h["default"].isBasic?(w["default"]("ticket-basic",n.initData.ticket_config),N["default"]("evaluation-basic",{intro:n.initData.service_evaluation_config.prompt_text})):(w["default"]("ticket",n.initData.ticket_config),N["default"]("evaluation",{intro:n.initData.service_evaluation_config.prompt_text})),"open"===n.initData.widget_settings.removeBrand&&(p["default"].addClass(document.getElementById("pageChat"),"remove-brand"),p["default"].addClass(document.getElementById("pageTicket"),"remove-brand"),p["default"].addClass(document.getElementById("pageCall"),"remove-brand"),p["default"].addClass(document.getElementById("pageSurvey"),"remove-brand")),
j["default"].init(),h["default"].isBasic||E["default"](h["default"].ring);var r=O["default"]("get");r&&(r=JSON.stringify(r)),h["default"].messenger.targets.parent.send("unreadMsg^@#"+r);var l=A["default"]("get");l&&(document.getElementById("textarea").value=l),"close"===h["default"].sendFileStatus&&document.getElementById("uploadBtn")&&(document.getElementById("uploadBtn").style.display="none");break;case"rejectInvitation":x["default"]();break;case"callWidget":var c=!0;if("call"===e[1])R["default"]("pageCall");else if(h["default"].initData.servability){var f="";if(e[1]&&(f=JSON.parse(e[1]),"string"==typeof f.greeting)){var g={id:(new Date).getTime(),from_type:"client",content_type:"text",content:f.greeting};h["default"].schedulerMsg=!0,h["default"].fakeSentMsg.push(g)}if(h["default"].convType=f.type,h["default"].convId&&Q["default"]("conv",h["default"].convId),"open"!==h["default"].initData.survey.status||h["default"].surveyDone||"queue"===f.type||"automatic"===f.type)if(h["default"].initData.scheduler_after_client_send_msg&&"automatic"!==f.type)h["default"].agentToken=h["default"].assignedAgentToken=f.agentToken,h["default"].groupToken=h["default"].assignedGroupToken=f.groupToken,U["default"]();else{h["default"].initData.scheduler_after_client_send_msg=!1;var v={};if(f){var b=h["default"].assignedAgentToken=f.agentToken,_=h["default"].assignedGroupToken=f.groupToken;b?b!==h["default"].agentToken&&(v.agentToken=b):_&&_!==h["default"].groupToken&&(v.groupToken=_),"manualInvite"===f.type&&(v.from_type="invitation"),"invisible"!==f.visibility||"automatic"!==f.type&&"queue"!==f.type||(c=!1)}d["default"](v)?h["default"].convId||h["default"].scheduler||I["default"]():I["default"](v),h["default"].unableToServe?h["default"].messenger.targets.parent.send("convClickCallback^@#ticket:"):h["default"].initData.in_queue?h["default"].messenger.targets.parent.send("convClickCallback^@#queue:"):h["default"].convId&&h["default"].messenger.targets.parent.send("convClickCallback^@#conv:"+h["default"].convId),R["default"]("pageChat")}else R["default"](h["default"].convId?"pageChat":"pageSurvey"),h["default"].surveyRendered||(h["default"].agentToken=h["default"].assignedAgentToken=f.agentToken,h["default"].groupToken=h["default"].assignedGroupToken=f.groupToken,$["default"]())}else h["default"].messenger.targets.parent.send("convClickCallback^@#ticket:"),Q["default"]("ticket"),R["default"]("pageTicket");c&&(h["default"].messenger.targets.parent.send("showPanel^@#force"),s["default"].set("MEIQIA_PANEL_VISIBILITY","visible",{expires:1/0}),u["default"]("msgWrapper")),h["default"].isEnd||h["default"].isBasic||document.getElementById("textarea").focus();break;case"handleUnread":var k=JSON.parse(e[1]);O["default"](k.action,k.msg);break;case"ringing":h["default"].isBasic||q["default"](e[1]);break;case"panelVisibility":s["default"].set("MEIQIA_PANEL_VISIBILITY",e[1],{expires:1/0});break;case"baiduBid":h["default"].baidu_bid=e[1]}})}},function(e,t){"use strict";function n(e,t){var n="";if(arguments.length<2?n="target error - target and name are both required":"object"!=("undefined"==typeof e?"undefined":i(e))?n="target error - target itself must be window object":"string"!=typeof t&&(n="target error - target name must be string type"),n)throw new Error(n);this.target=e,this.name=t}function a(e,t){this.targets={},this.name=e,this.listenFunc=[],o=t||o,"string"!=typeof o&&(o=o.toString()),this.initListen()}Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o="[PROJECT_NAME]",r="postMessage"in window;n.prototype.send=r?function(e){this.target.postMessage(o+e,"*")}:function(e){var t=window.navigator[o+this.name];if("function"!=typeof t)throw new Error("target callback function is not defined");t(o+e,window)},a.prototype.addTarget=function(e,t){var a=new n(e,t);this.targets[t]=a},a.prototype.initListen=function(){var e=this,t=function(t){"object"==("undefined"==typeof t?"undefined":i(t))&&t.data&&(t=t.data);try{t=t.slice(o.length);for(var n=0;n<e.listenFunc.length;n++)e.listenFunc[n](t)}catch(a){return null}};r?"addEventListener"in document?window.addEventListener("message",t,!1):"attachEvent"in document&&window.attachEvent("onmessage",t):window.navigator[o+this.name]=t},a.prototype.listen=function(e){this.listenFunc.push(e)},a.prototype.clear=function(){this.listenFunc=[]},a.prototype.send=function(e){var t,n=this.targets;for(t in n)n[t].send(e)},t["default"]=a},function(e,t,n){var a,i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(o,r){"use strict";var s=function(e){if("object"!==i(e.document))throw new Error("Cookies.js requires a `window` with a `document` object");var t=function n(e,t,a){return 1===arguments.length?n.get(e):n.set(e,t,a)};return t._document=e.document,t._cacheKeyPrefix="cookey.",t._maxExpireDate=new Date("Fri, 31 Dec 9999 23:59:59 UTC"),t.defaults={path:"/",secure:!1},t.get=function(e){t._cachedDocumentCookie!==t._document.cookie&&t._renewCache();var n=t._cache[t._cacheKeyPrefix+e];return n===r?r:decodeURIComponent(n)},t.set=function(e,n,a){return a=t._getExtendedOptions(a),a.expires=t._getExpiresDate(n===r?-1:a.expires),t._document.cookie=t._generateCookieString(e,n,a),t},t.expire=function(e,n){return t.set(e,r,n)},t._getExtendedOptions=function(e){return{path:e&&e.path||t.defaults.path,domain:e&&e.domain||t.defaults.domain,expires:e&&e.expires||t.defaults.expires,secure:e&&e.secure!==r?e.secure:t.defaults.secure}},t._isValidDate=function(e){return"[object Date]"===Object.prototype.toString.call(e)&&!isNaN(e.getTime())},t._getExpiresDate=function(e,n){if(n=n||new Date,"number"==typeof e?e=e===1/0?t._maxExpireDate:new Date(n.getTime()+1e3*e):"string"==typeof e&&(e=new Date(e)),e&&!t._isValidDate(e))throw new Error("`expires` parameter cannot be converted to a valid Date instance");return e},t._generateCookieString=function(e,t,n){e=e.replace(/[^#$&+\^`|]/g,encodeURIComponent),e=e.replace(/\(/g,"%28").replace(/\)/g,"%29"),t=(t+"").replace(/[^!#$&-+\--:<-\[\]-~]/g,encodeURIComponent),n=n||{};var a=e+"="+t;return a+=n.path?";path="+n.path:"",a+=n.domain?";domain="+n.domain:"",a+=n.expires?";expires="+n.expires.toUTCString():"",a+=n.secure?";secure":""},t._getCacheFromString=function(e){for(var n={},a=e?e.split("; "):[],i=0;i<a.length;i++){var o=t._getKeyValuePairFromCookieString(a[i]);n[t._cacheKeyPrefix+o.key]===r&&(n[t._cacheKeyPrefix+o.key]=o.value)}return n},t._getKeyValuePairFromCookieString=function(e){var t=e.indexOf("=");t=0>t?e.length:t;var n,a=e.substr(0,t);try{n=decodeURIComponent(a)}catch(i){console&&"function"==typeof console.warn&&console.warn('Could not decode cookie with key "'+a+'"',i)}return{key:n,value:e.substr(t+1)}},t._renewCache=function(){t._cache=t._getCacheFromString(t._document.cookie),t._cachedDocumentCookie=t._document.cookie},t._areEnabled=function(){var e="cookies.js",n="1"===t.set(e,1).get(e);return t.expire(e),n},t.enabled=t._areEnabled(),t},l="object"===i(o.document)?s(o):s;a=function(){return l}.call(t,n,t,e),!(a!==r&&(e.exports=a))}("undefined"==typeof window?void 0:window)},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}function i(e,t,n){if(!(0>=n)){var a=t-e.scrollTop,o=a/n*10;setTimeout(function(){e.scrollTop=e.scrollTop+o,e.scrollTop!=t&&i(e,t,n-10)},10)}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(11),r=a(o);t["default"]=function(e){var t=document.getElementById(e);setTimeout(function(){r["default"].isThisDevice("android")?(t.style["overflow-y"]="hidden",t.scrollTop=t.scrollHeight,t.style["overflow-y"]="auto"):i(t,t.scrollHeight,120)},300)}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={isMobile:function n(){var n=!1,e=(navigator.userAgent||navigator.vendor||window.opera).toLowerCase();return(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(n=!0),n},isThisDevice:function(e){var t=(navigator.userAgent||navigator.vendor||window.opera).toLowerCase();return e=e.toLowerCase(),t.indexOf(e)>=0?!0:!1},isSafari:function(){var e=navigator.userAgent.toLowerCase(),t=e.match(/applewebkit\/(\d+)(.\d+)?/),n=e.match(/safari\/(\d+)(.\d+)?/);return t&&n?parseInt(t[1])!=parseInt(n[1])?!1:e.indexOf("baidu")>-1?!1:e.indexOf("safari")>-1&&e.indexOf("chrome")<1:!1},isIE:function(e){var t=navigator.userAgent.toLowerCase();return-1!=t.indexOf("msie")&&parseInt(t.split("msie")[1])===e?!0:!1},iOSversion:function(){var e=(navigator.userAgent||navigator.vendor||window.opera).toLowerCase();if(/ip(hone|od|ad)/.test(e)){var t=e.match(/os (\d+)_(\d+)_?(\d+)?/);return+[parseInt(t[1],10),parseInt(t[2],10),parseInt(t[3]||0,10)].join("")}}}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e,t){return e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))},a=function(e,t){n(e,t)||(e.className+=" "+t)},i=function(e,t){if(n(e,t)){var a=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(a,"")}};t["default"]={hasClass:n,addClass:a,removeClass:i}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e,t,n){try{var a=window.localStorage;if("get"===e)return a.getItem(t);"set"===e?a.setItem(t,n):"remove"===e&&a.removeItem(t)}catch(i){return null}}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),o=a(i),r=n(16),s=a(r),l=n(4),u=a(l),c=n(20),d=a(c),f=n(23),p=a(f);t["default"]=function(e,t){function n(){var n=u["default"].tpl(e,{name:t.name,qq:t.qq,tel:t.tel,email:t.email,wechat:t.wechat,intro:t.intro,categories:a,captcha:t.captcha,contactRule:t.contactRule,defaultTemplate:t.defaultTemplate,defaultTemplateContent:t.defaultTemplateContent});document.getElementById("ticketForm").innerHTML=n,"open"===t.captcha&&(d["default"]("ticketCaptchaImg","ticketCaptchaToken"),document.getElementById("ticketCaptchaImg").addEventListener("click",function(){d["default"]("ticketCaptchaImg","ticketCaptchaToken")})),document.getElementById("ticketSubmit").addEventListener("click",function(){p["default"](t)})}var a=[];"open"===t.category?s["default"].ajax({url:o["default"].chat+"/client/tickets_v2/categories",type:"get",data:{enterprise_id:u["default"].entId},success:function(e){t.categories=a=e.categories,n()},error:function(){n()}}):n()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};n(17);var i=function(e,t){var n=[],a=t&&t.timestamp||1*new Date;for(var i in e)e.hasOwnProperty(i)&&n.push(encodeURIComponent(i)+"="+encodeURIComponent(e[i]));return t&&t.sign&&n.push("sign="+t.sign),n.push("v="+a),n.join("&")},o=function(e){e=e||{},e.type=(e.type||"GET").toUpperCase(),e.dataType=e.dataType||"json",e.contentType=e.contentType||"application/x-www-form-urlencoded; charset=UTF-8";var t=i(e.data),n=null;if("undefined"!=typeof XMLHttpRequest)n=new XMLHttpRequest;else for(var o=["Microsoft.XmlHttp","MSXML2.XmlHttp","MSXML2.XmlHttp.3.0","MSXML2.XmlHttp.4.0","MSXML2.XmlHttp.5.0","MSXML2.XmlHttp.6.0"],r=0,s=o.length;s>r;r++)try{n=new ActiveXObject(o[r]);break}catch(l){}if(n.onreadystatechange=function(){if(4===n.readyState){var t=n.status;if(t>=200&&300>t){var a=n.responseText;"json"===e.dataType&&a&&(a=JSON.parse(n.responseText)),e.success&&e.success(a,n.responseXML)}else e.error&&e.error(n,t,n.responseText)}},"GET"===e.type)n.open("GET",e.url+"?"+t,!0),n.send(null);else if("POST"===e.type){n.open("POST",e.url,!0),n.setRequestHeader("Content-Type",e.contentType);var u=e.header;if(u)for(var c in u)n.setRequestHeader(c,u[c]);var d=e.data;"object"===("undefined"==typeof d?"undefined":a(d))&&(d=JSON.stringify(d)),n.send(d)}return e.beforeSend&&e.beforeSend(n),n},r=function(e){if(e=e||{},!e.url||!e.callback)return!1;e.beforeSend&&e.beforeSend();var t="jsonp"+1*new Date;e.data[e.callback]=t;var n=i(e.data,e.signature),a=document.createElement("script");a.type="text/javascript",a.charset="UTF-8",document.body.appendChild(a),window[t]=function(n){try{document.body.removeChild(a),clearTimeout(a.timer),window[t]=null,e.success&&e.success(n)}catch(i){return null}},a.src=e.url+"?"+n,e.time&&(a.timer=setTimeout(function(){try{window[t]=null,document.body.removeChild(a),e.error&&e.error({message:"超时"})}catch(n){return null}},e.time))},s=function(e){e=e||{};var t=e.data,n=new XMLHttpRequest;n.upload&&(n.upload.onprogress=function(t){e.progress&&e.progress(t)}),n.onload=function(){if(-1!==[200,204].indexOf(n.status)){var t=n.responseText;"json"===e.dataType&&(t=JSON.parse(n.responseText)),e.success&&e.success(t,n.responseXML)}else e.error&&e.error(n,status,n.responseText)};var a=new FormData;for(var i in t)t.hasOwnProperty(i)&&a.append(i,t[i]);n.open("POST",e.url),n.send(a),e.beforeSend&&e.beforeSend(n)};t["default"]={ajax:o,jsonp:r,upload:s}},function(e,t,n){var a;(function(e,i){"use strict";var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};(function(){function r(e,t){function n(e){if(n[e]!==h)return n[e];var o;if("bug-string-char-index"==e)o="a"!="a"[0];else if("json"==e)o=n("json-stringify")&&n("json-parse");else{var r,s='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==e){var l=t.stringify,c="function"==typeof l&&_;if(c){(r=function(){return 1}).toJSON=r;try{c="0"===l(0)&&"0"===l(new a)&&'""'==l(new i)&&l(y)===h&&l(h)===h&&l()===h&&"1"===l(r)&&"[1]"==l([r])&&"[null]"==l([h])&&"null"==l(null)&&"[null,null,null]"==l([h,y,null])&&l({a:[r,!0,!1,null,"\x00\b\n\f\r	"]})==s&&"1"===l(null,r)&&"[\n 1,\n 2\n]"==l([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==l(new u(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==l(new u(864e13))&&'"-000001-01-01T00:00:00.000Z"'==l(new u(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==l(new u(-1))}catch(d){c=!1}}o=c}if("json-parse"==e){var f=t.parse;if("function"==typeof f)try{if(0===f("0")&&!f(!1)){r=f(s);var p=5==r.a.length&&1===r.a[0];if(p){try{p=!f('"	"')}catch(d){}if(p)try{p=1!==f("01")}catch(d){}if(p)try{p=1!==f("1.")}catch(d){}}}}catch(d){p=!1}o=p}}return n[e]=!!o}e||(e=c.Object()),t||(t=c.Object());var a=e.Number||c.Number,i=e.String||c.String,s=e.Object||c.Object,u=e.Date||c.Date,d=e.SyntaxError||c.SyntaxError,f=e.TypeError||c.TypeError,p=e.Math||c.Math,g=e.JSON||c.JSON;"object"==("undefined"==typeof g?"undefined":o(g))&&g&&(t.stringify=g.stringify,t.parse=g.parse);var m,v,h,b=s.prototype,y=b.toString,_=new u(-0xc782b5b800cec);try{_=-109252==_.getUTCFullYear()&&0===_.getUTCMonth()&&1===_.getUTCDate()&&10==_.getUTCHours()&&37==_.getUTCMinutes()&&6==_.getUTCSeconds()&&708==_.getUTCMilliseconds()}catch(w){}if(!n("json")){var k="[object Function]",x="[object Date]",T="[object Number]",E="[object String]",C="[object Array]",I="[object Boolean]",S=n("bug-string-char-index");if(!_)var j=p.floor,M=[0,31,59,90,120,151,181,212,243,273,304,334],O=function(e,t){return M[t]+365*(e-1970)+j((e-1969+(t=+(t>1)))/4)-j((e-1901+t)/100)+j((e-1601+t)/400)};if((m=b.hasOwnProperty)||(m=function(e){var t,n={};return(n.__proto__=null,n.__proto__={toString:1},n).toString!=y?m=function(e){var t=this.__proto__,n=e in(this.__proto__=null,this);return this.__proto__=t,n}:(t=n.constructor,m=function(e){var n=(this.constructor||t).prototype;return e in this&&!(e in n&&this[e]===n[e])}),n=null,m.call(this,e)}),v=function(e,t){var n,a,i,r=0;(n=function(){this.valueOf=0}).prototype.valueOf=0,a=new n;for(i in a)m.call(a,i)&&r++;return n=a=null,r?v=2==r?function(e,t){var n,a={},i=y.call(e)==k;for(n in e)i&&"prototype"==n||m.call(a,n)||!(a[n]=1)||!m.call(e,n)||t(n)}:function(e,t){var n,a,i=y.call(e)==k;for(n in e)i&&"prototype"==n||!m.call(e,n)||(a="constructor"===n)||t(n);(a||m.call(e,n="constructor"))&&t(n)}:(a=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],v=function(e,t){var n,i,r=y.call(e)==k,s=!r&&"function"!=typeof e.constructor&&l[o(e.hasOwnProperty)]&&e.hasOwnProperty||m;for(n in e)r&&"prototype"==n||!s.call(e,n)||t(n);for(i=a.length;n=a[--i];s.call(e,n)&&t(n));}),v(e,t)},!n("json-stringify")){var B={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},A="000000",L=function(e,t){return(A+(t||0)).slice(-e)},N="\\u00",P=function(e){for(var t='"',n=0,a=e.length,i=!S||a>10,o=i&&(S?e.split(""):e);a>n;n++){var r=e.charCodeAt(n);switch(r){case 8:case 9:case 10:case 12:case 13:case 34:case 92:t+=B[r];break;default:if(32>r){t+=N+L(2,r.toString(16));break}t+=i?o[n]:e.charAt(n)}}return t+'"'},q=function J(e,t,n,a,i,r,s){var l,u,c,d,p,g,b,_,w,k,S,M,B,A,N,q;try{l=t[e]}catch(D){}if("object"==("undefined"==typeof l?"undefined":o(l))&&l)if(u=y.call(l),u!=x||m.call(l,"toJSON"))"function"==typeof l.toJSON&&(u!=T&&u!=E&&u!=C||m.call(l,"toJSON"))&&(l=l.toJSON(e));else if(l>-1/0&&1/0>l){if(O){for(p=j(l/864e5),c=j(p/365.2425)+1970-1;O(c+1,0)<=p;c++);for(d=j((p-O(c,0))/30.42);O(c,d+1)<=p;d++);p=1+p-O(c,d),g=(l%864e5+864e5)%864e5,b=j(g/36e5)%24,_=j(g/6e4)%60,w=j(g/1e3)%60,k=g%1e3}else c=l.getUTCFullYear(),d=l.getUTCMonth(),p=l.getUTCDate(),b=l.getUTCHours(),_=l.getUTCMinutes(),w=l.getUTCSeconds(),k=l.getUTCMilliseconds();l=(0>=c||c>=1e4?(0>c?"-":"+")+L(6,0>c?-c:c):L(4,c))+"-"+L(2,d+1)+"-"+L(2,p)+"T"+L(2,b)+":"+L(2,_)+":"+L(2,w)+"."+L(3,k)+"Z"}else l=null;if(n&&(l=n.call(t,e,l)),null===l)return"null";if(u=y.call(l),u==I)return""+l;if(u==T)return l>-1/0&&1/0>l?""+l:"null";if(u==E)return P(""+l);if("object"==("undefined"==typeof l?"undefined":o(l))){for(A=s.length;A--;)if(s[A]===l)throw f();if(s.push(l),S=[],N=r,r+=i,u==C){for(B=0,A=l.length;A>B;B++)M=J(B,l,n,a,i,r,s),S.push(M===h?"null":M);q=S.length?i?"[\n"+r+S.join(",\n"+r)+"\n"+N+"]":"["+S.join(",")+"]":"[]"}else v(a||l,function(e){var t=J(e,l,n,a,i,r,s);t!==h&&S.push(P(e)+":"+(i?" ":"")+t)}),q=S.length?i?"{\n"+r+S.join(",\n"+r)+"\n"+N+"}":"{"+S.join(",")+"}":"{}";return s.pop(),q}};t.stringify=function(e,t,n){var a,i,r,s;if(l["undefined"==typeof t?"undefined":o(t)]&&t)if((s=y.call(t))==k)i=t;else if(s==C){r={};for(var u,c=0,d=t.length;d>c;u=t[c++],s=y.call(u),(s==E||s==T)&&(r[u]=1));}if(n)if((s=y.call(n))==T){if((n-=n%1)>0)for(a="",n>10&&(n=10);a.length<n;a+=" ");}else s==E&&(a=n.length<=10?n:n.slice(0,10));return q("",(u={},u[""]=e,u),i,r,a,"",[])}}if(!n("json-parse")){var D,$,H=i.fromCharCode,R={92:"\\",34:'"',47:"/",98:"\b",116:"	",110:"\n",102:"\f",114:"\r"},z=function(){throw D=$=null,d()},U=function(){for(var e,t,n,a,i,o=$,r=o.length;r>D;)switch(i=o.charCodeAt(D)){case 9:case 10:case 13:case 32:D++;break;case 123:case 125:case 91:case 93:case 58:case 44:return e=S?o.charAt(D):o[D],D++,e;case 34:for(e="@",D++;r>D;)if(i=o.charCodeAt(D),32>i)z();else if(92==i)switch(i=o.charCodeAt(++D)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:e+=R[i],D++;break;case 117:for(t=++D,n=D+4;n>D;D++)i=o.charCodeAt(D),i>=48&&57>=i||i>=97&&102>=i||i>=65&&70>=i||z();e+=H("0x"+o.slice(t,D));break;default:z()}else{if(34==i)break;for(i=o.charCodeAt(D),t=D;i>=32&&92!=i&&34!=i;)i=o.charCodeAt(++D);e+=o.slice(t,D)}if(34==o.charCodeAt(D))return D++,e;z();default:if(t=D,45==i&&(a=!0,i=o.charCodeAt(++D)),i>=48&&57>=i){for(48==i&&(i=o.charCodeAt(D+1),i>=48&&57>=i)&&z(),a=!1;r>D&&(i=o.charCodeAt(D),i>=48&&57>=i);D++);if(46==o.charCodeAt(D)){for(n=++D;r>n&&(i=o.charCodeAt(n),i>=48&&57>=i);n++);n==D&&z(),D=n}if(i=o.charCodeAt(D),101==i||69==i){for(i=o.charCodeAt(++D),(43==i||45==i)&&D++,n=D;r>n&&(i=o.charCodeAt(n),i>=48&&57>=i);n++);n==D&&z(),D=n}return+o.slice(t,D)}if(a&&z(),"true"==o.slice(D,D+4))return D+=4,!0;if("false"==o.slice(D,D+5))return D+=5,!1;if("null"==o.slice(D,D+4))return D+=4,null;z()}return"$"},F=function V(e){var t,n;if("$"==e&&z(),"string"==typeof e){if("@"==(S?e.charAt(0):e[0]))return e.slice(1);if("["==e){for(t=[];e=U(),"]"!=e;n||(n=!0))n&&(","==e?(e=U(),"]"==e&&z()):z()),","==e&&z(),t.push(V(e));return t}if("{"==e){for(t={};e=U(),"}"!=e;n||(n=!0))n&&(","==e?(e=U(),"}"==e&&z()):z()),(","==e||"string"!=typeof e||"@"!=(S?e.charAt(0):e[0])||":"!=U())&&z(),t[e.slice(1)]=V(U());return t}z()}return e},Q=function(e,t,n){var a=W(e,t,n);a===h?delete e[t]:e[t]=a},W=function(e,t,n){var a,i=e[t];if("object"==("undefined"==typeof i?"undefined":o(i))&&i)if(y.call(i)==C)for(a=i.length;a--;)Q(i,a,n);else v(i,function(e){Q(i,e,n)});return n.call(e,t,i)};t.parse=function(e,t){var n,a;return D=0,$=""+e,n=F(U()),"$"!=U()&&z(),D=$=null,t&&y.call(t)==k?W((a={},a[""]=n,a),"",t):n}}}return t.runInContext=r,t}var s=!0&&n(19),l={"function":!0,object:!0},u=l[o(t)]&&t&&!t.nodeType&&t,c=l["undefined"==typeof window?"undefined":o(window)]&&window||this,d=u&&l[o(e)]&&e&&!e.nodeType&&"object"==("undefined"==typeof i?"undefined":o(i))&&i;if(!d||d.global!==d&&d.window!==d&&d.self!==d||(c=d),u&&!s)r(c,u);else{var f=c.JSON,p=c.JSON3,g=!1,m=r(c,c.JSON3={noConflict:function(){return g||(g=!0,c.JSON=f,c.JSON3=p,f=p=null),m}});c.JSON={parse:m.parse,stringify:m.stringify,encode:m.stringify,decode:m.parse}}s&&(a=function(){return m}.call(t,n,t,e),!(void 0!==a&&(e.exports=a)))}).call(void 0)}).call(t,n(18)(e),function(){return this}())},function(e,t){"use strict";e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t){(function(t){e.exports=t}).call(t,{})},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),o=a(i),r=n(21),s=a(r),l=n(16),u=a(l),c=n(4),d=a(c),f=n(22),p=a(f);t["default"]=function(e,t){u["default"].ajax({url:o["default"].chat+"/captchas",type:"post",success:function(n){n.captcha_token?(document.getElementById(e).src=""+o["default"].chat+n.captcha_image_url,d["default"][t]=n.captcha_token):p["default"](s["default"][d["default"].language].verification,3e3)},error:function(){p["default"](s["default"][d["default"].language].verification,3e3)}})}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={verification:"获取验证码失败",LoadHistory:"加载历史消息",historyMore:"加载更多历史消息",NoMore:"没有更多了",Loading:"加载中...",QueuingFailed:"排队失败，请刷新重试",TurnArtificial:"转人工",understand:"抱歉没能理解您的提问，可选择",message:"留言",satisfied:"好评",Normal:"中评",Dissatisfied:"差评",EvaluationFailed:"评价失败，请稍后重试",CustomerNews:"美洽客服消息",admin:"管理员",PromotionMessage:"[推广消息]",SentAFile:"「发来了一个文件」",SentAPicture:"「发来了一张图片」",NewMessage:"新消息",PastePictureFailed:"粘贴图片失败，请用「图片按钮」上传图片",WaitingQueue:"排队等待中...",WaitingTransfer:"正在为您转接，请稍候..",Hours:"小时",Minutes:"分钟",Seconds:"秒",NetworkError:"网络错误，请稍后重试",PleaseControl:"请控制",characters:"在1到100个字符",required:"请填写必填字段",choose:"请选择",enterVerification:"请输入验证码",queryForm:"加载询前表单失败，请稍后重试",getMsg:"连接已断开，请刷新页面",connection:"连接已断开，请刷新页面",dissatisfaction:"很抱歉您对此回答不满意",FailedSubmit:"提交失败，请稍候再试",enterPhoneNumber:"请正确填写手机或带区号的座机号码",correctVerification:"请正确填写验证码",classification:"请选择分类",name:"请正确填写姓名",phone:"请正确填写手机号",email:"请正确填写联系邮箱",weChat:"请正确填写微信",QQ:"请正确填写QQ",information:"请至少填写一项联系方式",messageCharacters:"请保持留言内容在 1～1024 字符内",submit:"提交",MessageFailed:"留言失败，请稍候再试",CancelUpload:"取消上传",UploadFailed:"上传失败",UploadedSuccessfully:"上传成功",onlyPictures:"只能发送图片哦",sendLess:"只能发送小于 50MB 的文件哦",upToOnly:"最多只能发送 2048 个字符哦",selectRating:"请选择评价等级",upToCharacters:"最多只能发送 30 个字符哦",serviceUnavailable:"抱歉，客服系统暂时无法使用"},a={verification:"獲取驗證碼失敗",LoadHistory:"載入歷史消息",historyMore:"載入更多歷史消息",NoMore:"沒有更多了",Loading:"加載中...",QueuingFailed:"排隊失敗，請刷新重試",TurnArtificial:"轉人工",understand:"抱歉沒能理解您的提問，可選擇",message:"留言",satisfied:"好評",Normal:"中評",Dissatisfied:"差評",EvaluationFailed:"評價失敗，請稍後重試",CustomerNews:"美洽客服消息",admin:"管理員",PromotionMessage:"[推廣消息]",SentAFile:"「發來了一個文件」",SentAPicture:"「發來了一張圖片」",NewMessage:"新消息",PastePictureFailed:"粘貼圖片失敗，請用「圖片按鈕」上傳圖片",WaitingQueue:"排隊等待中...",WaitingTransfer:"正在為您轉接，請稍候..",Hours:"小時",Minutes:"分鐘",Seconds:"秒",NetworkError:"網絡錯誤，請稍後重試",PleaseControl:"請控制",characters:"在1到100個字符",required:"請填寫必填字段",choose:"請選擇",enterVerification:"請輸入驗證碼",queryForm:"加載詢前表單失敗，請稍後重試",getMsg:"連接已斷開，請刷新頁面",connection:"連接已斷開，請刷新頁面",dissatisfaction:"很抱歉您對此回答不滿意",FailedSubmit:"提交失敗，請稍候再試",enterPhoneNumber:"請正確填寫手機或帶區號的座機號碼",correctVerification:"請正確填寫驗證碼",classification:"請選擇分類",name:"請正確填寫姓名",phone:"請正確填寫手機號",email:"請正確填寫聯繫郵箱",weChat:"請正確填寫微信",QQ:"請正確填寫QQ",information:"請至少填寫一項聯繫方式",messageCharacters:"請保持留言內容在 1～1024 字符內",submit:"提交",MessageFailed:"留言失敗，請稍候再試",CancelUpload:"取消上傳",UploadFailed:"上傳失敗",UploadedSuccessfully:"上傳成功",onlyPictures:"只能發送圖片哦",sendLess:"只能發送小於 50MB 的文件哦",upToOnly:"最多隻能發送 2048 個字符哦",selectRating:"請選擇評價等級",upToCharacters:"最多隻能發送 30 個字符哦",serviceUnavailable:"抱歉，客服系統暫時無法使用"},i={verification:"Failed to get verification code",LoadHistory:"Load History messages",historyMore:"Loads more history messages",NoMore:"No more",Loading:"Loading...",QueuingFailed:"Queuing failed. Please refresh and try again",TurnArtificial:"Change Live Support",understand:"Sorry to fail to understand your question",message:"message",satisfied:"satisfied",Normal:"Normal",Dissatisfied:"Dissatisfied",EvaluationFailed:"Evaluation failed. Please try again later",CustomerNews:"Meiqia customer service news",admin:"administrator",PromotionMessage:"[Promotion message]",SentAFile:"「Sent a file」",SentAPicture:"「Sent a picture」",NewMessage:"New message",PastePictureFailed:"Paste picture failed. Please use picture button to upload picture",WaitingQueue:"Waiting",WaitingTransfer:"Please Wait, Turning to Live Support",Hours:"Hours",Minutes:"Minutes",Seconds:"Seconds",NetworkError:"Network error. Please try again later",PleaseControl:"Please control",characters:"in 1 to 100 characters",required:"required ",choose:"please choose",enterVerification:"enter verification code",queryForm:"Failed to load pre-query form. Please try again later",getMsg:"The connection is broken. Please refresh the page",connection:"The connection is broken. Please refresh the page",dissatisfaction:"Dissatisfaction",FailedSubmit:"Failed to submit. Please try again later",enterPhoneNumber:"Please fill in the correct mobile phone number",correctVerification:"Please fill in the correct verification code",classification:"please select a type",name:"Please fill in the name correctly",phone:"Please fill in the mobile phone number correctly",email:"Please fill in the email correctly",weChat:"Please fill in the weChat correctly",QQ:"Please fill in the QQ correctly",information:"Please fill in at least one contact information",messageCharacters:"Please keep the message in 1 ~ 1024 characters",submit:"submit",MessageFailed:"Message failed. Please try again later",CancelUpload:"Cancel upload",UploadFailed:"upload failed",UploadedSuccessfully:"Uploaded successfully",onlyPictures:"Can only send pictures",sendLess:"Can only send less than 50MB of documents",upToOnly:"Up to only 2048 characters can be sent",selectRating:"Please select rating",upToCharacters:"Up to 30 characters can be sent",serviceUnavailable:"Sorry, Service unavailable"};t["default"]={zh:n,"zh-tw":a,en:i}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e,t){var n=document.getElementById("alert"),a=document.getElementById("alertInside"),i=document.getElementById("alertHide");clearTimeout(window.alertCountdown);var o=e,r="";"hide"===e&&(o="",r="hide"),a.innerHTML=o,n.className=r;var s=function(){a.innerHTML="",n.className="hide"};t&&(window.alertCountdown=setTimeout(function(){s()},t)),i["class"]||i.addEventListener("click",function(){s(),i.title="close-alert"})}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),o=a(i),r=n(21),s=a(r),l=n(16),u=a(l),c=n(13),d=a(c),f=n(24),p=a(f),g=n(25),m=a(g),v=n(26),h=a(v),b=n(12),y=a(b),_=n(4),w=a(_),k=n(22),x=a(k),T=n(27),E=a(T),C=n(28),I=a(C),S=n(29),j=a(S);t["default"]=function(e){function t(){M.client_info=S,[75507,42961,72508,16,14986].indexOf(w["default"].entId)>-1&&(M.agent_token=w["default"].assignedAgentToken||w["default"].initData.agentTokens||""),M.reserve_token=w["default"].reserve_token,u["default"].ajax({url:o["default"].chat+"/client/tickets_v2",type:"post",dataType:"json",header:B,contentType:"application/json",data:M,beforeSend:function(){d["default"].addClass(n,"disabled"),n.innerHTML=s["default"][w["default"].language].submit},success:function(e){I["default"]("ticket",e.id),j["default"]("ticket",e.id),p["default"](document.getElementById("ticketForm"),"hide"),p["default"](document.getElementById("ticketSuccess"),"show"),d["default"].removeClass(n,"disabled"),n.innerHTML=s["default"][w["default"].language].submit},error:function(e){var t={};try{t=JSON.parse(e.responseText)}catch(a){}x["default"](t.message||s["default"][w["default"].language].MessageFailed,3e3),d["default"].removeClass(n,"disabled"),n.innerHTML=s["default"][w["default"].language].submit}})}var n=document.getElementById("ticketSubmit"),a=document.getElementById("ticketName"),i=document.getElementById("ticketTel"),r=document.getElementById("ticketEmail"),l=document.getElementById("ticketWechat"),c=document.getElementById("ticketQq"),f=document.getElementById("ticketContent"),g=e.contactRule,v="",b="",_="",k="",T="",C="",S={},M={enterprise_id:w["default"].entId,track_id:w["default"].trackId,visit_id:w["default"].visitId,channel:"widget"};if(w["default"].baidu_bid&&(M.baidu_bid=w["default"].baidu_bid),e.categories&&e.categories.length>0){var O=E["default"]("categories");if(!O)return x["default"](s["default"][w["default"].language].classification,3e3),
!1;M.category_id=parseInt(O[0])}if(a&&a.value){if(v=a.value,!(v.length<50))return x["default"](s["default"][w["default"].language].name,3e3),!1;S.name=v}if(i&&i.value){if(b=i.value.trim(),!m["default"].isTel(b))return x["default"](s["default"][w["default"].language].phone,3e3),!1;S.tel=b}if(r&&r.value){if(_=r.value,!m["default"].isEmail(_))return x["default"](s["default"][w["default"].language].email,3e3),!1;S.email=_}if(l&&l.value){if(k=l.value,!(k.length<50))return x["default"](s["default"][w["default"].language].weChat,3e3),!1;S.weixin=k}if(c&&c.value){if(T=c.value,!m["default"].isNum(T))return x["default"](s["default"][w["default"].language].QQ,3e3),!1;S.qq=T}if("single"===g){if(!(S.name||S.tel||S.email||S.weixin||S.qq))return x["default"](s["default"][w["default"].language].information,3e3),!1}else if("multi"===g){if(a&&!S.name)return x["default"](s["default"][w["default"].language].name,3e3),!1;if(i&&!S.tel)return x["default"](s["default"][w["default"].language].phone,3e3),!1;if(r&&!S.email)return x["default"](s["default"][w["default"].language].email,3e3),!1;if(l&&!S.weixin)return x["default"](s["default"][w["default"].language].weChat,3e3),!1;if(c&&!S.qq)return x["default"](s["default"][w["default"].language].QQ,3e3),!1}if(y["default"](S)||u["default"].jsonp({url:o["default"].chat+"/client/attrs_jsonp",data:{ent_id:w["default"].entId,track_id:w["default"].trackId,browser_id:w["default"].browserId,attrs:JSON.stringify(S)},callback:"jsonp_cb",success:function(){}}),C=f.value.trim(),C.length<1||C.length>1024)return x["default"](s["default"][w["default"].language].messageCharacters,3e3),C.length>1024&&h["default"](f,1024,C.length),!1;M.content=C;var B={};if("open"===e.captcha){var A=document.getElementById("ticketCaptcha").value;if(!A)return x["default"](s["default"][w["default"].language].enterVerification,3e3),!1;B={"Captcha-Needed":"true","Captcha-Value":A,"Captcha-Token":w["default"].ticketCaptchaToken}}d["default"].hasClass(n,"disabled")||t()}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e,t){if(!e)return!1;var n="";n=t?"show"===t?"block":"none":0===e.offsetHeight?"block":"none",e.style.display=n}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){return/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)},a=function(e){return isNaN(+e)||e.length<6?!1:!0},i=function(e){var t=/^\d+$/;return t.test(e)},o=function(e){var t=/^(0[1-9]\d[1-9]\d{7}|0[1-9]\d{2}[1-9]\d{6,7}|1\d{10})$/;return t.test(e)};t["default"]={isEmail:n,isTel:a,isNum:i,isPhoneNum:o}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e,t,n){if(e.createTextRange){var a=e.createTextRange();a.collapse(),a.moveEnd("character",n),a.moveStart("character",t),a.select()}e.setSelectionRange&&(e.focus(),e.setSelectionRange(t,n))}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e){for(var t=[],n=document.getElementsByName(e),a=0,i=n.length;i>a;a++)n[a].checked&&t.push(n[a].value);return 0===t.length&&(t=null),t}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),o=a(i),r=n(4),s=a(r),l=n(16),u=a(l),c={conv:1,conversation:1,ticket:2};t["default"]=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!([1,42961,57879].indexOf(parseInt(s["default"].entId))<0)&&e){var n=c[e]||"",a={click_url:s["default"].url,click_title:s["default"].title,click_on:Date.now()||+new Date,type:n,track_id:s["default"].trackId,visit_id:s["default"].visitId,site_id:String((s["default"].metadata||{}).__siteId),business_id:t,enterprise_id:s["default"].entId};u["default"].ajax({url:o["default"].chat+"/conversation/click",type:"post",dataType:"json",contentType:"application/json",data:a,success:function(e){},error:function(e){console.error(e)}})}}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),o=a(i),r=n(16),s=a(r),l=n(4),u=a(l);t["default"]=function(e,t){u["default"].shenmaActionData,u["default"].shenmaActionData.clickid&&s["default"].ajax({url:o["default"].chat+"/shenma/save_action",type:"post",contentType:"application/json",data:{type:e,ent_id:u["default"].entId,click_id:u["default"].shenmaActionData.clickid,business_id:t.toString()},success:function(){}})}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),o=a(i),r=n(16),s=a(r),l=n(4),u=a(l);t["default"]=function(){s["default"].ajax({url:o["default"].chat+"/visit/"+u["default"].entId+"/"+u["default"].trackId+"/reject",type:"post",dataType:"json",contentType:"application/json",data:{browser_id:u["default"].browserId},success:function(){}})}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(13),o=a(i);t["default"]=function(e){"open"===e?(o["default"].removeClass(document.getElementById("iconRing"),"icon-ring-close"),o["default"].addClass(document.getElementById("iconRing"),"icon-ring-open")):(o["default"].removeClass(document.getElementById("iconRing"),"icon-ring-open"),o["default"].addClass(document.getElementById("iconRing"),"icon-ring-close"))}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){v["default"].scheduling||!function(){var n=null,a=null,i=null;e&&!v["default"].surveyRendered?(n=e.agentToken,a=e.groupToken,e.from_type&&(i=e.from_type)):(n=v["default"].agentToken,a=v["default"].groupToken);var o={ent_id:v["default"].entId,track_id:v["default"].trackId,visit_id:v["default"].visitId,agent_token:n,group_token:n?null:a,url:v["default"].url,title:v["default"].title,queueing:!0,from_type:i};switch(v["default"].fallback&&(o.fallback=v["default"].fallback),e&&e.exclude_agent_tokens&&(o.exclude_agent_tokens=e.exclude_agent_tokens),v["default"].convType){case"click":o.conv_initiate_type="client";break;case"newConv":o.conv_initiate_type="client";break;case"autoInvite":o.conv_initiate_type="sys_forced";break;case"manualInvite":o.conv_initiate_type="sys_accepted";break;default:o.conv_initiate_type=null}c["default"].ajax({url:r["default"].chat+"/scheduler",type:"post",contentType:"application/json",data:o,beforeSend:function(){v["default"].scheduling=!0,v["default"].scheduler=!0,b["default"]("header-loading","headLeft",{}),v["default"].page=0,v["default"].historyArray=[],v["default"].historyTimes=0,f["default"](document.getElementById("evaluationHolder"),"hide"),t&&(document.getElementById("evaluationHolder").className="",document.getElementById("evaluationContent").value="",document.getElementById("msgHolder").innerHTML="")},success:function(e){if(v["default"].reserve_token=e.reserve_token,e.success){if(S["default"](),v["default"].isStandalone||v["default"].messenger.targets.parent.send("conversation^@#yes"),v["default"].convId=e.conv.id,v["default"].agentToken=e.agent.token,q["default"]("conv",v["default"].convId),e&&e.agent&&(v["default"].agent=e.agent,v["default"].isBot="bot"===e.agent.privilege),v["default"].convNewCreate=e.conv_new_create,v["default"].groupToken=a,!v["default"].isBasic&&"desktop"===v["default"].device&&v["default"].convNewCreate&&C["default"]("newChat"),"mondeo"===v["default"].style||"fusion"===v["default"].style){var t="header-"+v["default"].style;b["default"](t,"headLeft",{name:e.agent.nickname,signature:e.agent.signature}),b["default"]("profile","profile",{avatar:e.agent.avatar,name:e.agent.nickname,tel:e.agent.telephone,cellphone:e.agent.public_cellphone,email:e.agent.public_email,qq:e.agent.qq,weixin:e.agent.weixin})}else if("customer"===v["default"].style){var n="standalone"===v["default"].type?v["default"].initData.standalone_window_config.desktop:v["default"].initData.widget_settings.desktop.panel;b["default"]("header-customer","headLeft",{photoType:n.customer_photo_type,avatar:e.agent.avatar,name:e.agent.nickname,signature:e.agent.signature}),b["default"]("profile-customer","profile",{name:e.agent.nickname,photoType:n.customer_photo_type,avatar:e.agent.avatar,content:n.customer_content,bgColor:n.theme[2]})}else b["default"]("header","headLeft",{avatar:e.agent.avatar,name:e.agent.nickname,signature:e.agent.signature});if("mobile"===v["default"].device){var i=e.agent.public_cellphone||e.agent.telephone;i&&(document.getElementById("btnTel").href="tel:"+i,f["default"](document.getElementById("btnTel"),"show"))}v["default"].convNewCreate&&($["default"]("conv",v["default"].convId),v["default"].messenger&&!v["default"].initData.in_queue&&v["default"].messenger.targets.parent.send("convClickCallback^@#conv:"+v["default"].convId));var o=e.messages;if(v["default"].convNewCreate||v["default"].isBot||(e.agent_welcome_message&&o.unshift({id:1*new Date,from_type:"agent",content_type:"text",created_on:e.conv.created_on,content:e.agent_welcome_message,type:"message",agent:{nickname:e.agent.nickname,avatar:e.agent.avatar}}),v["default"].initData.ent_welcome_message&&o.unshift({id:1*new Date,from_type:"agent",content_type:"text",created_on:e.conv.created_on,content:v["default"].initData.ent_welcome_message,type:"message",agent:{nickname:"",avatar:v["default"].initData.enterprise_info.avatar||e.agent.avatar||"https://s3-qcloud.meiqia.com/static-files/default-avatar.jpg"}})),L["default"](e.agent&&"bot"===e.agent.privilege),o.length){for(var r=0;r<o.length;r++)v["default"].msgId.push(o[r].action+o[r].id);v["default"].lastMsgDate=o[o.length-1].created_on,"close"===v["default"].initData.enterprise_info.prompt_status&&v["default"].chatHasEnd?v["default"].chatHasEnd=!1:v["default"].schedulerMsg?_["default"](o,"scheduler"):(document.getElementById("msgHolder").innerHTML="",_["default"](o,"scheduler"))}else"close"===v["default"].initData.enterprise_info.prompt_status&&v["default"].chatHasEnd&&(v["default"].chatHasEnd=!1);v["default"].agentSchedulingMsg&&(v["default"].fakeSentMsg.push(v["default"].agentSchedulingMsg),S["default"](),v["default"].agentSchedulingMsg=null),v["default"].history&&k["default"](!0),T["default"]("hide"),"bot"!==e.agent.privilege&&"desktop"===v["default"].device&&N.requestNotifyPermission()}else"queueing"===e.result?(M["default"]("show",{intro:v["default"].initData.queueing_settings.intro,position:e.position}),B["default"](),v["default"].initData.in_queue=!0,v["default"].messenger&&v["default"].messenger.targets.parent.send("convClickCallback^@#queue:")):(q["default"]("ticket"),v["default"].convId=null,v["default"].agentToken=null,v["default"].groupToken=null,v["default"].unableToServe=!0,v["default"].messenger&&v["default"].messenger.targets.parent.send("convClickCallback^@#ticket:"),T["default"]());var s=g["default"].isMobile();s||document.getElementById("textarea").focus(),v["default"].scheduling=!1},error:function(){document.getElementById("loading").innerHTML=l["default"][v["default"].language].NetworkError,v["default"].scheduling=!1}})}()}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=i;var o=n(2),r=a(o),s=n(21),l=a(s),u=n(16),c=a(u),d=n(24),f=a(d),p=n(11),g=a(p),m=n(4),v=a(m),h=n(33),b=a(h),y=n(35),_=a(y),w=n(57),k=a(w),x=n(58),T=a(x),E=n(59),C=a(E),I=n(60),S=a(I),j=n(63),M=a(j),O=n(64),B=a(O),A=n(65),L=a(A),N=n(66),P=n(28),q=a(P),D=n(29),$=a(D)},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(4),o=a(i),r=n(34),s=a(r);t["default"]=function(e,t,n){var a=o["default"].tpl(e,n);document.getElementById(t).innerHTML=a,s["default"]()}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("standalone"!==s["default"].type||"mobile"!==s["default"].device)return!1;if(!document.querySelectorAll||history.length<2)return!1;for(var t=document.querySelectorAll(".header .pull-left"),n=0;n<t.length;++n){var a=t[n];if(a&&!a.querySelector(".back-button")){var i=o(),r=a.querySelector(".agent-info");r||(r=a.querySelector(".title")),r||(r=a.querySelector("#loading"),r&&(r.innerHTML.length&&!e.ignoreLoading?r=null:r.innerHTML.length||(i.className+=" has-words"))),r&&a.insertBefore&&a.insertBefore(i,r)}}}function o(){var e=document.createElement("a");return e.className="back-button",e.innerHTML="<span></span>",e.onclick=function(){return history.back(-1)},e}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=i;var r=n(4),s=a(r)},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){return I.sequence(function(e){return linkifyStr(e)},function(e){return T["default"].convertTel(e)},function(e){return T["default"].convertBr(e)},function(e){return k["default"](e,f["default"].cdn+"/images/emoji")})(e)}function o(e){return I.map(e,function(e){return"text"===e.type?e.text=e.rich_text?u(e.text):i(e.text):"menu"===e.type&&(e.items=I.map(e.items,function(e){return e.text=i(e.text,!0),e})),e})}function r(e){var t=(new Date).getTime(),n="";return e.uploading?void 0:(n=new Date(e.extra.expire_at).getTime(),n=(n-t)/1e3,n>=3600?n=parseInt(Math.round(n/3600))+g["default"][q["default"].language].Hours:n>=60?n=parseInt(n/60)+g["default"][q["default"].language].Minutes:n+=g["default"][q["default"].language].Seconds,n)}function s(e){return I.map(e,function(e){var t=e.content,n=e.content_robot,a=e.content_type,s=e.from_type;return/^(text|welcome|bot)$/.test(a)&&(j["default"].string(t)&&(e.content=i(t)),j["default"].array(n)&&"bot"===s&&(e.content_robot=o(n))),"file"===a&&(e.extra.convert_size=C["default"](e.extra.size,0),e.extra.has_expired=r(e)),"rich_text"===a&&(e.extra.content=u(e.extra.content)),e})}function l(e){return I.map(e,function(e){return"evaluate"===e.sub_type&&(e.sub_type="message"),e})}function u(e){return v["default"](e,{onIgnoreTagAttr:function(e,t,n,a){return"style"===t?t+'="'+v["default"].escapeAttrValue(n)+'"':void 0}})}function c(e,t){var n=O["default"].isThisDevice("micromessenger");return"normal"!==t&&(e=l(e)),e.forEach(function(e){return e.displayDate=A["default"](e.created_on),e}),"history"===t?q["default"].tpl("msg",{list:e.reverse(),historyTimes:q["default"].historyTimes,weixin:n}):q["default"].tpl("msg",{list:e,weixin:n})}Object.defineProperty(t,"__esModule",{value:!0}),t.transformText=i,t.transformBotText=o,t.normalizeDate=r,t.convert=s,t.compile=c;var d=n(2),f=a(d),p=n(21),g=a(p),m=n(36),v=a(m),h=n(46),b=a(h),y=n(10),_=a(y),w=n(47),k=a(w),x=n(48),T=a(x),E=n(49),C=a(E),I=n(50),S=n(51),j=a(S),M=n(11),O=a(M),B=n(52),A=a(B),L=n(53),N=a(L),P=n(4),q=a(P);n(55),n(56),t["default"]=function(e,t){var n=document.getElementById("msgHolder"),a=document.createElement("div");a.className="msg-box",a.innerHTML=c(s(e),t);var i=e[e.length-1],o=document.getElementById(i.id);if("scheduler"===t){if(o)return;if(n.appendChild(a),("text"===i.content_type||"bot"===i.content_type)&&i.content_robot&&i.content_robot.length)return;_["default"]("msgWrapper")}else"history"===t?(document.getElementById("moreHistoryBtn")?b["default"](a,document.getElementById("moreHistoryBtn")):n.insertBefore(a,n.firstChild),1===q["default"].historyTimes&&_["default"]("msgWrapper")):(n.appendChild(a),_["default"]("msgWrapper"));var r=O["default"].isMobile();r&&N["default"](n.getElementsByTagName("img"))}},function(e,t,n){function a(e,t){var n=new s(t);return n.process(e)}var i,o=n(37),r=n(44),s=n(45);t=e.exports=a,t.FilterXSS=s;for(var l in o)t[l]=o[l];for(var l in r)t[l]=r[l];i=function(){return e.exports}.call(t,n,t,e),!(void 0!==i&&(e.exports=i)),"undefined"!=typeof window&&(window.filterXSS=e.exports)},function(e,t,n){"use strict";function a(){return{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","loop","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],sup:[],strong:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","colspan","align","valign"],tfoot:["align","valign"],th:["width","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","loop","preload","src","height","width"]}}function i(e,t,n){}function o(e,t,n){}function r(e,t,n){}function s(e,t,n){}function l(e){return e.replace(T,"&lt;").replace(E,"&gt;")}function u(e,t,n,a){if(a=a||x,n=m(n),"href"===t||"src"===t){if(n=k.trim(n),"#"===n)return"#";if("http://"!==n.substr(0,7)&&"https://"!==n.substr(0,8)&&"mailto:"!==n.substr(0,7)&&"#"!==n[0]&&"/"!==n[0])return""}else if("background"===t){if(O.lastIndex=0,O.test(n))return""}else if("style"===t){if(B.lastIndex=0,B.test(n))return"";if(A.lastIndex=0,A.test(n)&&(O.lastIndex=0,O.test(n)))return"";n=a.process(n)}return n=v(n)}function c(e){return e.replace(C,"&quot;")}function d(e){return e.replace(I,'"')}function f(e){return e.replace(S,function(e,t){return String.fromCharCode("x"===t[0]||"X"===t[0]?parseInt(t.substr(1),16):parseInt(t,10))})}function p(e){return e.replace(j,":").replace(M," ")}function g(e){for(var t="",n=0,a=e.length;a>n;n++)t+=e.charCodeAt(n)<32?" ":e.charAt(n);return k.trim(t)}function m(e){return e=d(e),e=f(e),e=p(e),e=g(e)}function v(e){return e=c(e),e=l(e)}function h(){return""}function b(e,t){function n(t){return a?!0:-1!==k.indexOf(e,t)}"function"!=typeof t&&(t=function(){});var a=!Array.isArray(e),i=[],o=!1;return{onIgnoreTag:function(e,a,r){if(n(e)){if(r.isClosing){var s="[/removed]",l=r.position+s.length;return i.push([o!==!1?o:r.position,l]),o=!1,s}return o||(o=r.position),"[removed]"}return t(e,a,r)},remove:function(e){var t="",n=0;return k.forEach(i,function(a){t+=e.slice(n,a[0]),n=a[1]}),t+=e.slice(n)}}}function y(e){return e.replace(L,"")}function _(e){var t=e.split("");return t=t.filter(function(e){var t=e.charCodeAt(0);return 127===t?!1:31>=t?10===t||13===t?!0:!1:!0}),t.join("")}var w=n(38).FilterCSS,k=n(43),x=new w,T=/</g,E=/>/g,C=/"/g,I=/&quot;/g,S=/&#([a-zA-Z0-9]*);?/gim,j=/&colon;?/gim,M=/&newline;?/gim,O=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a)\:/gi,B=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,A=/u\s*r\s*l\s*\(.*/gi,L=/<!--[\s\S]*?-->/g;t.whiteList=a(),t.getDefaultWhiteList=a,t.onTag=i,t.onIgnoreTag=o,t.onTagAttr=r,t.onIgnoreTagAttr=s,t.safeAttrValue=u,t.escapeHtml=l,t.escapeQuote=c,t.unescapeQuote=d,t.escapeHtmlEntities=f,t.escapeDangerHtml5Entities=p,t.clearNonPrintableCharacter=g,t.friendlyAttrValue=m,t.escapeAttrValue=v,t.onIgnoreTagStripAll=h,t.StripTagBody=b,t.stripCommentTag=y,t.stripBlankChar=_,t.cssFilter=x},function(e,t,n){function a(e,t){var n=new r(t);return n.process(e)}var i,o=n(39),r=n(40);t=e.exports=a,t.FilterCSS=r;for(var s in o)t[s]=o[s];i=function(){return e.exports}.call(t,n,t,e),!(void 0!==i&&(e.exports=i)),"undefined"!=typeof window&&(window.filterCSS=e.exports)},function(e,t){"use strict";function n(){var e={};return e["align-content"]=!1,e["align-items"]=!1,e["align-self"]=!1,e["alignment-adjust"]=!1,e["alignment-baseline"]=!1,e.all=!1,e["anchor-point"]=!1,e.animation=!1,e["animation-delay"]=!1,e["animation-direction"]=!1,e["animation-duration"]=!1,e["animation-fill-mode"]=!1,e["animation-iteration-count"]=!1,e["animation-name"]=!1,e["animation-play-state"]=!1,e["animation-timing-function"]=!1,e.azimuth=!1,e["backface-visibility"]=!1,e.background=!0,e["background-attachment"]=!0,e["background-clip"]=!0,e["background-color"]=!0,e["background-image"]=!0,e["background-origin"]=!0,e["background-position"]=!0,e["background-repeat"]=!0,e["background-size"]=!0,e["baseline-shift"]=!1,e.binding=!1,e.bleed=!1,e["bookmark-label"]=!1,e["bookmark-level"]=!1,e["bookmark-state"]=!1,e.border=!0,e["border-bottom"]=!0,e["border-bottom-color"]=!0,e["border-bottom-left-radius"]=!0,e["border-bottom-right-radius"]=!0,e["border-bottom-style"]=!0,e["border-bottom-width"]=!0,e["border-collapse"]=!0,e["border-color"]=!0,e["border-image"]=!0,e["border-image-outset"]=!0,e["border-image-repeat"]=!0,e["border-image-slice"]=!0,e["border-image-source"]=!0,e["border-image-width"]=!0,e["border-left"]=!0,e["border-left-color"]=!0,e["border-left-style"]=!0,e["border-left-width"]=!0,e["border-radius"]=!0,e["border-right"]=!0,e["border-right-color"]=!0,e["border-right-style"]=!0,e["border-right-width"]=!0,e["border-spacing"]=!0,e["border-style"]=!0,e["border-top"]=!0,e["border-top-color"]=!0,e["border-top-left-radius"]=!0,e["border-top-right-radius"]=!0,e["border-top-style"]=!0,e["border-top-width"]=!0,e["border-width"]=!0,e.bottom=!1,e["box-decoration-break"]=!0,e["box-shadow"]=!0,e["box-sizing"]=!0,e["box-snap"]=!0,e["box-suppress"]=!0,e["break-after"]=!0,e["break-before"]=!0,e["break-inside"]=!0,e["caption-side"]=!1,e.chains=!1,e.clear=!0,e.clip=!1,e["clip-path"]=!1,e["clip-rule"]=!1,e.color=!0,e["color-interpolation-filters"]=!0,e["column-count"]=!1,e["column-fill"]=!1,e["column-gap"]=!1,e["column-rule"]=!1,e["column-rule-color"]=!1,e["column-rule-style"]=!1,e["column-rule-width"]=!1,e["column-span"]=!1,e["column-width"]=!1,e.columns=!1,e.contain=!1,e.content=!1,e["counter-increment"]=!1,e["counter-reset"]=!1,e["counter-set"]=!1,e.crop=!1,e.cue=!1,e["cue-after"]=!1,e["cue-before"]=!1,e.cursor=!1,e.direction=!1,e.display=!0,e["display-inside"]=!0,e["display-list"]=!0,e["display-outside"]=!0,e["dominant-baseline"]=!1,e.elevation=!1,e["empty-cells"]=!1,e.filter=!1,e.flex=!1,e["flex-basis"]=!1,e["flex-direction"]=!1,e["flex-flow"]=!1,e["flex-grow"]=!1,e["flex-shrink"]=!1,e["flex-wrap"]=!1,e["float"]=!1,e["float-offset"]=!1,e["flood-color"]=!1,e["flood-opacity"]=!1,e["flow-from"]=!1,e["flow-into"]=!1,e.font=!0,e["font-family"]=!0,e["font-feature-settings"]=!0,e["font-kerning"]=!0,e["font-language-override"]=!0,e["font-size"]=!0,e["font-size-adjust"]=!0,e["font-stretch"]=!0,e["font-style"]=!0,e["font-synthesis"]=!0,e["font-variant"]=!0,e["font-variant-alternates"]=!0,e["font-variant-caps"]=!0,e["font-variant-east-asian"]=!0,e["font-variant-ligatures"]=!0,e["font-variant-numeric"]=!0,e["font-variant-position"]=!0,e["font-weight"]=!0,e.grid=!1,e["grid-area"]=!1,e["grid-auto-columns"]=!1,e["grid-auto-flow"]=!1,e["grid-auto-rows"]=!1,e["grid-column"]=!1,e["grid-column-end"]=!1,e["grid-column-start"]=!1,e["grid-row"]=!1,e["grid-row-end"]=!1,e["grid-row-start"]=!1,e["grid-template"]=!1,e["grid-template-areas"]=!1,e["grid-template-columns"]=!1,e["grid-template-rows"]=!1,e["hanging-punctuation"]=!1,e.height=!0,e.hyphens=!1,e.icon=!1,e["image-orientation"]=!1,e["image-resolution"]=!1,e["ime-mode"]=!1,e["initial-letters"]=!1,e["inline-box-align"]=!1,e["justify-content"]=!1,e["justify-items"]=!1,e["justify-self"]=!1,e.left=!1,e["letter-spacing"]=!0,e["lighting-color"]=!0,e["line-box-contain"]=!1,e["line-break"]=!1,e["line-grid"]=!1,e["line-height"]=!1,e["line-snap"]=!1,e["line-stacking"]=!1,e["line-stacking-ruby"]=!1,e["line-stacking-shift"]=!1,e["line-stacking-strategy"]=!1,e["list-style"]=!0,e["list-style-image"]=!0,e["list-style-position"]=!0,e["list-style-type"]=!0,e.margin=!0,e["margin-bottom"]=!0,e["margin-left"]=!0,e["margin-right"]=!0,e["margin-top"]=!0,e["marker-offset"]=!1,e["marker-side"]=!1,e.marks=!1,e.mask=!1,e["mask-box"]=!1,e["mask-box-outset"]=!1,e["mask-box-repeat"]=!1,e["mask-box-slice"]=!1,e["mask-box-source"]=!1,e["mask-box-width"]=!1,e["mask-clip"]=!1,e["mask-image"]=!1,e["mask-origin"]=!1,e["mask-position"]=!1,e["mask-repeat"]=!1,e["mask-size"]=!1,e["mask-source-type"]=!1,e["mask-type"]=!1,e["max-height"]=!0,e["max-lines"]=!1,e["max-width"]=!0,e["min-height"]=!0,e["min-width"]=!0,e["move-to"]=!1,e["nav-down"]=!1,e["nav-index"]=!1,e["nav-left"]=!1,e["nav-right"]=!1,e["nav-up"]=!1,e["object-fit"]=!1,e["object-position"]=!1,e.opacity=!1,e.order=!1,e.orphans=!1,e.outline=!1,e["outline-color"]=!1,e["outline-offset"]=!1,e["outline-style"]=!1,e["outline-width"]=!1,e.overflow=!1,e["overflow-wrap"]=!1,e["overflow-x"]=!1,e["overflow-y"]=!1,e.padding=!0,e["padding-bottom"]=!0,e["padding-left"]=!0,e["padding-right"]=!0,e["padding-top"]=!0,e.page=!1,e["page-break-after"]=!1,e["page-break-before"]=!1,e["page-break-inside"]=!1,e["page-policy"]=!1,e.pause=!1,e["pause-after"]=!1,e["pause-before"]=!1,e.perspective=!1,e["perspective-origin"]=!1,e.pitch=!1,e["pitch-range"]=!1,e["play-during"]=!1,e.position=!1,e["presentation-level"]=!1,e.quotes=!1,e["region-fragment"]=!1,e.resize=!1,e.rest=!1,e["rest-after"]=!1,e["rest-before"]=!1,e.richness=!1,e.right=!1,e.rotation=!1,e["rotation-point"]=!1,e["ruby-align"]=!1,e["ruby-merge"]=!1,e["ruby-position"]=!1,e["shape-image-threshold"]=!1,e["shape-outside"]=!1,e["shape-margin"]=!1,e.size=!1,e.speak=!1,e["speak-as"]=!1,e["speak-header"]=!1,e["speak-numeral"]=!1,e["speak-punctuation"]=!1,e["speech-rate"]=!1,e.stress=!1,e["string-set"]=!1,e["tab-size"]=!1,e["table-layout"]=!1,e["text-align"]=!0,e["text-align-last"]=!0,e["text-combine-upright"]=!0,e["text-decoration"]=!0,e["text-decoration-color"]=!0,e["text-decoration-line"]=!0,e["text-decoration-skip"]=!0,e["text-decoration-style"]=!0,e["text-emphasis"]=!0,e["text-emphasis-color"]=!0,e["text-emphasis-position"]=!0,e["text-emphasis-style"]=!0,e["text-height"]=!0,e["text-indent"]=!0,e["text-justify"]=!0,e["text-orientation"]=!0,e["text-overflow"]=!0,e["text-shadow"]=!0,e["text-space-collapse"]=!0,e["text-transform"]=!0,e["text-underline-position"]=!0,e["text-wrap"]=!0,e.top=!1,e.transform=!1,e["transform-origin"]=!1,e["transform-style"]=!1,e.transition=!1,e["transition-delay"]=!1,e["transition-duration"]=!1,e["transition-property"]=!1,e["transition-timing-function"]=!1,e["unicode-bidi"]=!1,e["vertical-align"]=!1,e.visibility=!1,e["voice-balance"]=!1,e["voice-duration"]=!1,e["voice-family"]=!1,e["voice-pitch"]=!1,e["voice-range"]=!1,e["voice-rate"]=!1,e["voice-stress"]=!1,e["voice-volume"]=!1,e.volume=!1,e["white-space"]=!1,e.widows=!1,e.width=!0,e["will-change"]=!1,e["word-break"]=!0,e["word-spacing"]=!0,e["word-wrap"]=!0,e["wrap-flow"]=!1,e["wrap-through"]=!1,e["writing-mode"]=!1,e["z-index"]=!1,e}function a(e,t,n){}function i(e,t,n){}t.whiteList=n(),t.getDefaultWhiteList=n,t.onAttr=a,t.onIgnoreAttr=i},function(e,t,n){"use strict";function a(e){return void 0===e||null===e}function i(e){e=e||{},e.whiteList=e.whiteList||o.whiteList,e.onAttr=e.onAttr||o.onAttr,e.onIgnoreAttr=e.onIgnoreAttr||o.onIgnoreAttr,this.options=e}{var o=n(39),r=n(41);n(42)}i.prototype.process=function(e){if(e=e||"",e=e.toString(),!e)return"";var t=this,n=t.options,i=n.whiteList,o=n.onAttr,s=n.onIgnoreAttr,l=r(e,function(e,t,n,r,l){var u=i[n],c=!1;u===!0?c=u:"function"==typeof u?c=u(r):u instanceof RegExp&&(c=u.test(r)),c!==!0&&(c=!1);var d={position:t,sourcePosition:e,source:l,isWhite:c};if(c){var f=o(n,r,d);return a(f)?n+":"+r:f}var f=s(n,r,d);return a(f)?void 0:f});return l},e.exports=i},function(e,t,n){"use strict";function a(e,t){function n(){if(!o){var n=i.trim(e.slice(r,s)),a=n.indexOf(":");if(-1!==a){var u=i.trim(n.slice(0,a)),c=i.trim(n.slice(a+1));if(u){var d=t(r,l.length,u,c,n);d&&(l+=d+"; ")}}}r=s+1}e=i.trimRight(e),";"!==e[e.length-1]&&(e+=";");for(var a=e.length,o=!1,r=0,s=0,l="";a>s;s++){var u=e[s];if("/"===u&&"*"===e[s+1]){var c=e.indexOf("*/",s+2);if(-1===c)break;s=c+1,r=s+1,o=!1}else"("===u?o=!0:")"===u?o=!1:";"===u?o||n():"\n"===u&&n()}return i.trim(l)}var i=n(42);e.exports=a},function(e,t){"use strict";e.exports={indexOf:function(e,t){var n,a;if(Array.prototype.indexOf)return e.indexOf(t);for(n=0,a=e.length;a>n;n++)if(e[n]===t)return n;return-1},forEach:function(e,t,n){var a,i;if(Array.prototype.forEach)return e.forEach(t,n);for(a=0,i=e.length;i>a;a++)t.call(n,e[a],a,e)},trim:function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")},trimRight:function(e){return String.prototype.trimRight?e.trimRight():e.replace(/(\s*$)/g,"")}}},function(e,t){"use strict";e.exports={indexOf:function(e,t){var n,a;if(Array.prototype.indexOf)return e.indexOf(t);for(n=0,a=e.length;a>n;n++)if(e[n]===t)return n;return-1},forEach:function(e,t,n){var a,i;if(Array.prototype.forEach)return e.forEach(t,n);for(a=0,i=e.length;i>a;a++)t.call(n,e[a],a,e)},trim:function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")}}},function(e,t,n){"use strict";function a(e){var t=e.indexOf(" ");if(-1===t)var n=e.slice(1,-1);else var n=e.slice(1,t+1);return n=d.trim(n).toLowerCase(),"/"===n.slice(0,1)&&(n=n.slice(1)),"/"===n.slice(-1)&&(n=n.slice(0,-1)),n}function i(e){return"</"===e.slice(0,2)}function o(e,t,n){"user strict";var o="",r=0,s=!1,l=!1,u=0,c=e.length,d="",f="";for(u=0;c>u;u++){var p=e.charAt(u);if(s===!1){if("<"===p){s=u;continue}}else if(l===!1){if("<"===p){o+=n(e.slice(r,u)),s=u,r=u;continue}if(">"===p){o+=n(e.slice(r,s)),d=e.slice(s,u+1),f=a(d),o+=t(s,o.length,f,d,i(d)),r=u+1,s=!1;continue}if(('"'===p||"'"===p)&&"="===e.charAt(u-1)){l=p;continue}}else if(p===l){l=!1;continue}}return r<e.length&&(o+=n(e.substr(r))),o}function r(e,t){"user strict";function n(e,n){if(e=d.trim(e),e=e.replace(f,"").toLowerCase(),!(e.length<1)){var a=t(e,n||"");a&&i.push(a)}}for(var a=0,i=[],o=!1,r=e.length,u=0;r>u;u++){var p,g,m=e.charAt(u);if(o!==!1||"="!==m)if(o===!1||u!==a||'"'!==m&&"'"!==m||"="!==e.charAt(u-1))if(" "!==m);else{if(o===!1){if(g=s(e,u),-1===g){p=d.trim(e.slice(a,u)),n(p),o=!1,a=u+1;continue}u=g-1;continue}if(g=l(e,u-1),-1===g){p=d.trim(e.slice(a,u)),p=c(p),n(o,p),o=!1,a=u+1;continue}}else{if(g=e.indexOf(m,u+1),-1===g)break;p=d.trim(e.slice(a+1,g)),n(o,p),o=!1,u=g,a=u+1}else o=e.slice(a,u),a=u+1}return a<e.length&&(o===!1?n(e.slice(a)):n(o,c(d.trim(e.slice(a))))),d.trim(i.join(" "))}function s(e,t){for(;t<e.length;t++){var n=e[t];if(" "!==n)return"="===n?t:-1}}function l(e,t){for(;t>0;t--){var n=e[t];if(" "!==n)return"="===n?t:-1}}function u(e){return'"'===e[0]&&'"'===e[e.length-1]||"'"===e[0]&&"'"===e[e.length-1]?!0:!1}function c(e){return u(e)?e.substr(1,e.length-2):e}var d=n(43),f=/[^a-zA-Z0-9_:\.\-]/gim;t.parseTag=o,t.parseAttr=r},function(e,t,n){"use strict";function a(e){return void 0===e||null===e}function i(e){var t=e.indexOf(" ");if(-1===t)return{html:"",closing:"/"===e[e.length-2]};e=d.trim(e.slice(t+1,-1));var n="/"===e[e.length-1];return n&&(e=d.trim(e.slice(0,-1))),{html:e,closing:n}}function o(e){e=e||{},e.stripIgnoreTag&&(e.onIgnoreTag&&console.error('Notes: cannot use these two options "stripIgnoreTag" and "onIgnoreTag" at the same time'),e.onIgnoreTag=s.onIgnoreTagStripAll),e.whiteList=e.whiteList||s.whiteList,e.onTag=e.onTag||s.onTag,e.onTagAttr=e.onTagAttr||s.onTagAttr,e.onIgnoreTag=e.onIgnoreTag||s.onIgnoreTag,e.onIgnoreTagAttr=e.onIgnoreTagAttr||s.onIgnoreTagAttr,e.safeAttrValue=e.safeAttrValue||s.safeAttrValue,e.escapeHtml=e.escapeHtml||s.escapeHtml,e.css=e.css||{},this.options=e,this.cssFilter=new r(e.css)}var r=n(38).FilterCSS,s=n(37),l=n(44),u=l.parseTag,c=l.parseAttr,d=n(43);o.prototype.process=function(e){if(e=e||"",e=e.toString(),!e)return"";var t=this,n=t.options,o=n.whiteList,r=n.onTag,l=n.onIgnoreTag,f=n.onTagAttr,p=n.onIgnoreTagAttr,g=n.safeAttrValue,m=n.escapeHtml,v=t.cssFilter;n.stripBlankChar&&(e=s.stripBlankChar(e)),n.allowCommentTag||(e=s.stripCommentTag(e));var h=!1;if(n.stripIgnoreTagBody){var h=s.StripTagBody(n.stripIgnoreTagBody,l);l=h.onIgnoreTag}var b=u(e,function(e,t,n,s,u){var h={sourcePosition:e,position:t,isClosing:u,isWhite:n in o},b=r(n,s,h);if(!a(b))return b;if(h.isWhite){if(h.isClosing)return"</"+n+">";

var y=i(s),_=o[n],w=c(y.html,function(e,t){var i=-1!==d.indexOf(_,e),o=f(n,e,t,i);if(!a(o))return o;if(i)return t=g(n,e,t,v),t?e+'="'+t+'"':e;var o=p(n,e,t,i);return a(o)?void 0:o}),s="<"+n;return w&&(s+=" "+w),y.closing&&(s+=" /"),s+=">"}var b=l(n,s,h);return a(b)?m(s):b},m);return h&&(b=h.remove(b)),b},e.exports=o},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e,t){t.parentNode.insertBefore(e,t.nextSibling)}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={title:function(e,t,n){return null!=n?""+n+" ("+t+")":t},alt:function(e){return e}},a="emoji",i=function(e,t,n,a){var i=void 0,o=void 0,r=void 0,s=void 0;o="<img class='"+n+"' src='"+t+"/"+encodeURIComponent(e[1])+".png' ",s=a.attributes;for(i in s)r=s[i],o+=""+i+"='"+r.apply(a,e)+"' ";return o+"/>"},o=/\:([a-z0-9_+-]+)(?:\[((?:[^\]]|\][^:])*\]?)\])?\:/g,r=function(){return["+1","-1","100","1234","8ball","a","ab","abc","abcd","accept","aerial_tramway","airplane","alarm_clock","alien","ambulance","anchor","angel","anger","angry","anguished","ant","apple","aquarius","aries","arrow_backward","arrow_double_down","arrow_double_up","arrow_down","arrow_down_small","arrow_forward","arrow_heading_down","arrow_heading_up","arrow_left","arrow_lower_left","arrow_lower_right","arrow_right","arrow_right_hook","arrow_up","arrow_up_down","arrow_up_small","arrow_upper_left","arrow_upper_right","arrows_clockwise","arrows_counterclockwise","art","articulated_lorry","astonished","atm","b","baby","baby_bottle","baby_chick","baby_symbol","baggage_claim","balloon","ballot_box_with_check","bamboo","banana","bangbang","bank","bar_chart","barber","baseball","basketball","bath","bathtub","battery","bear","bee","beer","beers","beetle","beginner","bell","bento","bicyclist","bike","bikini","bird","birthday","black_circle","black_joker","black_nib","black_square","black_square_button","blossom","blowfish","blue_book","blue_car","blue_heart","blush","boar","boat","bomb","book","bookmark","bookmark_tabs","books","boom","boot","bouquet","bow","bowling","bowtie","boy","bread","bride_with_veil","bridge_at_night","briefcase","broken_heart","bug","bulb","bullettrain_front","bullettrain_side","bus","busstop","bust_in_silhouette","busts_in_silhouette","cactus","cake","calendar","calling","camel","camera","cancer","candy","capital_abcd","capricorn","car","card_index","carousel_horse","cat","cat2","cd","chart","chart_with_downwards_trend","chart_with_upwards_trend","checkered_flag","cherries","cherry_blossom","chestnut","chicken","children_crossing","chocolate_bar","christmas_tree","church","cinema","circus_tent","city_sunrise","city_sunset","cl","clap","clapper","clipboard","clock1","clock10","clock1030","clock11","clock1130","clock12","clock1230","clock130","clock2","clock230","clock3","clock330","clock4","clock430","clock5","clock530","clock6","clock630","clock7","clock730","clock8","clock830","clock9","clock930","closed_book","closed_lock_with_key","closed_umbrella","cloud","clubs","cn","cocktail","coffee","cold_sweat","collision","computer","confetti_ball","confounded","confused","congratulations","construction","construction_worker","convenience_store","cookie","cool","cop","copyright","corn","couple","couple_with_heart","couplekiss","cow","cow2","credit_card","crocodile","crossed_flags","crown","cry","crying_cat_face","crystal_ball","cupid","curly_loop","currency_exchange","curry","custard","customs","cyclone","dancer","dancers","dango","dart","dash","date","de","deciduous_tree","department_store","diamond_shape_with_a_dot_inside","diamonds","disappointed","disappointed_relieved","dizzy","dizzy_face","do_not_litter","dog","dog2","dollar","dolls","dolphin","donut","door","doughnut","dragon","dragon_face","dress","dromedary_camel","droplet","dvd","e-mail","ear","ear_of_rice","earth_africa","earth_americas","earth_asia","egg","eggplant","eight","eight_pointed_black_star","eight_spoked_asterisk","electric_plug","elephant","email","end","envelope","es","euro","european_castle","european_post_office","evergreen_tree","exclamation","expressionless","eyeglasses","eyes","facepunch","factory","fallen_leaf","family","fast_forward","fax","fearful","feelsgood","feet","ferris_wheel","file_folder","finnadie","fire","fire_engine","fireworks","first_quarter_moon","first_quarter_moon_with_face","fish","fish_cake","fishing_pole_and_fish","fist","five","flags","flashlight","floppy_disk","flower_playing_cards","flushed","foggy","football","fork_and_knife","fountain","four","four_leaf_clover","fr","free","fried_shrimp","fries","frog","frowning","fu","fuelpump","full_moon","full_moon_with_face","game_die","gb","gem","gemini","ghost","gift","gift_heart","girl","globe_with_meridians","goat","goberserk","godmode","golf","grapes","green_apple","green_book","green_heart","grey_exclamation","grey_question","grimacing","grin","grinning","guardsman","guitar","gun","haircut","hamburger","hammer","hamster","hand","handbag","hankey","hash","hatched_chick","hatching_chick","headphones","hear_no_evil","heart","heart_decoration","heart_eyes","heart_eyes_cat","heartbeat","heartpulse","hearts","heavy_check_mark","heavy_division_sign","heavy_dollar_sign","heavy_exclamation_mark","heavy_minus_sign","heavy_multiplication_x","heavy_plus_sign","helicopter","herb","hibiscus","high_brightness","high_heel","hocho","honey_pot","honeybee","horse","horse_racing","hospital","hotel","hotsprings","hourglass","hourglass_flowing_sand","house","house_with_garden","hurtrealbad","hushed","ice_cream","icecream","id","ideograph_advantage","imp","inbox_tray","incoming_envelope","information_desk_person","information_source","innocent","interrobang","iphone","it","izakaya_lantern","jack_o_lantern","japan","japanese_castle","japanese_goblin","japanese_ogre","jeans","joy","joy_cat","jp","key","keycap_ten","kimono","kiss","kissing","kissing_cat","kissing_closed_eyes","kissing_face","kissing_heart","kissing_smiling_eyes","koala","koko","kr","large_blue_circle","large_blue_diamond","large_orange_diamond","last_quarter_moon","last_quarter_moon_with_face","laughing","leaves","ledger","left_luggage","left_right_arrow","leftwards_arrow_with_hook","lemon","leo","leopard","libra","light_rail","link","lips","lipstick","lock","lock_with_ink_pen","lollipop","loop","loudspeaker","love_hotel","love_letter","low_brightness","m","mag","mag_right","mahjong","mailbox","mailbox_closed","mailbox_with_mail","mailbox_with_no_mail","man","man_with_gua_pi_mao","man_with_turban","mans_shoe","maple_leaf","mask","massage","meat_on_bone","mega","melon","memo","mens","metal","metro","microphone","microscope","milky_way","minibus","minidisc","mobile_phone_off","money_with_wings","moneybag","monkey","monkey_face","monorail","moon","mortar_board","mount_fuji","mountain_bicyclist","mountain_cableway","mountain_railway","mouse","mouse2","movie_camera","moyai","muscle","mushroom","musical_keyboard","musical_note","musical_score","mute","nail_care","name_badge","neckbeard","necktie","negative_squared_cross_mark","neutral_face","new","new_moon","new_moon_with_face","newspaper","ng","nine","no_bell","no_bicycles","no_entry","no_entry_sign","no_good","no_mobile_phones","no_mouth","no_pedestrians","no_smoking","non-potable_water","nose","notebook","notebook_with_decorative_cover","notes","nut_and_bolt","o","o2","ocean","octocat","octopus","oden","office","ok","ok_hand","ok_woman","older_man","older_woman","on","oncoming_automobile","oncoming_bus","oncoming_police_car","oncoming_taxi","one","open_file_folder","open_hands","open_mouth","ophiuchus","orange_book","outbox_tray","ox","page_facing_up","page_with_curl","pager","palm_tree","panda_face","paperclip","parking","part_alternation_mark","partly_sunny","passport_control","paw_prints","peach","pear","pencil","pencil2","penguin","pensive","performing_arts","persevere","person_frowning","person_with_blond_hair","person_with_pouting_face","phone","pig","pig2","pig_nose","pill","pineapple","pisces","pizza","plus1","point_down","point_left","point_right","point_up","point_up_2","police_car","poodle","poop","post_office","postal_horn","postbox","potable_water","pouch","poultry_leg","pound","pouting_cat","pray","princess","punch","purple_heart","purse","pushpin","put_litter_in_its_place","question","rabbit","rabbit2","racehorse","radio","radio_button","rage","rage1","rage2","rage3","rage4","railway_car","rainbow","raised_hand","raised_hands","raising_hand","ram","ramen","rat","recycle","red_car","red_circle","registered","relaxed","relieved","repeat","repeat_one","restroom","revolving_hearts","rewind","ribbon","rice","rice_ball","rice_cracker","rice_scene","ring","rocket","roller_coaster","rooster","rose","rotating_light","round_pushpin","rowboat","ru","rugby_football","runner","running","running_shirt_with_sash","sa","sagittarius","sailboat","sake","sandal","santa","satellite","satisfied","saxophone","school","school_satchel","scissors","scorpius","scream","scream_cat","scroll","seat","secret","see_no_evil","seedling","seven","shaved_ice","sheep","shell","ship","shipit","shirt","shit","shoe","shower","signal_strength","six","six_pointed_star","ski","skull","sleeping","sleepy","slot_machine","small_blue_diamond","small_orange_diamond","small_red_triangle","small_red_triangle_down","smile","smile_cat","smiley","smiley_cat","smiling_imp","smirk","smirk_cat","smoking","snail","snake","snowboarder","snowflake","snowman","sob","soccer","soon","sos","sound","space_invader","spades","spaghetti","sparkler","sparkles","sparkling_heart","speak_no_evil","speaker","speech_balloon","speedboat","squirrel","star","star2","stars","station","statue_of_liberty","steam_locomotive","stew","straight_ruler","strawberry","stuck_out_tongue","stuck_out_tongue_closed_eyes","stuck_out_tongue_winking_eye","sun_with_face","sunflower","sunglasses","sunny","sunrise","sunrise_over_mountains","surfer","sushi","suspect","suspension_railway","sweat","sweat_drops","sweat_smile","sweet_potato","swimmer","symbols","syringe","tada","tanabata_tree","tangerine","taurus","taxi","tea","telephone","telephone_receiver","telescope","tennis","tent","thought_balloon","three","thumbsdown","thumbsup","ticket","tiger","tiger2","tired_face","tm","toilet","tokyo_tower","tomato","tongue","top","tophat","tractor","traffic_light","train","train2","tram","triangular_flag_on_post","triangular_ruler","trident","triumph","trolleybus","trollface","trophy","tropical_drink","tropical_fish","truck","trumpet","tshirt","tulip","turtle","tv","twisted_rightwards_arrows","two","two_hearts","two_men_holding_hands","two_women_holding_hands","u5272","u5408","u55b6","u6307","u6708","u6709","u6e80","u7121","u7533","u7981","u7a7a","uk","umbrella","unamused","underage","unlock","up","us","v","vertical_traffic_light","vhs","vibration_mode","video_camera","video_game","violin","virgo","volcano","vs","walking","waning_crescent_moon","waning_gibbous_moon","warning","watch","water_buffalo","watermelon","wave","wavy_dash","waxing_crescent_moon","waxing_gibbous_moon","wc","weary","wedding","whale","whale2","wheelchair","white_check_mark","white_circle","white_flower","white_large_square","white_square_button","wind_chime","wine_glass","wink","wolf","woman","womans_clothes","womans_hat","womens","worried","wrench","x","yellow_heart","yen","yum","zap","zero","zzz"]},s=function(){var e=function(e,t,s){var l=void 0,u=void 0;return null==s&&(s={}),u=r(),"function"==typeof s?s={parser:s}:(null==s.attributes&&(s.attributes=n),null==s.parser&&(s.parser=i)),l=null!=s.classes?s.classes:a,e.replace(o,function(e,n,a){return-1===u.indexOf(n)?e:s.parser([e,n,a],t,l,s)})};return e};t["default"]=s()},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(11),o=a(i),r=function(e){return o["default"].isMobile()&&o["default"].isSafari()?[[RegExp("^"+e+"$","gm"),'<a target="_parent" href="tel:$1">$1</a>'],[RegExp("^"+e+"(\\D)","gm"),'<a target="_parent" href="tel:$1">$1</a>$2'],[RegExp("(\\D)"+e+"$","gm"),'$1<a target="_parent" href="tel:$2">$2</a>'],[RegExp("(\\D)"+e+"(\\D)","gm"),'$1<a target="_parent" href="tel:$2">$2</a>$3']]:[[RegExp("^"+e+"$","gm"),'<a target="_blank" href="tel:$1">$1</a>'],[RegExp("^"+e+"(\\D)","gm"),'<a target="_blank" href="tel:$1">$1</a>$2'],[RegExp("(\\D)"+e+"$","gm"),'$1<a target="_blank" href="tel:$2">$2</a>'],[RegExp("(\\D)"+e+"(\\D)","gm"),'$1<a target="_blank" href="tel:$2">$2</a>$3']]},s=[[/((http:\/\/|https:\/\/)[\.A-Za-z0-9-]+?\.((com)|(net)|(im)|(cn)|(me)|(org)|(edu)|(cc)|(biz)|(info)|(tv)|(co)|(so)|(tel)|(mobi))[\/?#]([^u4e00-u9fa5]|[A-Za-z0-9])+\/$)/gim,'<a target="_blank" href="$1">$1</a>'],[/([\.A-Za-z0-9-]+?\.((com)|(net)|(im)|(cn)|(me)|(org)|(edu)|(cc)|(biz)|(info)|(tv)|(co)|(so)|(tel)|(mobi))[\/?#]([^u4e00-u9fa5]|[A-Za-z0-9])+\/$)/gim,'<a target="_blank" href="http://$1">$1</a>'],[/((ftp:\/\/)[^\u4E00-\u9FA5 ]+)/gi,'<a target="_blank" href="$1">$1</a>'],[/((http:\/\/|https:\/\/)[^\u4E00-\u9FA5 ]+)/gi,'<a target="_blank" href="$1">$1</a>'],[/((www\.)[^\u4E00-\u9FA5 ]+)/gi,'<a target="_blank" href="http://$1">$1</a>'],[/([\.A-Za-z0-9-]+?\.((com)|(net)|(im)|(cn)|(me)|(org)|(edu)|(cc)|(biz)|(info)|(tv)|(co)|(so)|(tel)|(mobi))[\/?#][^\u4E00-\u9FA5，]+)/gim,'<a target="_blank" href="http://$1">$1</a>'],[/([\.A-Za-z0-9-]+?\.((com)|(net)|(im)|(cn)|(me)|(org)|(edu)|(cc)|(biz)|(info)|(tv)|(co)|(so)|(tel)|(mobi))[\/?#])/gim,'<a target="_blank" href="http://$1">$1</a>'],[/([\.A-Za-z0-9-]+?\.((com)|(net)|(im)|(cn)|(me)|(org)|(edu)|(cc)|(biz)|(info)|(tv)|(co)|(so)|(tel)|(mobi)))([0-9\s\u4E00-\u9FA5，]+)/gim,'<a target="_blank" href="http://$1">$1</a>$18'],[/([\.A-Za-z0-9-]+?\.((com)|(net)|(im)|(cn)|(me)|(org)|(edu)|(cc)|(biz)|(info)|(tv)|(co)|(so)|(tel)|(mobi)))$/gim,'<a target="_blank" href="http://$1">$1</a>']],l=[[/([A-Z0-9\._%+-]+@[A-Z0-9\.-]+\.[A-Z]{2,15})/gim,'<a href="mailto:$1">$1</a>']],u=[];u=u.concat(r("([1]\\d{10})")),u=u.concat(r("([48]00\\d?-?\\d{3,4}-?\\d{3,4})")),u=u.concat(r("(0\\d{2,3}-?\\d{7,8})")),u=u.concat(r("(\\d{8})"));var c=function(e,t){var n=document.createElement("div");n.innerHTML=e;for(var a in n.childNodes){var i=n.childNodes[a];if(3===i.nodeType){var o=document.createElement("em");o.appendChild(i.cloneNode(!0));var r=o.innerHTML;o.innerHTML=o.innerHTML.replace(t[0],t[1]),o.innerHTML!==r&&n.replaceChild(o,i)}}return n.innerHTML.replace(/\<em\>/g,"").replace(/\<\/em\>/g,"").replace(/&nbsp;/," ")},d=function(e){for(var t in u)e=c(e,u[t]);return e},f=function(e){for(var t in s)e=c(e,s[t]);return e},p=function(e){for(var t in l)e=c(e,l[t]);return e},g=function(e){return e.replace(/\n/g,"<br/>")},m=function(e){return e=g(e),e=p(e),e=f(e),e=d(e)};t["default"]={convertTel:d,convertUrl:f,convertEmail:p,convertBr:g,convertAll:m}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e,t){if(!e)return"0 B";var n=1e3;t=t+1||2;var a=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],i=Math.floor(Math.log(e)/Math.log(n));return parseFloat((e/Math.pow(n,i)).toFixed(t))+" "+a[i]}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){var n=u["default"].func(t)?t:c;if(u["default"].array(e))for(var a=0;a<e.length;++a)n(e[a],a)}function o(e,t){var n=[];return i(e,function(e,a){return n.push(t(e,a))}),n}function r(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];return function(e){return i(t,function(t){return e=t(e)}),e}}function s(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];return function(e){return i(t.reverse(),function(t){return e=t(e)}),e}}Object.defineProperty(t,"__esModule",{value:!0}),t.each=i,t.map=o,t.sequence=r,t.compose=s;var l=n(51),u=a(l),c=function(){}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={},a=function(e,t){return Object.prototype.toString.call(t)==="[object "+e+"]"};n.array=function(e){return a("Array",e)},n.string=function(e){return a("String",e)},n.object=function(e){return a("Object",e)},n.regexp=function(e){return a("RegExp",e)},n.number=function(e){return a("Number",e)},n.func=function(e){return a("Function",e)},n.nil=function(e){return a("Null",e)},n.undef=function(e){return a("Undefined",e)},n.emptyObject=function(e){if(!n.object(e))return!1;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},t["default"]=n},function(e,t){"use strict";function n(e){var t=a(e),n=0==t.getHours()?"12":t.getHours()>12?t.getHours()-12:t.getHours();n=10>n?"0"+n:n;var i=(t.getMinutes()<10?"0":"")+t.getMinutes(),o=t.getHours()<12?"AM":"PM",r=n+":"+i+o;return r}function a(e){if(e&&e.indexOf("T")>0){var t=e.split("T")[0].split("-"),n=e.split("T")[1].split(":"),a=new Date(t[0],t[1],t[2],n[0],n[1],n[2]);return a.setMinutes(a.getMinutes()-a.getTimezoneOffset()),a}return new Date}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n,t.toLocalTime=a},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}function i(e){var t=document.getElementById("light-box-mask");t||(t=l(s),g.appendChild(t)),d(e,function(e){e.removeEventListener("click",o),e.addEventListener("click",o)})}function o(e){e.preventDefault();var t=(document.getElementById("light-box-mask"),e.srcElement),n=t.cloneNode();n.setAttribute("id","light-box-content");var a=c(t),i=c(g),o=a.height/a.width*i.width,s=(i.height-o)/2;if(u(n,{position:"relative",zIndex:6,top:s+"px",height:"auto"}),m)u(n,{width:"100%"});else{var l=300;u(n,{width:a.width+"px",transition:"width "+l+"ms",WebkitTransition:"width "+l+"ms",MozTransition:"width "+l+"ms"})}r(n),m||window.setTimeout(function(){return u(n,{width:"100%"})},100),n.addEventListener("touchstart",function(e){e.preventDefault()})}function r(e){var t=document.getElementById("light-box-mask");u(t,{display:""}),t.appendChild(e)}function s(e){e.stopPropagation(),e.preventDefault(),setTimeout(function(){var e=document.getElementById("light-box-mask");e.innerHTML="",u(e,{display:"none"})},350)}function l(e){var t=document.createElement("div");return t.setAttribute("id","light-box-mask"),u(t,{position:"absolute",textAlign:"center",top:0,right:0,left:0,bottom:0,zIndex:5,width:"100%",height:"auto",backgroundColor:"rgba(0, 0, 0, 1)",display:"none"}),t.addEventListener("touchstart",e),t}function u(e,t){if(e)for(var n in t)e.style[n]=t[n]}function c(e){var t=e.currentStyle?e.currentStyle:window.getComputedStyle(e,null);return{width:parseInt(t.width)||0,height:parseInt(t.height)||0}}function d(e,t){for(var n=0;n<e.length;n++)t(e[n],n,e)}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=i;var f=n(54),p=a(f),g=document.body,m=p["default"]()},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(){return/micromessenger/.test(window.navigator.userAgent.toLowerCase())}},function(e,t){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){var e="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return"undefined"==typeof e?"undefined":n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":"undefined"==typeof e?"undefined":n(e)};!function(t){function n(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=Object.create(e.prototype);for(var i in n)a[i]=n[i];return a.constructor=t,t.prototype=a,t}function a(e){e=e||{},this.defaultProtocol=e.defaultProtocol||f.defaultProtocol,this.events=e.events||f.events,this.format=e.format||f.format,this.formatHref=e.formatHref||f.formatHref,this.nl2br=e.nl2br||f.nl2br,this.tagName=e.tagName||f.tagName,this.target=e.target||f.target,this.validate=e.validate||f.validate,this.ignoreTags=[],this.attributes=e.attributes||e.linkAttributes||f.attributes,this.className=e.className||e.linkClass||f.className;for(var t=e.ignoreTags||f.ignoreTags,n=0;n<t.length;n++)this.ignoreTags.push(t[n].toUpperCase())}function i(e,t){for(var n=0;n<e.length;n++)if(e[n]===t)return!0;return!1}function o(e){return e}function r(e,t){return"url"===t?"_blank":null}function s(){return function(e){this.j=[],this.T=e||null}}function l(e,t,n,a){for(var i=0,o=e.length,r=t,s=[],l=void 0;o>i&&(l=r.next(e[i]));)r=l,i++;if(i>=o)return[];for(;o-1>i;)l=new m(a),s.push(l),r.on(e[i],l),r=l,i++;return l=new m(n),s.push(l),r.on(e[o-1],l),s}function u(){return function(e){e&&(this.v=e)}}function c(e){var t=e?{v:e}:{};return n(h,u(),t)}function d(e){return e instanceof b||e instanceof L}var f={defaultProtocol:"http",events:null,format:o,formatHref:o,nl2br:!1,tagName:"a",target:r,validate:!0,ignoreTags:[],attributes:null,className:"linkified"};a.prototype={resolve:function(e){var t=e.toHref(this.defaultProtocol);return{formatted:this.get("format",e.toString(),e),formattedHref:this.get("formatHref",t,e),tagName:this.get("tagName",t,e),className:this.get("className",t,e),target:this.get("target",t,e),events:this.getObject("events",t,e),attributes:this.getObject("attributes",t,e)}},check:function(e){return this.get("validate",e.toString(),e)},get:function(t,n,a){var i=this[t];if(!i)return i;switch("undefined"==typeof i?"undefined":e(i)){case"function":return i(n,a.type);case"object":var o=i[a.type]||f[t];return"function"==typeof o?o(n,a.type):o}return i},getObject:function(e,t,n){var a=this[e];return"function"==typeof a?a(t,n.type):a}};var p=Object.freeze({defaults:f,Options:a,contains:i}),g=s();g.prototype={defaultTransition:!1,on:function(e,t){if(e instanceof Array){for(var n=0;n<e.length;n++)this.j.push([e[n],t]);return this}return this.j.push([e,t]),this},next:function(e){for(var t=0;t<this.j.length;t++){var n=this.j[t],a=n[0],i=n[1];if(this.test(e,a))return i}return this.defaultTransition},accepts:function(){return!!this.T},test:function(e,t){return e===t},emit:function(){return this.T}};var m=n(g,s(),{test:function(e,t){return e===t||t instanceof RegExp&&t.test(e)}}),v=n(g,s(),{jump:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.next(new e(""));return n===this.defaultTransition?(n=new this.constructor(t),this.on(e,n)):t&&(n.T=t),n},test:function(e,t){return e instanceof t}}),h=u();h.prototype={toString:function(){return this.v+""}};var b=c(),y=c("@"),_=c(":"),w=c("."),k=c(),x=c(),T=c("\n"),E=c(),C=c("+"),I=c("#"),S=c(),j=c("mailto:"),M=c("?"),O=c("/"),B=c("_"),A=c(),L=c(),N=c(),P=c("{"),q=c("["),D=c("<"),$=c("("),H=c("}"),R=c("]"),z=c(">"),U=c(")"),F=c("&"),Q=Object.freeze({Base:h,DOMAIN:b,AT:y,COLON:_,DOT:w,PUNCTUATION:k,LOCALHOST:x,NL:T,NUM:E,PLUS:C,POUND:I,QUERY:M,PROTOCOL:S,MAILTO:j,SLASH:O,UNDERSCORE:B,SYM:A,TLD:L,WS:N,OPENBRACE:P,OPENBRACKET:q,OPENANGLEBRACKET:D,OPENPAREN:$,CLOSEBRACE:H,CLOSEBRACKET:R,CLOSEANGLEBRACKET:z,CLOSEPAREN:U,AMPERSAND:F}),W="aaa|aarp|abb|abbott|abogado|ac|academy|accenture|accountant|accountants|aco|active|actor|ad|adac|ads|adult|ae|aeg|aero|af|afl|ag|agency|ai|aig|airforce|airtel|al|alibaba|alipay|allfinanz|alsace|am|amica|amsterdam|an|analytics|android|ao|apartments|app|apple|aq|aquarelle|ar|aramco|archi|army|arpa|arte|as|asia|associates|at|attorney|au|auction|audi|audio|author|auto|autos|avianca|aw|ax|axa|az|azure|ba|baidu|band|bank|bar|barcelona|barclaycard|barclays|bargains|bauhaus|bayern|bb|bbc|bbva|bcg|bcn|bd|be|beats|beer|bentley|berlin|best|bet|bf|bg|bh|bharti|bi|bible|bid|bike|bing|bingo|bio|biz|bj|black|blackfriday|bloomberg|blue|bm|bms|bmw|bn|bnl|bnpparibas|bo|boats|boehringer|bom|bond|boo|book|boots|bosch|bostik|bot|boutique|br|bradesco|bridgestone|broadway|broker|brother|brussels|bs|bt|budapest|bugatti|build|builders|business|buy|buzz|bv|bw|by|bz|bzh|ca|cab|cafe|cal|call|camera|camp|cancerresearch|canon|capetown|capital|car|caravan|cards|care|career|careers|cars|cartier|casa|cash|casino|cat|catering|cba|cbn|cc|cd|ceb|center|ceo|cern|cf|cfa|cfd|cg|ch|chanel|channel|chase|chat|cheap|chloe|christmas|chrome|church|ci|cipriani|circle|cisco|citic|city|cityeats|ck|cl|claims|cleaning|click|clinic|clinique|clothing|cloud|club|clubmed|cm|cn|co|coach|codes|coffee|college|cologne|com|commbank|community|company|compare|computer|comsec|condos|construction|consulting|contact|contractors|cooking|cool|coop|corsica|country|coupon|coupons|courses|cr|credit|creditcard|creditunion|cricket|crown|crs|cruises|csc|cu|cuisinella|cv|cw|cx|cy|cymru|cyou|cz|dabur|dad|dance|date|dating|datsun|day|dclk|de|dealer|deals|degree|delivery|dell|deloitte|delta|democrat|dental|dentist|desi|design|dev|diamonds|diet|digital|direct|directory|discount|dj|dk|dm|dnp|do|docs|dog|doha|domains|download|drive|dubai|durban|dvag|dz|earth|eat|ec|edeka|edu|education|ee|eg|email|emerck|energy|engineer|engineering|enterprises|epson|equipment|er|erni|es|esq|estate|et|eu|eurovision|eus|events|everbank|exchange|expert|exposed|express|fage|fail|fairwinds|faith|family|fan|fans|farm|fashion|fast|feedback|ferrero|fi|film|final|finance|financial|firestone|firmdale|fish|fishing|fit|fitness|fj|fk|flickr|flights|florist|flowers|flsmidth|fly|fm|fo|foo|football|ford|forex|forsale|forum|foundation|fox|fr|fresenius|frl|frogans|frontier|fund|furniture|futbol|fyi|ga|gal|gallery|gallup|game|garden|gb|gbiz|gd|gdn|ge|gea|gent|genting|gf|gg|ggee|gh|gi|gift|gifts|gives|giving|gl|glass|gle|global|globo|gm|gmail|gmbh|gmo|gmx|gn|gold|goldpoint|golf|goo|goog|google|gop|got|gov|gp|gq|gr|grainger|graphics|gratis|green|gripe|group|gs|gt|gu|gucci|guge|guide|guitars|guru|gw|gy|hamburg|hangout|haus|hdfcbank|health|healthcare|help|helsinki|here|hermes|hiphop|hitachi|hiv|hk|hm|hn|hockey|holdings|holiday|homedepot|homes|honda|horse|host|hosting|hoteles|hotmail|house|how|hr|hsbc|ht|hu|hyundai|ibm|icbc|ice|icu|id|ie|ifm|iinet|il|im|immo|immobilien|in|industries|infiniti|info|ing|ink|institute|insurance|insure|int|international|investments|io|ipiranga|iq|ir|irish|is|iselect|ist|istanbul|it|itau|iwc|jaguar|java|jcb|je|jetzt|jewelry|jlc|jll|jm|jmp|jo|jobs|joburg|jot|joy|jp|jpmorgan|jprs|juegos|kaufen|kddi|ke|kerryhotels|kerrylogistics|kerryproperties|kfh|kg|kh|ki|kia|kim|kinder|kitchen|kiwi|km|kn|koeln|komatsu|kp|kpn|kr|krd|kred|kuokgroup|kw|ky|kyoto|kz|la|lacaixa|lamborghini|lamer|lancaster|land|landrover|lanxess|lasalle|lat|latrobe|law|lawyer|lb|lc|lds|lease|leclerc|legal|lexus|lgbt|li|liaison|lidl|life|lifeinsurance|lifestyle|lighting|like|limited|limo|lincoln|linde|link|live|living|lixil|lk|loan|loans|local|locus|lol|london|lotte|lotto|love|lr|ls|lt|ltd|ltda|lu|lupin|luxe|luxury|lv|ly|ma|madrid|maif|maison|makeup|man|management|mango|market|marketing|markets|marriott|mba|mc|md|me|med|media|meet|melbourne|meme|memorial|men|menu|meo|mg|mh|miami|microsoft|mil|mini|mk|ml|mm|mma|mn|mo|mobi|mobily|moda|moe|moi|mom|monash|money|montblanc|mormon|mortgage|moscow|motorcycles|mov|movie|movistar|mp|mq|mr|ms|mt|mtn|mtpc|mtr|mu|museum|mutuelle|mv|mw|mx|my|mz|na|nadex|nagoya|name|natura|navy|nc|ne|nec|net|netbank|network|neustar|new|news|nexus|nf|ng|ngo|nhk|ni|nico|nikon|ninja|nissan|nl|no|nokia|norton|nowruz|np|nr|nra|nrw|ntt|nu|nyc|nz|obi|office|okinawa|om|omega|one|ong|onl|online|ooo|oracle|orange|org|organic|origins|osaka|otsuka|ovh|pa|page|pamperedchef|panerai|paris|pars|partners|parts|party|passagens|pe|pet|pf|pg|ph|pharmacy|philips|photo|photography|photos|physio|piaget|pics|pictet|pictures|pid|pin|ping|pink|pizza|pk|pl|place|play|playstation|plumbing|plus|pm|pn|pohl|poker|porn|post|pr|praxi|press|pro|prod|productions|prof|promo|properties|property|protection|ps|pt|pub|pw|pwc|py|qa|qpon|quebec|quest|racing|re|read|realtor|realty|recipes|red|redstone|redumbrella|rehab|reise|reisen|reit|ren|rent|rentals|repair|report|republican|rest|restaurant|review|reviews|rexroth|rich|ricoh|rio|rip|ro|rocher|rocks|rodeo|room|rs|rsvp|ru|ruhr|run|rw|rwe|ryukyu|sa|saarland|safe|safety|sakura|sale|salon|samsung|sandvik|sandvikcoromant|sanofi|sap|sapo|sarl|sas|saxo|sb|sbs|sc|sca|scb|schaeffler|schmidt|scholarships|school|schule|schwarz|science|scor|scot|sd|se|seat|security|seek|select|sener|services|seven|sew|sex|sexy|sfr|sg|sh|sharp|shell|shia|shiksha|shoes|show|shriram|si|singles|site|sj|sk|ski|skin|sky|skype|sl|sm|smile|sn|sncf|so|soccer|social|softbank|software|sohu|solar|solutions|song|sony|soy|space|spiegel|spot|spreadbetting|sr|srl|st|stada|star|starhub|statefarm|statoil|stc|stcgroup|stockholm|storage|store|studio|study|style|su|sucks|supplies|supply|support|surf|surgery|suzuki|sv|swatch|swiss|sx|sy|sydney|symantec|systems|sz|tab|taipei|taobao|tatamotors|tatar|tattoo|tax|taxi|tc|tci|td|team|tech|technology|tel|telecity|telefonica|temasek|tennis|tf|tg|th|thd|theater|theatre|tickets|tienda|tiffany|tips|tires|tirol|tj|tk|tl|tm|tmall|tn|to|today|tokyo|tools|top|toray|toshiba|total|tours|town|toyota|toys|tp|tr|trade|trading|training|travel|travelers|travelersinsurance|trust|trv|tt|tube|tui|tunes|tushu|tv|tvs|tw|tz|ua|ubs|ug|uk|unicom|university|uno|uol|us|uy|uz|va|vacations|vana|vc|ve|vegas|ventures|verisign|versicherung|vet|vg|vi|viajes|video|viking|villas|vin|vip|virgin|vision|vista|vistaprint|viva|vlaanderen|vn|vodka|volkswagen|vote|voting|voto|voyage|vu|vuelos|wales|walter|wang|wanggou|watch|watches|weather|weatherchannel|webcam|weber|website|wed|wedding|weir|wf|whoswho|wien|wiki|williamhill|win|windows|wine|wme|wolterskluwer|work|works|world|ws|wtc|wtf|xbox|xerox|xin|xperia|xxx|xyz|yachts|yahoo|yamaxun|yandex|ye|yodobashi|yoga|yokohama|youtube|yt|za|zara|zero|zip|zm|zone|zuerich|zw".split("|"),J="0123456789".split(""),V="0123456789abcdefghijklmnopqrstuvwxyz".split(""),G=[" ","\f","\r","	",""," "," ","᠎"],X=[],Z=function(e){return new m(e)},K=Z(),Y=Z(E),ee=Z(b),te=Z(),ne=Z(N);K.on("@",Z(y)).on(".",Z(w)).on("+",Z(C)).on("#",Z(I)).on("?",Z(M)).on("/",Z(O)).on("_",Z(B)).on(":",Z(_)).on("{",Z(P)).on("[",Z(q)).on("<",Z(D)).on("(",Z($)).on("}",Z(H)).on("]",Z(R)).on(">",Z(z)).on(")",Z(U)).on("&",Z(F)).on([",",";","!",'"',"'"],Z(k)),K.on("\n",Z(T)).on(G,ne),ne.on(G,ne);for(var ae=0;ae<W.length;ae++){var ie=l(W[ae],K,L,b);X.push.apply(X,ie)}var oe=l("file",K,b,b),re=l("ftp",K,b,b),se=l("http",K,b,b),le=l("mailto",K,b,b);X.push.apply(X,oe),X.push.apply(X,re),X.push.apply(X,se);var ue=oe.pop(),ce=re.pop(),de=se.pop(),fe=le.pop(),pe=Z(b),ge=Z(S),me=Z(j);ce.on("s",pe).on(":",ge),de.on("s",pe).on(":",ge),X.push(pe),ue.on(":",ge),pe.on(":",ge),fe.on(":",me);var ve=l("localhost",K,x,b);X.push.apply(X,ve),K.on(J,Y),Y.on("-",te).on(J,Y).on(V,ee),ee.on("-",te).on(V,ee);for(var he=0;he<X.length;he++)X[he].on("-",te).on(V,ee);te.on("-",te).on(J,ee).on(V,ee),K.defaultTransition=Z(A);var be=function(e){for(var t=e.replace(/[A-Z]/g,function(e){return e.toLowerCase()}),n=e.length,a=[],i=0;n>i;){for(var o=K,r=null,s=null,l=0,u=null,c=-1;n>i&&(s=o.next(t[i]));)r=null,o=s,o.accepts()?(c=0,u=o):c>=0&&c++,l++,i++;if(!(0>c)){i-=c,l-=c;var d=u.emit();a.push(new d(e.substr(i-l,l)))}}return a},ye=K,_e=Object.freeze({State:m,TOKENS:Q,run:be,start:ye}),we=u();we.prototype={type:"token",isLink:!1,toString:function(){for(var e=[],t=0;t<this.v.length;t++)e.push(this.v[t].toString());return e.join("")},toHref:function(){return this.toString()},toObject:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"http";return{type:this.type,value:this.toString(),href:this.toHref(e)}}};var ke=n(we,u(),{type:"email",isLink:!0}),xe=n(we,u(),{type:"email",isLink:!0,toHref:function(){this.v;return"mailto:"+this.toString()}}),Te=n(we,u(),{type:"text"}),Ee=n(we,u(),{type:"nl"}),Ce=n(we,u(),{type:"url",isLink:!0,toHref:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"http",t=!1,n=!1,a=this.v,i=[],o=0;a[o]instanceof S;)t=!0,i.push(a[o].toString().toLowerCase()),o++;for(;a[o]instanceof O;)n=!0,i.push(a[o].toString()),o++;for(;d(a[o]);)i.push(a[o].toString().toLowerCase()),o++;for(;o<a.length;o++)i.push(a[o].toString());return i=i.join(""),t||n||(i=e+"://"+i),i},hasProtocol:function(){return this.v[0]instanceof S}}),Ie=Object.freeze({Base:we,MAILTOEMAIL:ke,EMAIL:xe,
NL:Ee,TEXT:Te,URL:Ce}),Se=function(e){return new v(e)},je=Se(),Me=Se(),Oe=Se(),Be=Se(),Ae=Se(),Le=Se(),Ne=Se(),Pe=Se(Ce),qe=Se(),De=Se(Ce),$e=Se(Ce),He=Se(),Re=Se(),ze=Se(),Ue=Se(),Fe=Se(),Qe=Se(Ce),We=Se(Ce),Je=Se(Ce),Ve=Se(Ce),Ge=Se(),Xe=Se(),Ze=Se(),Ke=Se(),Ye=Se(),et=Se(),tt=Se(xe),nt=Se(),at=Se(xe),it=Se(ke),ot=Se(),rt=Se(),st=Se(),lt=Se(),ut=Se(Ee);je.on(T,ut).on(S,Me).on(j,Oe).on(O,Be),Me.on(O,Be),Be.on(O,Ae),je.on(L,Le).on(b,Le).on(x,Pe).on(E,Le),Ae.on(L,$e).on(b,$e).on(E,$e).on(x,$e),Le.on(w,Ne),Ye.on(w,et),Ne.on(L,Pe).on(b,Le).on(E,Le).on(x,Le),et.on(L,tt).on(b,Ye).on(E,Ye).on(x,Ye),Pe.on(w,Ne),tt.on(w,et),Pe.on(_,qe).on(O,$e),qe.on(E,De),De.on(O,$e),tt.on(_,nt),nt.on(E,at);var ct=[b,y,x,E,C,I,S,O,L,B,A,F],dt=[_,w,M,k,H,R,z,U,P,q,D,$];$e.on(P,Re).on(q,ze).on(D,Ue).on($,Fe),He.on(P,Re).on(q,ze).on(D,Ue).on($,Fe),Re.on(H,$e),ze.on(R,$e),Ue.on(z,$e),Fe.on(U,$e),Qe.on(H,$e),We.on(R,$e),Je.on(z,$e),Ve.on(U,$e),Ge.on(H,$e),Xe.on(R,$e),Ze.on(z,$e),Ke.on(U,$e),Re.on(ct,Qe),ze.on(ct,We),Ue.on(ct,Je),Fe.on(ct,Ve),Re.on(dt,Ge),ze.on(dt,Xe),Ue.on(dt,Ze),Fe.on(dt,Ke),Qe.on(ct,Qe),We.on(ct,We),Je.on(ct,Je),Ve.on(ct,Ve),Qe.on(dt,Qe),We.on(dt,We),Je.on(dt,Je),Ve.on(dt,Ve),Ge.on(ct,Qe),Xe.on(ct,We),Ze.on(ct,Je),Ke.on(ct,Ve),Ge.on(dt,Ge),Xe.on(dt,Xe),Ze.on(dt,Ze),Ke.on(dt,Ke),$e.on(ct,$e),He.on(ct,$e),$e.on(dt,He),He.on(dt,He),Oe.on(L,it).on(b,it).on(E,it).on(x,it),it.on(ct,it).on(dt,ot),ot.on(ct,it).on(dt,ot);var ft=[b,E,C,I,M,B,A,F,L];Le.on(ft,rt).on(y,st),Pe.on(ft,rt).on(y,st),Ne.on(ft,rt),rt.on(ft,rt).on(y,st).on(w,lt),lt.on(ft,rt),st.on(L,Ye).on(b,Ye).on(x,tt);var pt=function(e){for(var t=e.length,n=0,a=[],i=[];t>n;){for(var o=je,r=null,s=null,l=0,u=null,c=-1;t>n&&!(r=o.next(e[n]));)i.push(e[n++]);for(;t>n&&(s=r||o.next(e[n]));)r=null,o=s,o.accepts()?(c=0,u=o):c>=0&&c++,n++,l++;if(0>c)for(var d=n-l;n>d;d++)i.push(e[d]);else{i.length>0&&(a.push(new Te(i)),i=[]),n-=c,l-=c;var f=u.emit();a.push(new f(e.slice(n-l,n)))}}return i.length>0&&a.push(new Te(i)),a},gt=Object.freeze({State:v,TOKENS:Ie,run:pt,start:je});Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)});var mt=function(e){return pt(be(e))},vt=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=mt(e),a=[],i=0;i<n.length;i++){var o=n[i];!o.isLink||t&&o.type!==t||a.push(o.toObject())}return a},ht=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=mt(e);return 1===n.length&&n[0].isLink&&(!t||n[0].type===t)};t.find=vt,t.inherits=n,t.options=p,t.parser=gt,t.scanner=_e,t.test=ht,t.tokenize=mt}(self.linkify=self.linkify||{})}()},function(e,t){"use strict";!function(e,t){var n=function(e){function t(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function n(e){return e.replace(/"/g,"&quot;")}function a(e){if(!e)return"";var t=[];for(var a in e){var i=e[a]+"";t.push(a+'="'+n(i)+'"')}return t.join(" ")}function i(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};i=new s(i);for(var r=o(e),l=[],u=0;u<r.length;u++){var c=r[u];if("nl"===c.type&&i.nl2br)l.push("<br>\n");else if(c.isLink&&i.check(c)){var d=i.resolve(c),f=d.formatted,p=d.formattedHref,g=d.tagName,m=d.className,v=d.target,h=d.attributes,b="<"+g+' href="'+n(p)+'"';m&&(b+=' class="'+n(m)+'"'),v&&(b+=' target="'+n(v)+'"'),h&&(b+=" "+a(h)),b+=">"+t(f)+"</"+g+">",l.push(b)}else l.push(t(c.toString()))}return l.join("")}var o=e.tokenize,r=e.options,s=r.Options;return String.prototype.linkify||(String.prototype.linkify=function(e){return i(this,e)}),i}(t);e.linkifyStr=n}(window,linkify)},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),o=a(i),r=n(21),s=a(r),l=n(16),u=a(l),c=n(13),d=a(c),f=n(11),p=a(f),g=n(4),m=a(g),v=n(35),h=a(v),b=function(){document.getElementById("moreHistoryBtn")&&document.getElementById("moreHistoryBtn").parentNode.removeChild(document.getElementById("moreHistoryBtn"));var e=document.getElementById("msgHolder"),t=document.createElement("a");t.id="moreHistoryBtn",t.innerHTML=m["default"].language?s["default"][m["default"].language].LoadHistory:s["default"].zh.LoadHistory,e.insertBefore(t,e.firstChild);var n=p["default"].isMobile()?"touchstart":"click";t.addEventListener(n,function(e){return d["default"].hasClass(e.target,"disabled")||y(),e.preventDefault()})},y=function(e,t){function n(t){if(m["default"].historyArray.length)if(e)b();else{var n=m["default"].historyArray.splice(0,m["default"].msgLimit);h["default"](n,"history")}e||!function(){var e=document.getElementById("moreHistoryBtn");if(m["default"].historyArray.length||!t){var n=document.getElementById("moreHistoryBtn");n.innerHTML=s["default"][m["default"].language].historyMore,d["default"].removeClass(n,"disabled")}else e.innerHTML=s["default"][m["default"].language].NoMore,d["default"].addClass(e,"disabled"),setTimeout(function(){e.style.display="none"},1500)}()}function a(){m["default"].page+=1,u["default"].ajax({url:o["default"].chat+"/client/history_conversation",type:"get",data:{ent_id:m["default"].entId,track_id:m["default"].trackId,page:m["default"].page,limit:m["default"].limit},beforeSend:function(){if(m["default"].page>0&&!e){var t=document.getElementById("moreHistoryBtn");t.innerHTML=s["default"][m["default"].language].Loading,d["default"].addClass(t,"disabled")}},success:function(e){var a=e.conversations;if(a.length){for(var i=a.length-1;i>=0;i--)for(var o=a[i].messages.length-1;o>=0;o--)m["default"].historyArray.push(a[i].messages[o]);a.length<1?n(!0):n()}else n(!0);t&&t()},error:function(){n(!0)}})}m["default"].historyTimes+=1,m["default"].historyArray.length<m["default"].msgLimit?a():n()};t["default"]=y},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),o=a(i),r=n(13),s=a(r),l=n(24),u=a(l),c=n(34),d=a(c),f=n(4),p=a(f);t["default"]=function(e){if("hide"===e)s["default"].addClass(document.getElementById("unableService"),"hide");else{var t=p["default"].tpl("unable-service",{src:o["default"].cdn+"/images/icon-unable-service.png"});document.getElementById("unableService").innerHTML=t,s["default"].removeClass(document.getElementById("unableService"),"hide"),"mobile"===p["default"].device&&u["default"](document.getElementById("btnTel"),"hide"),u["default"](document.getElementById("btnCallAgent"),"hide"),document.getElementById("loading")&&(document.getElementById("loading").innerHTML="",d["default"]())}}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(4),o=a(i);t["default"]=function(e){"open"!==o["default"].ring||o["default"].ringing||(o["default"].ringing=!0,document.getElementById(e).play(),setTimeout(function(){o["default"].ringing=!1},1e3))}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}function i(){if(r["default"].fakeSentMsg.length){for(var e=0;e<r["default"].fakeSentMsg.length;e++)"photo"!==r["default"].fakeSentMsg[e].content_type&&"file"!==r["default"].fakeSentMsg[e].content_type?c["default"]([{id:r["default"].fakeSentMsg[e].id,from_type:"client",content_type:"text",status:"sending",content:r["default"].fakeSentMsg[e].content,type:"text"}]):"photo"===r["default"].fakeSentMsg[e].content_type&&c["default"]([{id:r["default"].fakeSentMsg[e].id,from_type:"client",content_type:"photo",status:"sending",media_url:r["default"].fakeSentMsg[e].content,type:"photo"}]),l["default"](r["default"].fakeSentMsg[e]);r["default"].fakeSentMsg=[]}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=i;var o=n(4),r=a(o),s=n(61),l=a(s),u=n(35),c=a(u)},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),o=a(i),r=n(21),s=a(r),l=n(16),u=a(l),c=n(13),d=a(c),f=n(4),p=a(f),g=n(59),m=a(g),v=n(62),h=a(v),b=n(52),y=a(b);t["default"]=function(e){var t=e.content,n={ent_id:p["default"].entId,track_id:p["default"].trackId,type:e.content_type,content:t,browser_id:p["default"].browserId};p["default"].baidu_bid&&(n.baidu_bid=p["default"].baidu_bid),"file"===e.content_type&&(n.extra=e.extra);var a=function(t,n){var a=e.content_type;if("text"===a){var i=document.getElementById("status"+e.id);"beforeSend"===t?d["default"].removeClass(i,"status-fail"):"error"===t&&(d["default"].addClass(i,"status-fail"),p["default"].loserClub[i.id]=e)}if("photo"===a){var r=document.getElementById("photo"+e.id);if("beforeSend"===t)d["default"].removeClass(r,"photo-send-fail"),r.src=o["default"].cdn+"/images/photo-sending.png",r.parentElement.removeAttribute("href");else if("success"===t){var l=e.media_url;r.src=l,r.parentElement.href=l}else d["default"].addClass(r,"photo-send-fail"),r.src=o["default"].cdn+"/images/photo-fail.png",p["default"].loserClub[r.id]=e}else if("file"===a){var u=document.getElementById("fileState"+e.id),c=document.getElementById("cancelUpload"+e.id),f=document.getElementById("progress"+e.id);"success"===t?u.innerHTML=s["default"][p["default"].language].UploadedSuccessfully:"error"===t&&(u.innerHTML=s["default"][p["default"].language].UploadFailed),c.style.display="none",f.style.display="none"}"success"===t&&n&&document.getElementById("date"+e.id)&&(document.getElementById("date"+e.id).innerHTML=n)};u["default"].ajax({url:o["default"].chat+"/client/send_msg",type:"post",dataType:"json",contentType:"application/json",data:n,beforeSend:function(){a("beforeSend")},success:function(e){e.success?(p["default"].isBasic||"desktop"!==p["default"].device||m["default"]("sentMessage"),p["default"].msgId.push("message"+e.msg.id),a("success",y["default"](e.msg.created_on))):("conversation not found"===e.msg&&h["default"](),a("error"))},error:function(){a("error")}})}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(13),o=a(i),r=n(4),s=a(r);t["default"]=function(){if("open"===s["default"].initData.enterprise_info.prompt_status){var e=s["default"].tpl("chat-has-end",{});document.getElementById("chatHasEnd").innerHTML=e,o["default"].removeClass(document.getElementById("chatHasEnd"),"hide")}else s["default"].chatHasEnd=!0}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(13),o=a(i),r=n(24),s=a(r),l=n(34),u=a(l),c=n(21),d=a(c),f=n(4),p=a(f);t["default"]=function(e,t){if("hide"===e)o["default"].addClass(document.getElementById("queueingTips"),"hide");else{var n=p["default"].tpl("queueing",{intro:t.intro,position:t.position});document.getElementById("queueingTips").innerHTML=n,o["default"].removeClass(document.getElementById("queueingTips"),"hide"),"mobile"===p["default"].device&&s["default"](document.getElementById("btnTel"),"hide"),document.getElementById("loading").innerHTML=d["default"][p["default"].language].WaitingQueue,u["default"]({ignoreLoading:!0})}}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),o=a(i),r=n(21),s=a(r),l=n(16),u=a(l),c=n(4),d=a(c),f=function p(){clearTimeout(window._QUEUE_POSITION_TIMEOUT),u["default"].ajax({url:o["default"].chat+"/client/queue/position",type:"get",data:{ent_id:d["default"].entId,track_id:d["default"].trackId},success:function(e){d["default"].convId?clearTimeout(window._QUEUE_POSITION_TIMEOUT):e.in_queue===!1?document.getElementById("queueingTips").innerHTML=s["default"][d["default"].language].QueuingFailed:(e.position&&document.getElementById("queueingPosition")&&(document.getElementById("queueingPosition").innerHTML=e.position),window._QUEUE_POSITION_TIMEOUT=setTimeout(function(){p()},15e3))}})};t["default"]=f},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}function i(e){var t="show",n="hide";e&&(t="hide",r["default"].robot.show_switch&&(n="show")),l["default"](document.getElementById("evaluationBtn"),t),l["default"](document.getElementById("btnCallAgent"),n)}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=i;var o=n(4),r=a(o),s=n(24),l=a(s)},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}function i(e){if(!v||!e)return e;var t=v.documentElement;t.innerHTML=(e||"").trim();var n=t.innerText||t.textContent||"";return n}function o(e){return"string"!=typeof e?"":i(e.replace(/<img\sclass="emoji".+?alt="\:(\w+)\:">/g,function(e,t){return":"+t+":"}).replace(/<br\/?>/g," ")).replace(/^\s+|\s+$/g,"")}function r(){var e=document.getElementById("textarea");e&&e.focus&&setTimeout(function(){e.focus(),e.blur(),e.focus()},400)}function s(e){return g&&m&&document.hidden?void("granted"===Notification.permission?h.show(e):"denied"!==Notification.permission&&Notification.requestPermission(function(t){"granted"===t&&h.show(e)})):!1}function l(){m&&Notification.requestPermission()}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e){if(e[0]&&"agent"===e[0].from_type){var t=e[0].agent.nickname||e[0].agent.realname||f["default"][c["default"].language].admin;if(e[0].content===f["default"][c["default"].language].PromotionMessage)return!1;"file"===e[0].content_type&&(e[0].content=f["default"][c["default"].language].SentAFile),"photo"===e[0].content_type&&(e[0].content=f["default"][c["default"].language].SentAPicture);var n=o(e[0].content);if(!n.length)return!1;s({title:f["default"][c["default"].language].NewMessage,icon:e[0].agent.avatar,body:t+": "+n,tag:t})}},t.requestNotifyPermission=l;var u=n(4),c=a(u),d=n(21),f=a(d),p=8e3,g="hidden"in document,m="Notification"in window,v=null;document.implementation&&document.implementation.createHTMLDocument&&(v=document.implementation.createHTMLDocument("sinker"));var h={__instance:null,__timer:null,close:function(e){var t=this;this.__timer&&clearTimeout(this.__timer),this.__timer=setTimeout(function(){t.__instance&&t.__instance.close&&t.__instance.close(),t.__instance=null},e||0)},show:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.__instance=new Notification(t.title||f["default"][c["default"].language].CustomerNews,{body:t.body||"",icon:t.icon||"",tag:t.tag||""}),this.__instance.onclick=function(){window.parent.focus(),e.close(),r()},this.close(p)}}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),o=a(i),r=n(21),s=a(r),l=n(68),u=a(l),c=n(16),d=a(c),f=n(4),p=a(f),g=n(22),m=a(g),v=n(69),h=a(v),b=n(11),y=a(b),_=["xhr-streaming","xdr-streaming","xhr-polling","xdr-polling","jsonp-polling"];void 0===window.WebSocket||y["default"].isThisDevice("baidu")||(_=["websocket"]);var w=function(e){return new Date(e).getTime()},k=function(){d["default"].ajax({url:o["default"].chat+"/client/timeline",type:"get",data:{ent_id:p["default"].entId,track_id:p["default"].trackId,filter_type:"after",dt:p["default"].lastMsgDate},success:function(e){var t=e.events,n=e.messages,a=t.concat(n);if(a.length){a.sort(function(e,t){return w(e.created_on)>w(t.created_on)?1:w(e.created_on)<w(t.created_on)?-1:0});for(var i=0;i<a.length;i++)h["default"](a[i].action+a[i].id)||(p["default"].lastMsgDate=a[i].created_on,p["default"].handleSocketMsg(a[i]))}}})};u["default"].prototype._setHeartbeatTimeout=function(){var e=this;clearTimeout(e.heartbeatTimeoutTimer),e.heartbeatTimeoutTimer=setTimeout(function(){e._close(1007,"Heartbeat timed out.")},6e4)};var x=function T(){var e=o["default"].socket+"?browser_id="+p["default"].browserId+"&ent_id="+p["default"].entId+"&track_id="+p["default"].trackId+"&visit_id="+p["default"].visitId,t=null,n=new u["default"](e,t,{transports:_});n.onheartbeat=function(){n.send("h"),n._setHeartbeatTimeout()},n.onopen=function(){if(p["default"].isReconnect&&p["default"].scheduler&&!p["default"].isEnd){clearTimeout(window._TIMELINE_TIMEOUT);var e=1e3*Math.floor(4*Math.random()+2);window._TIMELINE_TIMEOUT=setTimeout(function(){k()},e)}p["default"].socket=!0,m["default"]("hide"),n._setHeartbeatTimeout()},n.onmessage=function(e){try{var t=JSON.parse(e.data);h["default"](t.action+t.id)||p["default"].handleSocketMsg(t)}catch(n){}},n.onclose=function(e){var t=s["default"][p["default"].language].getMsg;1006===e.code&&(t=s["default"][p["default"].language].connection),p["default"].socket=!1,p["default"].isReconnect=!0,setTimeout(function(){p["default"].isAlert||T()},parseInt(4e3+4e3*Math.random())),setTimeout(function(){p["default"].socket||(p["default"].isAlert=!0,m["default"](t))},2e4)}};t["default"]={init:x}},function(e,t,n){var a,i,o,r,r;(function(n){"use strict";var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(n){if("object"==s(t)&&"undefined"!=typeof e)e.exports=n();else{i=[],a=n,o="function"==typeof a?a.apply(t,i):a,!(void 0!==o&&(e.exports=o))}}(function(){var e;return function t(e,n,a){function i(s,l){if(!n[s]){if(!e[s]){var u="function"==typeof r&&r;if(!l&&u)return r(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var d=n[s]={exports:{}};e[s][0].call(d.exports,function(t){var n=e[s][1][t];return i(n?n:t)},d,d.exports,t,e,n,a)}return n[s].exports}for(var o="function"==typeof r&&r,s=0;s<a.length;s++)i(a[s]);return i}({1:[function(e,t,a){(function(n){var a=e("./transport-list");t.exports=e("./main")(a),"_sockjs_onload"in n&&setTimeout(n._sockjs_onload,1)}).call(this,"undefined"!=typeof n?n:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./main":14,"./transport-list":16}],2:[function(e,t,n){function a(){o.call(this),this.initEvent("close",!1,!1),this.wasClean=!1,this.code=0,this.reason=""}var i=e("inherits"),o=e("./event");i(a,o),t.exports=a},{"./event":4,inherits:57}],3:[function(e,t,n){function a(){o.call(this)}var i=e("inherits"),o=e("./eventtarget");i(a,o),a.prototype.removeAllListeners=function(e){e?delete this._listeners[e]:this._listeners={}},a.prototype.once=function(e,t){function n(){a.removeListener(e,n),i||(i=!0,t.apply(this,arguments))}var a=this,i=!1;this.on(e,n)},a.prototype.emit=function(e){var t=this._listeners[e];if(t)for(var n=Array.prototype.slice.call(arguments,1),a=0;a<t.length;a++)t[a].apply(this,n)},a.prototype.on=a.prototype.addListener=o.prototype.addEventListener,a.prototype.removeListener=o.prototype.removeEventListener,t.exports.EventEmitter=a},{"./eventtarget":5,inherits:57}],4:[function(e,t,n){function a(e){this.type=e}a.prototype.initEvent=function(e,t,n){return this.type=e,this.bubbles=t,this.cancelable=n,this.timeStamp=+new Date,this},a.prototype.stopPropagation=function(){},a.prototype.preventDefault=function(){},a.CAPTURING_PHASE=1,a.AT_TARGET=2,a.BUBBLING_PHASE=3,t.exports=a},{}],5:[function(e,t,n){function a(){this._listeners={}}a.prototype.addEventListener=function(e,t){e in this._listeners||(this._listeners[e]=[]);var n=this._listeners[e];-1===n.indexOf(t)&&(n=n.concat([t])),this._listeners[e]=n},a.prototype.removeEventListener=function(e,t){var n=this._listeners[e];if(n){var a=n.indexOf(t);return-1!==a?void(n.length>1?this._listeners[e]=n.slice(0,a).concat(n.slice(a+1)):delete this._listeners[e]):void 0}},a.prototype.dispatchEvent=function(e){var t=e.type,n=Array.prototype.slice.call(arguments,0);if(this["on"+t]&&this["on"+t].apply(this,n),t in this._listeners)for(var a=this._listeners[t],i=0;i<a.length;i++)a[i].apply(this,n)},t.exports=a},{}],6:[function(e,t,n){function a(e){o.call(this),this.initEvent("message",!1,!1),this.data=e}var i=e("inherits"),o=e("./event");i(a,o),t.exports=a},{"./event":4,inherits:57}],7:[function(e,t,n){function a(e){this._transport=e,e.on("message",this._transportMessage.bind(this)),e.on("close",this._transportClose.bind(this))}var i=e("json3"),o=e("./utils/iframe");a.prototype._transportClose=function(e,t){o.postMessage("c",i.stringify([e,t]))},a.prototype._transportMessage=function(e){o.postMessage("t",e)},a.prototype._send=function(e){this._transport.send(e)},a.prototype._close=function(){this._transport.close(),this._transport.removeAllListeners()},t.exports=a},{"./utils/iframe":47,json3:58}],8:[function(e,t,n){(function(n){var a=e("./utils/url"),i=e("./utils/event"),o=e("json3"),r=e("./facade"),s=e("./info-iframe-receiver"),l=e("./utils/iframe"),u=e("./location"),c=function(){};c=e("debug")("sockjs-client:iframe-bootstrap"),t.exports=function(e,t){var n={};t.forEach(function(e){e.facadeTransport&&(n[e.facadeTransport.transportName]=e.facadeTransport)}),n[s.transportName]=s;var d;e.bootstrap_iframe=function(){var t;l.currentWindowId=u.hash.slice(1);var s=function(i){if(i.source===parent&&("undefined"==typeof d&&(d=i.origin),i.origin===d)){var s;try{s=o.parse(i.data)}catch(f){return void c("bad json",i.data)}if(s.windowId===l.currentWindowId)switch(s.type){case"s":var p;try{p=o.parse(s.data)}catch(f){c("bad json",s.data);break}var g=p[0],m=p[1],v=p[2],h=p[3];if(c(g,m,v,h),g!==e.version)throw new Error('Incompatibile SockJS! Main site uses: "'+g+'", the iframe: "'+e.version+'".');if(!a.isOriginEqual(v,u.href)||!a.isOriginEqual(h,u.href))throw new Error("Can't connect to different domain from within an iframe. ("+u.href+", "+v+", "+h+")");t=new r(new n[m](v,h));break;case"m":t._send(s.data);break;case"c":t&&t._close(),t=null}}};i.attachEvent("message",s),l.postMessage("s")}}}).call(this,{env:{}})},{"./facade":7,"./info-iframe-receiver":10,"./location":13,"./utils/event":46,"./utils/iframe":47,"./utils/url":52,debug:54,json3:58}],9:[function(e,t,n){(function(n){function a(e,t){i.call(this);var n=this,a=+new Date;this.xo=new t("GET",e),this.xo.once("finish",function(e,t){var i,o;if(200===e){if(o=+new Date-a,t)try{i=r.parse(t)}catch(u){l("bad json",t)}s.isObject(i)||(i={})}n.emit("finish",i,o),n.removeAllListeners()})}var i=e("events").EventEmitter,o=e("inherits"),r=e("json3"),s=e("./utils/object"),l=function(){};l=e("debug")("sockjs-client:info-ajax"),o(a,i),a.prototype.close=function(){this.removeAllListeners(),this.xo.close()},t.exports=a}).call(this,{env:{}})},{"./utils/object":49,debug:54,events:3,inherits:57,json3:58}],10:[function(e,t,n){function a(e){var t=this;o.call(this),this.ir=new l(e,s),this.ir.once("finish",function(e,n){t.ir=null,t.emit("message",r.stringify([e,n]))})}var i=e("inherits"),o=e("events").EventEmitter,r=e("json3"),s=e("./transport/sender/xhr-local"),l=e("./info-ajax");i(a,o),a.transportName="iframe-info-receiver",a.prototype.close=function(){this.ir&&(this.ir.close(),this.ir=null),this.removeAllListeners()},t.exports=a},{"./info-ajax":9,"./transport/sender/xhr-local":37,events:3,inherits:57,json3:58}],11:[function(e,t,a){(function(n,a){function i(e,t){var n=this;o.call(this);var i=function(){var a=n.ifr=new u(c.transportName,t,e);a.once("message",function(e){if(e){var t;try{t=s.parse(e)}catch(a){return d("bad json",e),n.emit("finish"),void n.close()}var i=t[0],o=t[1];n.emit("finish",i,o)}n.close()}),a.once("close",function(){n.emit("finish"),n.close()})};a.document.body?i():l.attachEvent("load",i)}var o=e("events").EventEmitter,r=e("inherits"),s=e("json3"),l=e("./utils/event"),u=e("./transport/iframe"),c=e("./info-iframe-receiver"),d=function(){};d=e("debug")("sockjs-client:info-iframe"),r(i,o),i.enabled=function(){return u.enabled()},i.prototype.close=function(){this.ifr&&this.ifr.close(),this.removeAllListeners(),this.ifr=null},t.exports=i}).call(this,{env:{}},"undefined"!=typeof n?n:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./info-iframe-receiver":10,"./transport/iframe":22,"./utils/event":46,debug:54,events:3,inherits:57,json3:58}],12:[function(e,t,n){(function(n){function a(e,t){p(e);var n=this;i.call(this),setTimeout(function(){n.doXhr(e,t)},0)}var i=e("events").EventEmitter,o=e("inherits"),r=e("./utils/url"),s=e("./transport/sender/xdr"),l=e("./transport/sender/xhr-cors"),u=e("./transport/sender/xhr-local"),c=e("./transport/sender/xhr-fake"),d=e("./info-iframe"),f=e("./info-ajax"),p=function(){};p=e("debug")("sockjs-client:info-receiver"),o(a,i),a._getReceiver=function(e,t,n){return n.sameOrigin?new f(t,u):l.enabled?new f(t,l):s.enabled&&n.sameScheme?new f(t,s):d.enabled()?new d(e,t):new f(t,c)},a.prototype.doXhr=function(e,t){var n=this,i=r.addPath(e,"/info");p("doXhr",i),this.xo=a._getReceiver(e,i,t),this.timeoutRef=setTimeout(function(){p("timeout"),n._cleanup(!1),n.emit("finish")},a.timeout),this.xo.once("finish",function(e,t){p("finish",e,t),n._cleanup(!0),n.emit("finish",e,t)})},a.prototype._cleanup=function(e){p("_cleanup"),clearTimeout(this.timeoutRef),this.timeoutRef=null,!e&&this.xo&&this.xo.close(),this.xo=null},a.prototype.close=function(){p("close"),this.removeAllListeners(),this._cleanup(!1)},a.timeout=8e3,t.exports=a}).call(this,{env:{}})},{"./info-ajax":9,"./info-iframe":11,"./transport/sender/xdr":34,"./transport/sender/xhr-cors":35,"./transport/sender/xhr-fake":36,"./transport/sender/xhr-local":37,"./utils/url":52,debug:54,events:3,inherits:57}],13:[function(e,t,a){(function(e){t.exports=e.location||{origin:"http://localhost:80",protocol:"http",host:"localhost",port:80,href:"http://localhost/",hash:""}}).call(this,"undefined"!=typeof n?n:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],14:[function(e,t,a){(function(n,a){function i(e,t,n){if(!(this instanceof i))return new i(e,t,n);if(arguments.length<1)throw new TypeError("Failed to construct 'SockJS: 1 argument required, but only 0 present");b.call(this),this.readyState=i.CONNECTING,this.extensions="",this.protocol="",n=n||{},n.protocols_whitelist&&v.warn("'protocols_whitelist' is DEPRECATED. Use 'transports' instead."),this._transportsWhitelist=n.transports;var a=n.sessionId||8;if("function"==typeof a)this._generateSessionId=a;else{if("number"!=typeof a)throw new TypeError("If sessionId is used in the options, it needs to be a number or a function.");this._generateSessionId=function(){return u.string(a)}}this._server=n.server||u.numberString(1e3);var o=new r(e);if(!o.host||!o.protocol)throw new SyntaxError("The URL '"+e+"' is invalid");if(o.hash)throw new SyntaxError("The URL must not contain a fragment");if("http:"!==o.protocol&&"https:"!==o.protocol)throw new SyntaxError("The URL's scheme must be either 'http:' or 'https:'. '"+o.protocol+"' is not allowed.");var s="https:"===o.protocol;if("https"===y.protocol&&!s)throw new Error("SecurityError: An insecure SockJS connection may not be initiated from a page loaded over HTTPS");t?Array.isArray(t)||(t=[t]):t=[];var l=t.sort();l.forEach(function(e,t){if(!e)throw new SyntaxError("The protocols entry '"+e+"' is invalid.");if(t<l.length-1&&e===l[t+1])throw new SyntaxError("The protocols entry '"+e+"' is duplicated.")});var c=d.getOrigin(y.href);this._origin=c?c.toLowerCase():null,o.set("pathname",o.pathname.replace(/\/+$/,"")),this.url=o.href,x("using url",this.url),this._urlInfo={nullOrigin:!m.hasDomain(),sameOrigin:d.isOriginEqual(this.url,y.href),sameScheme:d.isSchemeEqual(this.url,y.href)},this._ir=new k(this.url,this._urlInfo),this._ir.once("finish",this._receiveInfo.bind(this))}function o(e){return 1e3===e||e>=3e3&&4999>=e}e("./shims");var r=e("url-parse"),s=e("inherits"),l=e("json3"),u=e("./utils/random"),c=e("./utils/escape"),d=e("./utils/url"),f=e("./utils/event"),p=e("./utils/transport"),g=e("./utils/object"),m=e("./utils/browser"),v=e("./utils/log"),h=e("./event/event"),b=e("./event/eventtarget"),y=e("./location"),_=e("./event/close"),w=e("./event/trans-message"),k=e("./info-receiver"),x=function(){};x=e("debug")("sockjs-client:main");var T;s(i,b),i.prototype.close=function(e,t){if(e&&!o(e))throw new Error("InvalidAccessError: Invalid code");if(t&&t.length>123)throw new SyntaxError("reason argument has an invalid length");if(this.readyState!==i.CLOSING&&this.readyState!==i.CLOSED){var n=!0;this._close(e||1e3,t||"Normal closure",n)}},i.prototype.send=function(e){if("string"!=typeof e&&(e=""+e),this.readyState===i.CONNECTING)throw new Error("InvalidStateError: The connection has not been established yet");this.readyState===i.OPEN&&this._transport.send(c.quote(e))},i.version=e("./version"),i.CONNECTING=0,i.OPEN=1,i.CLOSING=2,i.CLOSED=3,i.prototype._receiveInfo=function(e,t){if(x("_receiveInfo",t),this._ir=null,!e)return void this._close(1002,"Cannot connect to server");this._rto=this.countRTO(t),this._transUrl=e.base_url?e.base_url:this.url,e=g.extend(e,this._urlInfo),x("info",e);var n=T.filterToEnabled(this._transportsWhitelist,e);this._transports=n.main,x(this._transports.length+" enabled transports"),this._connect()},i.prototype._connect=function(){for(var e=this._transports.shift();e;e=this._transports.shift()){if(x("attempt",e.transportName),e.needBody&&(!a.document.body||"undefined"!=typeof a.document.readyState&&"complete"!==a.document.readyState&&"interactive"!==a.document.readyState))return x("waiting for body"),this._transports.unshift(e),void f.attachEvent("load",this._connect.bind(this));var t=this._rto*e.roundTrips||5e3;this._transportTimeoutId=setTimeout(this._transportTimeout.bind(this),t),x("using timeout",t);var n=d.addPath(this._transUrl,"/"+this._server+"/"+this._generateSessionId());x("transport url",n);var i=new e(n,this._transUrl);return i.on("message",this._transportMessage.bind(this)),i.once("close",this._transportClose.bind(this)),i.transportName=e.transportName,void(this._transport=i)}this._close(2e3,"All transports failed",!1)},i.prototype._transportTimeout=function(){x("_transportTimeout"),this.readyState===i.CONNECTING&&this._transportClose(2007,"Transport timed out")},i.prototype._transportMessage=function(e){x("_transportMessage",e);var t,n=this,a=e.slice(0,1),i=e.slice(1);switch(a){case"o":return void this._open();case"h":return this.dispatchEvent(new h("heartbeat")),void x("heartbeat",this.transport)}if(i)try{t=l.parse(i)}catch(o){x("bad json",i)}if("undefined"==typeof t)return void x("empty payload",i);switch(a){case"a":Array.isArray(t)&&t.forEach(function(e){x("message",n.transport,e),n.dispatchEvent(new w(e))});break;case"m":x("message",this.transport,t),this.dispatchEvent(new w(t));break;case"c":Array.isArray(t)&&2===t.length&&this._close(t[0],t[1],!0)}},i.prototype._transportClose=function(e,t){return x("_transportClose",this.transport,e,t),this._transport&&(this._transport.removeAllListeners(),this._transport=null,this.transport=null),o(e)||2e3===e||this.readyState!==i.CONNECTING?void this._close(e,t):void this._connect()},i.prototype._open=function(){x("_open",this._transport.transportName,this.readyState),this.readyState===i.CONNECTING?(this._transportTimeoutId&&(clearTimeout(this._transportTimeoutId),this._transportTimeoutId=null),this.readyState=i.OPEN,this.transport=this._transport.transportName,this.dispatchEvent(new h("open")),x("connected",this.transport)):this._close(1006,"Server lost session")},i.prototype._close=function(e,t,n){x("_close",this.transport,e,t,n,this.readyState);var a=!1;this._ir&&(a=!0,this._ir.close(),this._ir=null),this._transport&&(this._transport.close(),this._transport=null,this.transport=null),this.readyState===i.CLOSED,this.readyState=i.CLOSING,setTimeout(function(){this.readyState=i.CLOSED,a&&this.dispatchEvent(new h("error"));var o=new _("close");o.wasClean=n||!1,o.code=e||1e3,o.reason=t,this.dispatchEvent(o),this.onmessage=this.onclose=this.onerror=null,x("disconnected")}.bind(this),0)},i.prototype.countRTO=function(e){return e>100?4*e:300+e},t.exports=function(t){return T=p(t),e("./iframe-bootstrap")(i,t),i}}).call(this,{env:{}},"undefined"!=typeof n?n:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./event/close":2,"./event/event":4,"./event/eventtarget":5,"./event/trans-message":6,"./iframe-bootstrap":8,"./info-receiver":12,"./location":13,"./shims":15,"./utils/browser":44,"./utils/escape":45,"./utils/event":46,"./utils/log":48,
"./utils/object":49,"./utils/random":50,"./utils/transport":51,"./utils/url":52,"./version":53,debug:54,inherits:57,json3:58,"url-parse":59}],15:[function(e,t,n){function a(e){var t=+e;return t!==t?t=0:0!==t&&t!==1/0&&t!==-(1/0)&&(t=(t>0||-1)*Math.floor(Math.abs(t))),t}function i(e){return e>>>0}function o(){}var r,l=Array.prototype,u=Object.prototype,c=Function.prototype,d=String.prototype,f=l.slice,p=u.toString,g=function(e){return"[object Function]"===u.toString.call(e)},m=function(e){return"[object Array]"===p.call(e)},v=function(e){return"[object String]"===p.call(e)},h=Object.defineProperty&&function(){try{return Object.defineProperty({},"x",{}),!0}catch(e){return!1}}();r=h?function(e,t,n,a){!a&&t in e||Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:!0,value:n})}:function(e,t,n,a){!a&&t in e||(e[t]=n)};var b=function(e,t,n){for(var a in t)u.hasOwnProperty.call(t,a)&&r(e,a,t[a],n)},y=function(e){if(null==e)throw new TypeError("can't convert "+e+" to object");return Object(e)};b(c,{bind:function(e){var t=this;if(!g(t))throw new TypeError("Function.prototype.bind called on incompatible "+t);for(var n=f.call(arguments,1),a=function(){if(this instanceof l){var a=t.apply(this,n.concat(f.call(arguments)));return Object(a)===a?a:this}return t.apply(e,n.concat(f.call(arguments)))},i=Math.max(0,t.length-n.length),r=[],s=0;i>s;s++)r.push("$"+s);var l=Function("binder","return function ("+r.join(",")+"){ return binder.apply(this, arguments); }")(a);return t.prototype&&(o.prototype=t.prototype,l.prototype=new o,o.prototype=null),l}}),b(Array,{isArray:m});var _=Object("a"),w="a"!==_[0]||!(0 in _),k=function(e){var t=!0,n=!0;return e&&(e.call("foo",function(e,n,a){"object"!==("undefined"==typeof a?"undefined":s(a))&&(t=!1)}),e.call([1],function(){n="string"==typeof this},"x")),!!e&&t&&n};b(l,{forEach:function(e){var t=y(this),n=w&&v(this)?this.split(""):t,a=arguments[1],i=-1,o=n.length>>>0;if(!g(e))throw new TypeError;for(;++i<o;)i in n&&e.call(a,n[i],i,t)}},!k(l.forEach));var x=Array.prototype.indexOf&&-1!==[0,1].indexOf(1,2);b(l,{indexOf:function(e){var t=w&&v(this)?this.split(""):y(this),n=t.length>>>0;if(!n)return-1;var i=0;for(arguments.length>1&&(i=a(arguments[1])),i=i>=0?i:Math.max(0,n+i);n>i;i++)if(i in t&&t[i]===e)return i;return-1}},x);var T=d.split;2!=="ab".split(/(?:ab)*/).length||4!==".".split(/(.?)(.?)/).length||"t"==="tesst".split(/(s)*/)[1]||4!=="test".split(/(?:)/,-1).length||"".split(/.?/).length||".".split(/()()/).length>1?!function(){var e=void 0===/()??/.exec("")[1];d.split=function(t,n){var a=this;if(void 0===t&&0===n)return[];if("[object RegExp]"!==p.call(t))return T.call(this,t,n);var o,r,s,u,c=[],d=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.extended?"x":"")+(t.sticky?"y":""),f=0;for(t=new RegExp(t.source,d+"g"),a+="",e||(o=new RegExp("^"+t.source+"$(?!\\s)",d)),n=void 0===n?-1>>>0:i(n);(r=t.exec(a))&&(s=r.index+r[0].length,!(s>f&&(c.push(a.slice(f,r.index)),!e&&r.length>1&&r[0].replace(o,function(){for(var e=1;e<arguments.length-2;e++)void 0===arguments[e]&&(r[e]=void 0)}),r.length>1&&r.index<a.length&&l.push.apply(c,r.slice(1)),u=r[0].length,f=s,c.length>=n)));)t.lastIndex===r.index&&t.lastIndex++;return f===a.length?(u||!t.test(""))&&c.push(""):c.push(a.slice(f)),c.length>n?c.slice(0,n):c}}():"0".split(void 0,0).length&&(d.split=function(e,t){return void 0===e&&0===t?[]:T.call(this,e,t)});var E="	\n\f\r   ᠎             　\u2028\u2029\ufeff",C="​",I="["+E+"]",S=new RegExp("^"+I+I+"*"),j=new RegExp(I+I+"*$"),M=d.trim&&(E.trim()||!C.trim());b(d,{trim:function(){if(void 0===this||null===this)throw new TypeError("can't convert "+this+" to object");return String(this).replace(S,"").replace(j,"")}},M);var O=d.substr,B="".substr&&"b"!=="0b".substr(-1);b(d,{substr:function(e,t){return O.call(this,0>e&&(e=this.length+e)<0?0:e,t)}},B)},{}],16:[function(e,t,n){t.exports=[e("./transport/websocket"),e("./transport/xhr-streaming"),e("./transport/xdr-streaming"),e("./transport/eventsource"),e("./transport/lib/iframe-wrap")(e("./transport/eventsource")),e("./transport/htmlfile"),e("./transport/lib/iframe-wrap")(e("./transport/htmlfile")),e("./transport/xhr-polling"),e("./transport/xdr-polling"),e("./transport/lib/iframe-wrap")(e("./transport/xhr-polling")),e("./transport/jsonp-polling")]},{"./transport/eventsource":20,"./transport/htmlfile":21,"./transport/jsonp-polling":23,"./transport/lib/iframe-wrap":26,"./transport/websocket":38,"./transport/xdr-polling":39,"./transport/xdr-streaming":40,"./transport/xhr-polling":41,"./transport/xhr-streaming":42}],17:[function(e,t,a){(function(n,a){function i(e,t,n,a){c(e,t);var i=this;o.call(this),setTimeout(function(){i._start(e,t,n,a)},0)}var o=e("events").EventEmitter,r=e("inherits"),s=e("../../utils/event"),l=e("../../utils/url"),u=a.XMLHttpRequest,c=function(){};c=e("debug")("sockjs-client:browser:xhr"),r(i,o),i.prototype._start=function(e,t,n,a){var o=this;try{this.xhr=new u}catch(r){}if(!this.xhr)return c("no xhr"),this.emit("finish",0,"no xhr support"),void this._cleanup();t=l.addQuery(t,"t="+ +new Date),this.unloadRef=s.unloadAdd(function(){c("unload cleanup"),o._cleanup(!0)});try{this.xhr.open(e,t,!0),this.timeout&&"timeout"in this.xhr&&(this.xhr.timeout=this.timeout,this.xhr.ontimeout=function(){c("xhr timeout"),o.emit("finish",0,""),o._cleanup(!1)})}catch(d){return c("exception",d),this.emit("finish",0,""),void this._cleanup(!1)}if(a&&a.noCredentials||!i.supportsCORS||(c("withCredentials"),this.xhr.withCredentials="true"),a&&a.headers)for(var f in a.headers)this.xhr.setRequestHeader(f,a.headers[f]);this.xhr.onreadystatechange=function(){if(o.xhr){var e,t,n=o.xhr;switch(c("readyState",n.readyState),n.readyState){case 3:try{t=n.status,e=n.responseText}catch(a){}c("status",t),1223===t&&(t=204),200===t&&e&&e.length>0&&(c("chunk"),o.emit("chunk",t,e));break;case 4:t=n.status,c("status",t),1223===t&&(t=204),(12005===t||12029===t)&&(t=0),c("finish",t,n.responseText),o.emit("finish",t,n.responseText),o._cleanup(!1)}}};try{o.xhr.send(n)}catch(d){o.emit("finish",0,""),o._cleanup(!1)}},i.prototype._cleanup=function(e){if(c("cleanup"),this.xhr){if(this.removeAllListeners(),s.unloadDel(this.unloadRef),this.xhr.onreadystatechange=function(){},this.xhr.ontimeout&&(this.xhr.ontimeout=null),e)try{this.xhr.abort()}catch(t){}this.unloadRef=this.xhr=null}},i.prototype.close=function(){c("close"),this._cleanup(!0)},i.enabled=!!u;var d=["Active"].concat("Object").join("X");!i.enabled&&d in a&&(c("overriding xmlhttprequest"),u=function(){try{return new a[d]("Microsoft.XMLHTTP")}catch(e){return null}},i.enabled=!!new u);var f=!1;try{f="withCredentials"in new u}catch(p){}i.supportsCORS=f,t.exports=i}).call(this,{env:{}},"undefined"!=typeof n?n:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../utils/event":46,"../../utils/url":52,debug:54,events:3,inherits:57}],18:[function(e,t,a){(function(e){t.exports=e.EventSource}).call(this,"undefined"!=typeof n?n:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],19:[function(e,t,a){(function(e){t.exports=e.WebSocket||e.MozWebSocket}).call(this,"undefined"!=typeof n?n:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],20:[function(e,t,n){function a(e){if(!a.enabled())throw new Error("Transport created when disabled");o.call(this,e,"/eventsource",r,s)}var i=e("inherits"),o=e("./lib/ajax-based"),r=e("./receiver/eventsource"),s=e("./sender/xhr-cors"),l=e("eventsource");i(a,o),a.enabled=function(){return!!l},a.transportName="eventsource",a.roundTrips=2,t.exports=a},{"./lib/ajax-based":24,"./receiver/eventsource":29,"./sender/xhr-cors":35,eventsource:18,inherits:57}],21:[function(e,t,n){function a(e){if(!o.enabled)throw new Error("Transport created when disabled");s.call(this,e,"/htmlfile",o,r)}var i=e("inherits"),o=e("./receiver/htmlfile"),r=e("./sender/xhr-local"),s=e("./lib/ajax-based");i(a,s),a.enabled=function(e){return o.enabled&&e.sameOrigin},a.transportName="htmlfile",a.roundTrips=2,t.exports=a},{"./lib/ajax-based":24,"./receiver/htmlfile":30,"./sender/xhr-local":37,inherits:57}],22:[function(e,t,n){(function(n){function a(e,t,n){if(!a.enabled())throw new Error("Transport created when disabled");r.call(this);var i=this;this.origin=l.getOrigin(n),this.baseUrl=n,this.transUrl=t,this.transport=e,this.windowId=d.string(8);var o=l.addPath(n,"/iframe.html")+"#"+this.windowId;f(e,t,o),this.iframeObj=u.createIframe(o,function(e){f("err callback"),i.emit("close",1006,"Unable to load an iframe ("+e+")"),i.close()}),this.onmessageCallback=this._message.bind(this),c.attachEvent("message",this.onmessageCallback)}var i=e("inherits"),o=e("json3"),r=e("events").EventEmitter,s=e("../version"),l=e("../utils/url"),u=e("../utils/iframe"),c=e("../utils/event"),d=e("../utils/random"),f=function(){};f=e("debug")("sockjs-client:transport:iframe"),i(a,r),a.prototype.close=function(){if(f("close"),this.removeAllListeners(),this.iframeObj){c.detachEvent("message",this.onmessageCallback);try{this.postMessage("c")}catch(e){}this.iframeObj.cleanup(),this.iframeObj=null,this.onmessageCallback=this.iframeObj=null}},a.prototype._message=function(e){if(f("message",e.data),!l.isOriginEqual(e.origin,this.origin))return void f("not same origin",e.origin,this.origin);var t;try{t=o.parse(e.data)}catch(n){return void f("bad json",e.data)}if(t.windowId!==this.windowId)return void f("mismatched window id",t.windowId,this.windowId);switch(t.type){case"s":this.iframeObj.loaded(),this.postMessage("s",o.stringify([s,this.transport,this.transUrl,this.baseUrl]));break;case"t":this.emit("message",t.data);break;case"c":var a;try{a=o.parse(t.data)}catch(n){return void f("bad json",t.data)}this.emit("close",a[0],a[1]),this.close()}},a.prototype.postMessage=function(e,t){f("postMessage",e,t),this.iframeObj.post(o.stringify({windowId:this.windowId,type:e,data:t||""}),this.origin)},a.prototype.send=function(e){f("send",e),this.postMessage("m",e)},a.enabled=function(){return u.iframeEnabled},a.transportName="iframe",a.roundTrips=2,t.exports=a}).call(this,{env:{}})},{"../utils/event":46,"../utils/iframe":47,"../utils/random":50,"../utils/url":52,"../version":53,debug:54,events:3,inherits:57,json3:58}],23:[function(e,t,a){(function(n){function a(e){if(!a.enabled())throw new Error("Transport created when disabled");o.call(this,e,"/jsonp",s,r)}var i=e("inherits"),o=e("./lib/sender-receiver"),r=e("./receiver/jsonp"),s=e("./sender/jsonp");i(a,o),a.enabled=function(){return!!n.document},a.transportName="jsonp-polling",a.roundTrips=1,a.needBody=!0,t.exports=a}).call(this,"undefined"!=typeof n?n:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./lib/sender-receiver":28,"./receiver/jsonp":31,"./sender/jsonp":33,inherits:57}],24:[function(e,t,n){(function(n){function a(e){return function(t,n,a){l("create ajax sender",t,n);var i={};"string"==typeof n&&(i.headers={"Content-type":"text/plain"});var o=r.addPath(t,"/xhr_send"),s=new e("POST",o,n,i);return s.once("finish",function(e){return l("finish",e),s=null,200!==e&&204!==e?a(new Error("http status "+e)):void a()}),function(){l("abort"),s.close(),s=null;var e=new Error("Aborted");e.code=1e3,a(e)}}}function i(e,t,n,i){s.call(this,e,t,a(i),n,i)}var o=e("inherits"),r=e("../../utils/url"),s=e("./sender-receiver"),l=function(){};l=e("debug")("sockjs-client:ajax-based"),o(i,s),t.exports=i}).call(this,{env:{}})},{"../../utils/url":52,"./sender-receiver":28,debug:54,inherits:57}],25:[function(e,t,n){(function(n){function a(e,t){r(e),o.call(this),this.sendBuffer=[],this.sender=t,this.url=e}var i=e("inherits"),o=e("events").EventEmitter,r=function(){};r=e("debug")("sockjs-client:buffered-sender"),i(a,o),a.prototype.send=function(e){r("send",e),this.sendBuffer.push(e),this.sendStop||this.sendSchedule()},a.prototype.sendScheduleWait=function(){r("sendScheduleWait");var e,t=this;this.sendStop=function(){r("sendStop"),t.sendStop=null,clearTimeout(e)},e=setTimeout(function(){r("timeout"),t.sendStop=null,t.sendSchedule()},25)},a.prototype.sendSchedule=function(){r("sendSchedule",this.sendBuffer.length);var e=this;if(this.sendBuffer.length>0){var t="["+this.sendBuffer.join(",")+"]";this.sendStop=this.sender(this.url,t,function(t){e.sendStop=null,t?(r("error",t),e.emit("close",t.code||1006,"Sending error: "+t),e._cleanup()):e.sendScheduleWait()}),this.sendBuffer=[]}},a.prototype._cleanup=function(){r("_cleanup"),this.removeAllListeners()},a.prototype.stop=function(){r("stop"),this._cleanup(),this.sendStop&&(this.sendStop(),this.sendStop=null)},t.exports=a}).call(this,{env:{}})},{debug:54,events:3,inherits:57}],26:[function(e,t,a){(function(n){var a=e("inherits"),i=e("../iframe"),o=e("../../utils/object");t.exports=function(e){function t(t,n){i.call(this,e.transportName,t,n)}return a(t,i),t.enabled=function(t,a){if(!n.document)return!1;var r=o.extend({},a);return r.sameOrigin=!0,e.enabled(r)&&i.enabled()},t.transportName="iframe-"+e.transportName,t.needBody=!0,t.roundTrips=i.roundTrips+e.roundTrips-1,t.facadeTransport=e,t}}).call(this,"undefined"!=typeof n?n:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../utils/object":49,"../iframe":22,inherits:57}],27:[function(e,t,n){(function(n){function a(e,t,n){r(t),o.call(this),this.Receiver=e,this.receiveUrl=t,this.AjaxObject=n,this._scheduleReceiver()}var i=e("inherits"),o=e("events").EventEmitter,r=function(){};r=e("debug")("sockjs-client:polling"),i(a,o),a.prototype._scheduleReceiver=function(){r("_scheduleReceiver");var e=this,t=this.poll=new this.Receiver(this.receiveUrl,this.AjaxObject);t.on("message",function(t){r("message",t),e.emit("message",t)}),t.once("close",function(n,a){r("close",n,a,e.pollIsClosing),e.poll=t=null,e.pollIsClosing||("network"===a?e._scheduleReceiver():(e.emit("close",n||1006,a),e.removeAllListeners()))})},a.prototype.abort=function(){r("abort"),this.removeAllListeners(),this.pollIsClosing=!0,this.poll&&this.poll.abort()},t.exports=a}).call(this,{env:{}})},{debug:54,events:3,inherits:57}],28:[function(e,t,n){(function(n){function a(e,t,n,a,i){var u=o.addPath(e,t);l(u);var c=this;r.call(this,e,n),this.poll=new s(a,u,i),this.poll.on("message",function(e){l("poll message",e),c.emit("message",e)}),this.poll.once("close",function(e,t){l("poll close",e,t),c.poll=null,c.emit("close",e,t),c.close()})}var i=e("inherits"),o=e("../../utils/url"),r=e("./buffered-sender"),s=e("./polling"),l=function(){};l=e("debug")("sockjs-client:sender-receiver"),i(a,r),a.prototype.close=function(){l("close"),this.removeAllListeners(),this.poll&&(this.poll.abort(),this.poll=null),this.stop()},t.exports=a}).call(this,{env:{}})},{"../../utils/url":52,"./buffered-sender":25,"./polling":27,debug:54,inherits:57}],29:[function(e,t,n){(function(n){function a(e){s(e),o.call(this);var t=this,n=this.es=new r(e);n.onmessage=function(e){s("message",e.data),t.emit("message",decodeURI(e.data))},n.onerror=function(e){s("error",n.readyState,e);var a=2!==n.readyState?"network":"permanent";t._cleanup(),t._close(a)}}var i=e("inherits"),o=e("events").EventEmitter,r=e("eventsource"),s=function(){};s=e("debug")("sockjs-client:receiver:eventsource"),i(a,o),a.prototype.abort=function(){s("abort"),this._cleanup(),this._close("user")},a.prototype._cleanup=function(){s("cleanup");var e=this.es;e&&(e.onmessage=e.onerror=null,e.close(),this.es=null)},a.prototype._close=function(e){s("close",e);var t=this;setTimeout(function(){t.emit("close",null,e),t.removeAllListeners()},200)},t.exports=a}).call(this,{env:{}})},{debug:54,events:3,eventsource:18,inherits:57}],30:[function(e,t,a){(function(n,a){function i(e){c(e),l.call(this);var t=this;r.polluteGlobalNamespace(),this.id="a"+u.string(6),e=s.addQuery(e,"c="+decodeURIComponent(r.WPrefix+"."+this.id)),c("using htmlfile",i.htmlfileEnabled);var n=i.htmlfileEnabled?r.createHtmlfile:r.createIframe;a[r.WPrefix][this.id]={start:function(){c("start"),t.iframeObj.loaded()},message:function(e){c("message",e),t.emit("message",e)},stop:function(){c("stop"),t._cleanup(),t._close("network")}},this.iframeObj=n(e,function(){c("callback"),t._cleanup(),t._close("permanent")})}var o=e("inherits"),r=e("../../utils/iframe"),s=e("../../utils/url"),l=e("events").EventEmitter,u=e("../../utils/random"),c=function(){};c=e("debug")("sockjs-client:receiver:htmlfile"),o(i,l),i.prototype.abort=function(){c("abort"),this._cleanup(),this._close("user")},i.prototype._cleanup=function(){c("_cleanup"),this.iframeObj&&(this.iframeObj.cleanup(),this.iframeObj=null),delete a[r.WPrefix][this.id]},i.prototype._close=function(e){c("_close",e),this.emit("close",null,e),this.removeAllListeners()},i.htmlfileEnabled=!1;var d=["Active"].concat("Object").join("X");if(d in a)try{i.htmlfileEnabled=!!new a[d]("htmlfile")}catch(f){}i.enabled=i.htmlfileEnabled||r.iframeEnabled,t.exports=i}).call(this,{env:{}},"undefined"!=typeof n?n:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../utils/iframe":47,"../../utils/random":50,"../../utils/url":52,debug:54,events:3,inherits:57}],31:[function(e,t,a){(function(n,a){function i(e){d(e);var t=this;c.call(this),o.polluteGlobalNamespace(),this.id="a"+r.string(6);var n=l.addQuery(e,"c="+encodeURIComponent(o.WPrefix+"."+this.id));a[o.WPrefix][this.id]=this._callback.bind(this),this._createScript(n),this.timeoutId=setTimeout(function(){d("timeout"),t._abort(new Error("JSONP script loaded abnormally (timeout)"))},i.timeout)}var o=e("../../utils/iframe"),r=e("../../utils/random"),s=e("../../utils/browser"),l=e("../../utils/url"),u=e("inherits"),c=e("events").EventEmitter,d=function(){};d=e("debug")("sockjs-client:receiver:jsonp"),u(i,c),i.prototype.abort=function(){if(d("abort"),a[o.WPrefix][this.id]){var e=new Error("JSONP user aborted read");e.code=1e3,this._abort(e)}},i.timeout=35e3,i.scriptErrorTimeout=1e3,i.prototype._callback=function(e){d("_callback",e),this._cleanup(),this.aborting||(e&&(d("message",e),this.emit("message",e)),this.emit("close",null,"network"),this.removeAllListeners())},i.prototype._abort=function(e){d("_abort",e),this._cleanup(),this.aborting=!0,this.emit("close",e.code,e.message),this.removeAllListeners()},i.prototype._cleanup=function(){if(d("_cleanup"),clearTimeout(this.timeoutId),this.script2&&(this.script2.parentNode.removeChild(this.script2),this.script2=null),this.script){var e=this.script;e.parentNode.removeChild(e),e.onreadystatechange=e.onerror=e.onload=e.onclick=null,this.script=null}delete a[o.WPrefix][this.id]},i.prototype._scriptError=function(){d("_scriptError");var e=this;this.errorTimer||(this.errorTimer=setTimeout(function(){e.loadedOkay||e._abort(new Error("JSONP script loaded abnormally (onerror)"))},i.scriptErrorTimeout))},i.prototype._createScript=function(e){d("_createScript",e);var t,n=this,i=this.script=a.document.createElement("script");if(i.id="a"+r.string(8),i.src=e,i.type="text/javascript",i.charset="UTF-8",i.onerror=this._scriptError.bind(this),i.onload=function(){d("onload"),n._abort(new Error("JSONP script loaded abnormally (onload)"))},i.onreadystatechange=function(){if(d("onreadystatechange",i.readyState),/loaded|closed/.test(i.readyState)){if(i&&i.htmlFor&&i.onclick){n.loadedOkay=!0;try{i.onclick()}catch(e){}}i&&n._abort(new Error("JSONP script loaded abnormally (onreadystatechange)"))}},"undefined"==typeof i.async&&a.document.attachEvent)if(s.isOpera())t=this.script2=a.document.createElement("script"),t.text="try{var a = document.getElementById('"+i.id+"'); if(a)a.onerror();}catch(x){};",i.async=t.async=!1;else{try{i.htmlFor=i.id,i.event="onclick"}catch(o){}i.async=!0}"undefined"!=typeof i.async&&(i.async=!0);var l=a.document.getElementsByTagName("head")[0];l.insertBefore(i,l.firstChild),t&&l.insertBefore(t,l.firstChild)},t.exports=i}).call(this,{env:{}},"undefined"!=typeof n?n:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../utils/browser":44,"../../utils/iframe":47,"../../utils/random":50,"../../utils/url":52,debug:54,events:3,inherits:57}],32:[function(e,t,n){(function(n){function a(e,t){r(e),o.call(this);var n=this;this.bufferPosition=0,this.xo=new t("POST",e,null),this.xo.on("chunk",this._chunkHandler.bind(this)),this.xo.once("finish",function(e,t){r("finish",e,t),n._chunkHandler(e,t),n.xo=null;var a=200===e?"network":"permanent";r("close",a),n.emit("close",null,a),n._cleanup()})}var i=e("inherits"),o=e("events").EventEmitter,r=function(){};r=e("debug")("sockjs-client:receiver:xhr"),i(a,o),a.prototype._chunkHandler=function(e,t){if(r("_chunkHandler",e),200===e&&t)for(var n=-1;;this.bufferPosition+=n+1){var a=t.slice(this.bufferPosition);if(n=a.indexOf("\n"),-1===n)break;var i=a.slice(0,n);i&&(r("message",i),this.emit("message",i))}},a.prototype._cleanup=function(){r("_cleanup"),this.removeAllListeners()},a.prototype.abort=function(){r("abort"),this.xo&&(this.xo.close(),r("close"),this.emit("close",null,"user"),this.xo=null),this._cleanup()},t.exports=a}).call(this,{env:{}})},{debug:54,events:3,inherits:57}],33:[function(e,t,a){(function(n,a){function i(e){l("createIframe",e);try{return a.document.createElement('<iframe name="'+e+'">')}catch(t){var n=a.document.createElement("iframe");return n.name=e,n}}function o(){l("createForm"),u=a.document.createElement("form"),u.style.display="none",u.style.position="absolute",u.method="POST",u.enctype="application/x-www-form-urlencoded",u.acceptCharset="UTF-8",c=a.document.createElement("textarea"),c.name="d",u.appendChild(c),a.document.body.appendChild(u)}var r=e("../../utils/random"),s=e("../../utils/url"),l=function(){};l=e("debug")("sockjs-client:sender:jsonp");var u,c;t.exports=function(e,t,n){l(e,t),u||o();var a="a"+r.string(8);u.target=a,u.action=s.addQuery(s.addPath(e,"/jsonp_send"),"i="+a);var d=i(a);d.id=a,d.style.display="none",u.appendChild(d);try{c.value=t}catch(f){}u.submit();var p=function(e){l("completed",a,e),d.onerror&&(d.onreadystatechange=d.onerror=d.onload=null,setTimeout(function(){l("cleaning up",a),d.parentNode.removeChild(d),d=null},500),c.value="",n(e))};return d.onerror=function(){l("onerror",a),p()},d.onload=function(){l("onload",a),p()},d.onreadystatechange=function(e){l("onreadystatechange",a,d.readyState,e),"complete"===d.readyState&&p()},function(){l("aborted",a),p(new Error("Aborted"))}}}).call(this,{env:{}},"undefined"!=typeof n?n:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../utils/random":50,"../../utils/url":52,debug:54}],34:[function(e,t,a){(function(n,a){function i(e,t,n){c(e,t);var a=this;o.call(this),setTimeout(function(){a._start(e,t,n)},0)}var o=e("events").EventEmitter,r=e("inherits"),s=e("../../utils/event"),l=e("../../utils/browser"),u=e("../../utils/url"),c=function(){};c=e("debug")("sockjs-client:sender:xdr"),r(i,o),i.prototype._start=function(e,t,n){c("_start");var i=this,o=new a.XDomainRequest;t=u.addQuery(t,"t="+ +new Date),o.onerror=function(){c("onerror"),i._error()},o.ontimeout=function(){c("ontimeout"),i._error()},o.onprogress=function(){c("progress",o.responseText),i.emit("chunk",200,o.responseText)},o.onload=function(){c("load"),i.emit("finish",200,o.responseText),i._cleanup(!1)},this.xdr=o,this.unloadRef=s.unloadAdd(function(){i._cleanup(!0)});try{this.xdr.open(e,t),this.timeout&&(this.xdr.timeout=this.timeout),this.xdr.send(n)}catch(r){this._error()}},i.prototype._error=function(){this.emit("finish",0,""),this._cleanup(!1)},i.prototype._cleanup=function(e){if(c("cleanup",e),this.xdr){if(this.removeAllListeners(),s.unloadDel(this.unloadRef),this.xdr.ontimeout=this.xdr.onerror=this.xdr.onprogress=this.xdr.onload=null,e)try{this.xdr.abort()}catch(t){}this.unloadRef=this.xdr=null}},i.prototype.close=function(){c("close"),this._cleanup(!0)},i.enabled=!(!a.XDomainRequest||!l.hasDomain()),t.exports=i}).call(this,{env:{}},"undefined"!=typeof n?n:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../utils/browser":44,"../../utils/event":46,"../../utils/url":52,debug:54,events:3,inherits:57}],35:[function(e,t,n){function a(e,t,n,a){o.call(this,e,t,n,a)}var i=e("inherits"),o=e("../driver/xhr");i(a,o),a.enabled=o.enabled&&o.supportsCORS,t.exports=a},{"../driver/xhr":17,inherits:57}],36:[function(e,t,n){function a(){var e=this;i.call(this),this.to=setTimeout(function(){e.emit("finish",200,"{}")},a.timeout)}var i=e("events").EventEmitter,o=e("inherits");o(a,i),a.prototype.close=function(){clearTimeout(this.to)},a.timeout=2e3,t.exports=a},{events:3,inherits:57}],37:[function(e,t,n){function a(e,t,n){o.call(this,e,t,n,{noCredentials:!0})}var i=e("inherits"),o=e("../driver/xhr");i(a,o),a.enabled=o.enabled,t.exports=a},{"../driver/xhr":17,inherits:57}],38:[function(e,t,n){(function(n){function a(e){if(!a.enabled())throw new Error("Transport created when disabled");s.call(this),u("constructor",e);var t=this,n=o.addPath(e,"/websocket");n="https"===n.slice(0,5)?"wss"+n.slice(5):"ws"+n.slice(4),this.url=n,this.ws=new l(this.url),this.ws.onmessage=function(e){u("message event",e.data),t.emit("message",e.data)},this.unloadRef=i.unloadAdd(function(){u("unload"),t.ws.close()}),this.ws.onclose=function(e){u("close event",e.code,e.reason),t.emit("close",e.code,e.reason),t._cleanup()},this.ws.onerror=function(e){u("error event",e),t.emit("close",1006,"WebSocket connection broken"),t._cleanup()}}var i=e("../utils/event"),o=e("../utils/url"),r=e("inherits"),s=e("events").EventEmitter,l=e("./driver/websocket"),u=function(){};u=e("debug")("sockjs-client:websocket"),r(a,s),a.prototype.send=function(e){var t="["+e+"]";u("send",t),this.ws.send(t)},a.prototype.close=function(){u("close"),this.ws&&this.ws.close(),this._cleanup()},a.prototype._cleanup=function(){u("_cleanup");var e=this.ws;e&&(e.onmessage=e.onclose=e.onerror=null),i.unloadDel(this.unloadRef),this.unloadRef=this.ws=null,this.removeAllListeners()},a.enabled=function(){return u("enabled"),!!l},a.transportName="websocket",a.roundTrips=8,t.exports=a}).call(this,{env:{}})},{"../utils/event":46,"../utils/url":52,"./driver/websocket":19,debug:54,events:3,inherits:57}],39:[function(e,t,n){function a(e){if(!l.enabled)throw new Error("Transport created when disabled");o.call(this,e,"/xhr",s,l)}var i=e("inherits"),o=e("./lib/ajax-based"),r=e("./xdr-streaming"),s=e("./receiver/xhr"),l=e("./sender/xdr");i(a,o),a.enabled=r.enabled,a.transportName="xdr-polling",a.roundTrips=2,t.exports=a},{"./lib/ajax-based":24,"./receiver/xhr":32,"./sender/xdr":34,"./xdr-streaming":40,inherits:57}],40:[function(e,t,n){function a(e){if(!s.enabled)throw new Error("Transport created when disabled");o.call(this,e,"/xhr_streaming",r,s)}var i=e("inherits"),o=e("./lib/ajax-based"),r=e("./receiver/xhr"),s=e("./sender/xdr");i(a,o),a.enabled=function(e){return e.cookie_needed||e.nullOrigin?!1:s.enabled&&e.sameScheme},a.transportName="xdr-streaming",a.roundTrips=2,t.exports=a},{"./lib/ajax-based":24,"./receiver/xhr":32,"./sender/xdr":34,inherits:57}],41:[function(e,t,n){function a(e){if(!l.enabled&&!s.enabled)throw new Error("Transport created when disabled");o.call(this,e,"/xhr",r,s)}var i=e("inherits"),o=e("./lib/ajax-based"),r=e("./receiver/xhr"),s=e("./sender/xhr-cors"),l=e("./sender/xhr-local");i(a,o),a.enabled=function(e){return e.nullOrigin?!1:l.enabled&&e.sameOrigin?!0:s.enabled},a.transportName="xhr-polling",a.roundTrips=2,t.exports=a},{"./lib/ajax-based":24,"./receiver/xhr":32,"./sender/xhr-cors":35,"./sender/xhr-local":37,inherits:57}],42:[function(e,t,a){(function(n){function a(e){if(!l.enabled&&!s.enabled)throw new Error("Transport created when disabled");o.call(this,e,"/xhr_streaming",r,s)}var i=e("inherits"),o=e("./lib/ajax-based"),r=e("./receiver/xhr"),s=e("./sender/xhr-cors"),l=e("./sender/xhr-local"),u=e("../utils/browser");i(a,o),a.enabled=function(e){return e.nullOrigin?!1:u.isOpera()?!1:s.enabled},a.transportName="xhr-streaming",a.roundTrips=2,a.needBody=!!n.document,t.exports=a}).call(this,"undefined"!=typeof n?n:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../utils/browser":44,"./lib/ajax-based":24,"./receiver/xhr":32,"./sender/xhr-cors":35,"./sender/xhr-local":37,inherits:57}],43:[function(e,t,a){(function(e){t.exports.randomBytes=e.crypto&&e.crypto.getRandomValues?function(t){var n=new Uint8Array(t);return e.crypto.getRandomValues(n),n}:function(e){for(var t=new Array(e),n=0;e>n;n++)t[n]=Math.floor(256*Math.random());return t}}).call(this,"undefined"!=typeof n?n:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],44:[function(e,t,a){(function(e){t.exports={isOpera:function(){return e.navigator&&/opera/i.test(e.navigator.userAgent)},isKonqueror:function(){return e.navigator&&/konqueror/i.test(e.navigator.userAgent)},hasDomain:function(){if(!e.document)return!0;try{return!!e.document.domain}catch(t){return!1}}}}).call(this,"undefined"!=typeof n?n:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],45:[function(e,t,n){var a,i=e("json3"),o=/[\x00-\x1f\ud800-\udfff\ufffe\uffff\u0300-\u0333\u033d-\u0346\u034a-\u034c\u0350-\u0352\u0357-\u0358\u035c-\u0362\u0374\u037e\u0387\u0591-\u05af\u05c4\u0610-\u0617\u0653-\u0654\u0657-\u065b\u065d-\u065e\u06df-\u06e2\u06eb-\u06ec\u0730\u0732-\u0733\u0735-\u0736\u073a\u073d\u073f-\u0741\u0743\u0745\u0747\u07eb-\u07f1\u0951\u0958-\u095f\u09dc-\u09dd\u09df\u0a33\u0a36\u0a59-\u0a5b\u0a5e\u0b5c-\u0b5d\u0e38-\u0e39\u0f43\u0f4d\u0f52\u0f57\u0f5c\u0f69\u0f72-\u0f76\u0f78\u0f80-\u0f83\u0f93\u0f9d\u0fa2\u0fa7\u0fac\u0fb9\u1939-\u193a\u1a17\u1b6b\u1cda-\u1cdb\u1dc0-\u1dcf\u1dfc\u1dfe\u1f71\u1f73\u1f75\u1f77\u1f79\u1f7b\u1f7d\u1fbb\u1fbe\u1fc9\u1fcb\u1fd3\u1fdb\u1fe3\u1feb\u1fee-\u1fef\u1ff9\u1ffb\u1ffd\u2000-\u2001\u20d0-\u20d1\u20d4-\u20d7\u20e7-\u20e9\u2126\u212a-\u212b\u2329-\u232a\u2adc\u302b-\u302c\uaab2-\uaab3\uf900-\ufa0d\ufa10\ufa12\ufa15-\ufa1e\ufa20\ufa22\ufa25-\ufa26\ufa2a-\ufa2d\ufa30-\ufa6d\ufa70-\ufad9\ufb1d\ufb1f\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufb4e\ufff0-\uffff]/g,r=function(e){var t,n={},a=[];for(t=0;65536>t;t++)a.push(String.fromCharCode(t));return e.lastIndex=0,a.join("").replace(e,function(e){return n[e]="\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4),""}),e.lastIndex=0,n};t.exports={quote:function(e){var t=i.stringify(e);return o.lastIndex=0,o.test(t)?(a||(a=r(o)),t.replace(o,function(e){return a[e]})):t}}},{json3:58}],46:[function(e,t,a){(function(n){var a=e("./random"),i={},o=!1,r=n.chrome&&n.chrome.app&&n.chrome.app.runtime;t.exports={attachEvent:function(e,t){"undefined"!=typeof n.addEventListener?n.addEventListener(e,t,!1):n.document&&n.attachEvent&&(n.document.attachEvent("on"+e,t),n.attachEvent("on"+e,t))},detachEvent:function(e,t){"undefined"!=typeof n.addEventListener?n.removeEventListener(e,t,!1):n.document&&n.detachEvent&&(n.document.detachEvent("on"+e,t),n.detachEvent("on"+e,t))},unloadAdd:function(e){if(r)return null;var t=a.string(8);return i[t]=e,o&&setTimeout(this.triggerUnloadCallbacks,0),t},unloadDel:function(e){e in i&&delete i[e]},triggerUnloadCallbacks:function(){for(var e in i)i[e](),delete i[e]}};var s=function(){o||(o=!0,t.exports.triggerUnloadCallbacks())};r||t.exports.attachEvent("unload",s)}).call(this,"undefined"!=typeof n?n:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./random":50}],47:[function(e,t,a){(function(n,a){var i=e("./event"),o=e("json3"),r=e("./browser"),l=function(){};l=e("debug")("sockjs-client:utils:iframe"),t.exports={WPrefix:"_jp",currentWindowId:null,polluteGlobalNamespace:function(){t.exports.WPrefix in a||(a[t.exports.WPrefix]={})},postMessage:function(e,n){a.parent!==a?a.parent.postMessage(o.stringify({windowId:t.exports.currentWindowId,type:e,data:n||""}),"*"):l("Cannot postMessage, no parent window.",e,n)},createIframe:function(e,t){var n,o,r=a.document.createElement("iframe"),s=function(){l("unattach"),clearTimeout(n);try{r.onload=null}catch(e){}r.onerror=null},u=function(){l("cleanup"),r&&(s(),setTimeout(function(){r&&r.parentNode.removeChild(r),r=null},0),i.unloadDel(o))},c=function(e){l("onerror",e),r&&(u(),t(e))},d=function(e,t){l("post",e,t);try{setTimeout(function(){
r&&r.contentWindow&&r.contentWindow.postMessage(e,t)},0)}catch(n){}};return r.src=e,r.style.display="none",r.style.position="absolute",r.onerror=function(){c("onerror")},r.onload=function(){l("onload"),clearTimeout(n),n=setTimeout(function(){c("onload timeout")},2e3)},a.document.body.appendChild(r),n=setTimeout(function(){c("timeout")},15e3),o=i.unloadAdd(u),{post:d,cleanup:u,loaded:s}},createHtmlfile:function(e,n){var o,r,s,u=["Active"].concat("Object").join("X"),c=new a[u]("htmlfile"),d=function(){clearTimeout(o),s.onerror=null},f=function(){c&&(d(),i.unloadDel(r),s.parentNode.removeChild(s),s=c=null,CollectGarbage())},p=function(e){l("onerror",e),c&&(f(),n(e))},g=function(e,t){try{setTimeout(function(){s&&s.contentWindow&&s.contentWindow.postMessage(e,t)},0)}catch(n){}};c.open(),c.write('<html><script>document.domain="'+a.document.domain+'";</script></html>'),c.close(),c.parentWindow[t.exports.WPrefix]=a[t.exports.WPrefix];var m=c.createElement("div");return c.body.appendChild(m),s=c.createElement("iframe"),m.appendChild(s),s.src=e,s.onerror=function(){p("onerror")},o=setTimeout(function(){p("timeout")},15e3),r=i.unloadAdd(f),{post:g,cleanup:f,loaded:d}}},t.exports.iframeEnabled=!1,a.document&&(t.exports.iframeEnabled=("function"==typeof a.postMessage||"object"===s(a.postMessage))&&!r.isKonqueror())}).call(this,{env:{}},"undefined"!=typeof n?n:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./browser":44,"./event":46,debug:54,json3:58}],48:[function(e,t,a){(function(e){var n={};["log","debug","warn"].forEach(function(t){var a;try{a=e.console&&e.console[t]&&e.console[t].apply}catch(i){}n[t]=a?function(){return e.console[t].apply(e.console,arguments)}:"log"===t?function(){}:n.log}),t.exports=n}).call(this,"undefined"!=typeof n?n:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],49:[function(e,t,n){t.exports={isObject:function(e){var t="undefined"==typeof e?"undefined":s(e);return"function"===t||"object"===t&&!!e},extend:function(e){if(!this.isObject(e))return e;for(var t,n,a=1,i=arguments.length;i>a;a++){t=arguments[a];for(n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}}},{}],50:[function(e,t,n){var a=e("crypto"),i="abcdefghijklmnopqrstuvwxyz012345";t.exports={string:function(e){for(var t=i.length,n=a.randomBytes(e),o=[],r=0;e>r;r++)o.push(i.substr(n[r]%t,1));return o.join("")},number:function(e){return Math.floor(Math.random()*e)},numberString:function(e){var t=(""+(e-1)).length,n=new Array(t+1).join("0");return(n+this.number(e)).slice(-t)}}},{crypto:43}],51:[function(e,t,n){(function(n){var a=function(){};a=e("debug")("sockjs-client:utils:transport"),t.exports=function(e){return{filterToEnabled:function(t,n){var i={main:[],facade:[]};return t?"string"==typeof t&&(t=[t]):t=[],e.forEach(function(e){return e?"websocket"===e.transportName&&n.websocket===!1?void a("disabled from server","websocket"):t.length&&-1===t.indexOf(e.transportName)?void a("not in whitelist",e.transportName):void(e.enabled(n)?(a("enabled",e.transportName),i.main.push(e),e.facadeTransport&&i.facade.push(e.facadeTransport)):a("disabled",e.transportName)):void 0}),i}}}}).call(this,{env:{}})},{debug:54}],52:[function(e,t,n){(function(n){var a=e("url-parse"),i=function(){};i=e("debug")("sockjs-client:utils:url"),t.exports={getOrigin:function(e){if(!e)return null;var t=new a(e);if("file:"===t.protocol)return null;var n=t.port;return n||(n="https:"===t.protocol?"443":"80"),t.protocol+"//"+t.hostname+":"+n},isOriginEqual:function(e,t){var n=this.getOrigin(e)===this.getOrigin(t);return i("same",e,t,n),n},isSchemeEqual:function(e,t){return e.split(":")[0]===t.split(":")[0]},addPath:function(e,t){var n=e.split("?");return n[0]+t+(n[1]?"?"+n[1]:"")},addQuery:function(e,t){return e+(-1===e.indexOf("?")?"?"+t:"&"+t)}}}).call(this,{env:{}})},{debug:54,"url-parse":59}],53:[function(e,t,n){t.exports="1.0.3"},{}],54:[function(e,t,n){function a(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function i(){var e=arguments,t=this.useColors;if(e[0]=(t?"%c":"")+this.namespace+(t?" %c":" ")+e[0]+(t?"%c ":" ")+"+"+n.humanize(this.diff),!t)return e;var a="color: "+this.color;e=[e[0],a,"color: inherit"].concat(Array.prototype.slice.call(e,1));var i=0,o=0;return e[0].replace(/%[a-z%]/g,function(e){"%%"!==e&&(i++,"%c"===e&&(o=i))}),e.splice(o,0,a),e}function o(){return"object"===("undefined"==typeof console?"undefined":s(console))&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function r(e){try{null==e?n.storage.removeItem("debug"):n.storage.debug=e}catch(t){}}function l(){var e;try{e=n.storage.debug}catch(t){}return e}function u(){try{return window.localStorage}catch(e){}}n=t.exports=e("./debug"),n.log=o,n.formatArgs=i,n.save=r,n.load=l,n.useColors=a,n.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:u(),n.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],n.formatters.j=function(e){return JSON.stringify(e)},n.enable(l())},{"./debug":55}],55:[function(e,t,n){function a(){return n.colors[c++%n.colors.length]}function i(e){function t(){}function i(){var e=i,t=+new Date,o=t-(u||t);e.diff=o,e.prev=u,e.curr=t,u=t,null==e.useColors&&(e.useColors=n.useColors()),null==e.color&&e.useColors&&(e.color=a());var r=Array.prototype.slice.call(arguments);r[0]=n.coerce(r[0]),"string"!=typeof r[0]&&(r=["%o"].concat(r));var s=0;r[0]=r[0].replace(/%([a-z%])/g,function(t,a){if("%%"===t)return t;s++;var i=n.formatters[a];if("function"==typeof i){var o=r[s];t=i.call(e,o),r.splice(s,1),s--}return t}),"function"==typeof n.formatArgs&&(r=n.formatArgs.apply(e,r));var l=i.log||n.log||console.log.bind(console);l.apply(e,r)}t.enabled=!1,i.enabled=!0;var o=n.enabled(e)?i:t;return o.namespace=e,o}function o(e){n.save(e);for(var t=(e||"").split(/[\s,]+/),a=t.length,i=0;a>i;i++)t[i]&&(e=t[i].replace(/\*/g,".*?"),"-"===e[0]?n.skips.push(new RegExp("^"+e.substr(1)+"$")):n.names.push(new RegExp("^"+e+"$")))}function r(){n.enable("")}function s(e){var t,a;for(t=0,a=n.skips.length;a>t;t++)if(n.skips[t].test(e))return!1;for(t=0,a=n.names.length;a>t;t++)if(n.names[t].test(e))return!0;return!1}function l(e){return e instanceof Error?e.stack||e.message:e}n=t.exports=i,n.coerce=l,n.disable=r,n.enable=o,n.enabled=s,n.humanize=e("ms"),n.names=[],n.skips=[],n.formatters={};var u,c=0},{ms:56}],56:[function(e,t,n){function a(e){if(e=""+e,!(e.length>1e4)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var n=parseFloat(t[1]),a=(t[2]||"ms").toLowerCase();switch(a){case"years":case"year":case"yrs":case"yr":case"y":return n*d;case"days":case"day":case"d":return n*c;case"hours":case"hour":case"hrs":case"hr":case"h":return n*u;case"minutes":case"minute":case"mins":case"min":case"m":return n*l;case"seconds":case"second":case"secs":case"sec":case"s":return n*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n}}}}function i(e){return e>=c?Math.round(e/c)+"d":e>=u?Math.round(e/u)+"h":e>=l?Math.round(e/l)+"m":e>=s?Math.round(e/s)+"s":e+"ms"}function o(e){return r(e,c,"day")||r(e,u,"hour")||r(e,l,"minute")||r(e,s,"second")||e+" ms"}function r(e,t,n){return t>e?void 0:1.5*t>e?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}var s=1e3,l=60*s,u=60*l,c=24*u,d=365.25*c;t.exports=function(e,t){return t=t||{},"string"==typeof e?a(e):t["long"]?o(e):i(e)}},{}],57:[function(e,t,n){t.exports="function"==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},{}],58:[function(t,a,i){(function(t){(function(){function n(e,t){function a(e){if(a[e]!==h)return a[e];var n;if("bug-string-char-index"==e)n="a"!="a"[0];else if("json"==e)n=a("json-stringify")&&a("json-parse");else{var r,s='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==e){var l=t.stringify,u="function"==typeof l&&_;if(u){(r=function(){return 1}).toJSON=r;try{u="0"===l(0)&&"0"===l(new i)&&'""'==l(new o)&&l(y)===h&&l(h)===h&&l()===h&&"1"===l(r)&&"[1]"==l([r])&&"[null]"==l([h])&&"null"==l(null)&&"[null,null,null]"==l([h,y,null])&&l({a:[r,!0,!1,null,"\x00\b\n\f\r	"]})==s&&"1"===l(null,r)&&"[\n 1,\n 2\n]"==l([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==l(new c(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==l(new c(864e13))&&'"-000001-01-01T00:00:00.000Z"'==l(new c(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==l(new c(-1))}catch(d){u=!1}}n=u}if("json-parse"==e){var f=t.parse;if("function"==typeof f)try{if(0===f("0")&&!f(!1)){r=f(s);var p=5==r.a.length&&1===r.a[0];if(p){try{p=!f('"	"')}catch(d){}if(p)try{p=1!==f("01")}catch(d){}if(p)try{p=1!==f("1.")}catch(d){}}}}catch(d){p=!1}n=p}}return a[e]=!!n}e||(e=u.Object()),t||(t=u.Object());var i=e.Number||u.Number,o=e.String||u.String,l=e.Object||u.Object,c=e.Date||u.Date,d=e.SyntaxError||u.SyntaxError,f=e.TypeError||u.TypeError,p=e.Math||u.Math,g=e.JSON||u.JSON;"object"==("undefined"==typeof g?"undefined":s(g))&&g&&(t.stringify=g.stringify,t.parse=g.parse);var m,v,h,b=l.prototype,y=b.toString,_=new c(-0xc782b5b800cec);try{_=-109252==_.getUTCFullYear()&&0===_.getUTCMonth()&&1===_.getUTCDate()&&10==_.getUTCHours()&&37==_.getUTCMinutes()&&6==_.getUTCSeconds()&&708==_.getUTCMilliseconds()}catch(w){}if(!a("json")){var k="[object Function]",x="[object Date]",T="[object Number]",E="[object String]",C="[object Array]",I="[object Boolean]",S=a("bug-string-char-index");if(!_)var j=p.floor,M=[0,31,59,90,120,151,181,212,243,273,304,334],O=function(e,t){return M[t]+365*(e-1970)+j((e-1969+(t=+(t>1)))/4)-j((e-1901+t)/100)+j((e-1601+t)/400)};if((m=b.hasOwnProperty)||(m=function(e){var t,n={};return(n.__proto__=null,n.__proto__={toString:1},n).toString!=y?m=function(e){var t=this.__proto__,n=e in(this.__proto__=null,this);return this.__proto__=t,n}:(t=n.constructor,m=function(e){var n=(this.constructor||t).prototype;return e in this&&!(e in n&&this[e]===n[e])}),n=null,m.call(this,e)}),v=function(e,t){var n,a,i,o=0;(n=function(){this.valueOf=0}).prototype.valueOf=0,a=new n;for(i in a)m.call(a,i)&&o++;return n=a=null,o?v=2==o?function(e,t){var n,a={},i=y.call(e)==k;for(n in e)i&&"prototype"==n||m.call(a,n)||!(a[n]=1)||!m.call(e,n)||t(n)}:function(e,t){var n,a,i=y.call(e)==k;for(n in e)i&&"prototype"==n||!m.call(e,n)||(a="constructor"===n)||t(n);(a||m.call(e,n="constructor"))&&t(n)}:(a=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],v=function(e,t){var n,i,o=y.call(e)==k,l=!o&&"function"!=typeof e.constructor&&r[s(e.hasOwnProperty)]&&e.hasOwnProperty||m;for(n in e)o&&"prototype"==n||!l.call(e,n)||t(n);for(i=a.length;n=a[--i];l.call(e,n)&&t(n));}),v(e,t)},!a("json-stringify")){var B={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},A="000000",L=function(e,t){return(A+(t||0)).slice(-e)},N="\\u00",P=function(e){for(var t='"',n=0,a=e.length,i=!S||a>10,o=i&&(S?e.split(""):e);a>n;n++){var r=e.charCodeAt(n);switch(r){case 8:case 9:case 10:case 12:case 13:case 34:case 92:t+=B[r];break;default:if(32>r){t+=N+L(2,r.toString(16));break}t+=i?o[n]:e.charAt(n)}}return t+'"'},q=function J(e,t,n,a,i,o,r){var l,u,c,d,p,g,b,_,w,k,S,M,B,A,N,q;try{l=t[e]}catch(D){}if("object"==("undefined"==typeof l?"undefined":s(l))&&l)if(u=y.call(l),u!=x||m.call(l,"toJSON"))"function"==typeof l.toJSON&&(u!=T&&u!=E&&u!=C||m.call(l,"toJSON"))&&(l=l.toJSON(e));else if(l>-1/0&&1/0>l){if(O){for(p=j(l/864e5),c=j(p/365.2425)+1970-1;O(c+1,0)<=p;c++);for(d=j((p-O(c,0))/30.42);O(c,d+1)<=p;d++);p=1+p-O(c,d),g=(l%864e5+864e5)%864e5,b=j(g/36e5)%24,_=j(g/6e4)%60,w=j(g/1e3)%60,k=g%1e3}else c=l.getUTCFullYear(),d=l.getUTCMonth(),p=l.getUTCDate(),b=l.getUTCHours(),_=l.getUTCMinutes(),w=l.getUTCSeconds(),k=l.getUTCMilliseconds();l=(0>=c||c>=1e4?(0>c?"-":"+")+L(6,0>c?-c:c):L(4,c))+"-"+L(2,d+1)+"-"+L(2,p)+"T"+L(2,b)+":"+L(2,_)+":"+L(2,w)+"."+L(3,k)+"Z"}else l=null;if(n&&(l=n.call(t,e,l)),null===l)return"null";if(u=y.call(l),u==I)return""+l;if(u==T)return l>-1/0&&1/0>l?""+l:"null";if(u==E)return P(""+l);if("object"==("undefined"==typeof l?"undefined":s(l))){for(A=r.length;A--;)if(r[A]===l)throw f();if(r.push(l),S=[],N=o,o+=i,u==C){for(B=0,A=l.length;A>B;B++)M=J(B,l,n,a,i,o,r),S.push(M===h?"null":M);q=S.length?i?"[\n"+o+S.join(",\n"+o)+"\n"+N+"]":"["+S.join(",")+"]":"[]"}else v(a||l,function(e){var t=J(e,l,n,a,i,o,r);t!==h&&S.push(P(e)+":"+(i?" ":"")+t)}),q=S.length?i?"{\n"+o+S.join(",\n"+o)+"\n"+N+"}":"{"+S.join(",")+"}":"{}";return r.pop(),q}};t.stringify=function(e,t,n){var a,i,o,l;if(r["undefined"==typeof t?"undefined":s(t)]&&t)if((l=y.call(t))==k)i=t;else if(l==C){o={};for(var u,c=0,d=t.length;d>c;u=t[c++],l=y.call(u),(l==E||l==T)&&(o[u]=1));}if(n)if((l=y.call(n))==T){if((n-=n%1)>0)for(a="",n>10&&(n=10);a.length<n;a+=" ");}else l==E&&(a=n.length<=10?n:n.slice(0,10));return q("",(u={},u[""]=e,u),i,o,a,"",[])}}if(!a("json-parse")){var D,$,H=o.fromCharCode,R={92:"\\",34:'"',47:"/",98:"\b",116:"	",110:"\n",102:"\f",114:"\r"},z=function(){throw D=$=null,d()},U=function(){for(var e,t,n,a,i,o=$,r=o.length;r>D;)switch(i=o.charCodeAt(D)){case 9:case 10:case 13:case 32:D++;break;case 123:case 125:case 91:case 93:case 58:case 44:return e=S?o.charAt(D):o[D],D++,e;case 34:for(e="@",D++;r>D;)if(i=o.charCodeAt(D),32>i)z();else if(92==i)switch(i=o.charCodeAt(++D)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:e+=R[i],D++;break;case 117:for(t=++D,n=D+4;n>D;D++)i=o.charCodeAt(D),i>=48&&57>=i||i>=97&&102>=i||i>=65&&70>=i||z();e+=H("0x"+o.slice(t,D));break;default:z()}else{if(34==i)break;for(i=o.charCodeAt(D),t=D;i>=32&&92!=i&&34!=i;)i=o.charCodeAt(++D);e+=o.slice(t,D)}if(34==o.charCodeAt(D))return D++,e;z();default:if(t=D,45==i&&(a=!0,i=o.charCodeAt(++D)),i>=48&&57>=i){for(48==i&&(i=o.charCodeAt(D+1),i>=48&&57>=i)&&z(),a=!1;r>D&&(i=o.charCodeAt(D),i>=48&&57>=i);D++);if(46==o.charCodeAt(D)){for(n=++D;r>n&&(i=o.charCodeAt(n),i>=48&&57>=i);n++);n==D&&z(),D=n}if(i=o.charCodeAt(D),101==i||69==i){for(i=o.charCodeAt(++D),(43==i||45==i)&&D++,n=D;r>n&&(i=o.charCodeAt(n),i>=48&&57>=i);n++);n==D&&z(),D=n}return+o.slice(t,D)}if(a&&z(),"true"==o.slice(D,D+4))return D+=4,!0;if("false"==o.slice(D,D+5))return D+=5,!1;if("null"==o.slice(D,D+4))return D+=4,null;z()}return"$"},F=function V(e){var t,n;if("$"==e&&z(),"string"==typeof e){if("@"==(S?e.charAt(0):e[0]))return e.slice(1);if("["==e){for(t=[];e=U(),"]"!=e;n||(n=!0))n&&(","==e?(e=U(),"]"==e&&z()):z()),","==e&&z(),t.push(V(e));return t}if("{"==e){for(t={};e=U(),"}"!=e;n||(n=!0))n&&(","==e?(e=U(),"}"==e&&z()):z()),(","==e||"string"!=typeof e||"@"!=(S?e.charAt(0):e[0])||":"!=U())&&z(),t[e.slice(1)]=V(U());return t}z()}return e},Q=function(e,t,n){var a=W(e,t,n);a===h?delete e[t]:e[t]=a},W=function(e,t,n){var a,i=e[t];if("object"==("undefined"==typeof i?"undefined":s(i))&&i)if(y.call(i)==C)for(a=i.length;a--;)Q(i,a,n);else v(i,function(e){Q(i,e,n)});return n.call(e,t,i)};t.parse=function(e,t){var n,a;return D=0,$=""+e,n=F(U()),"$"!=U()&&z(),D=$=null,t&&y.call(t)==k?W((a={},a[""]=n,a),"",t):n}}}return t.runInContext=n,t}var o="function"==typeof e&&e.amd,r={"function":!0,object:!0},l=r["undefined"==typeof i?"undefined":s(i)]&&i&&!i.nodeType&&i,u=r["undefined"==typeof window?"undefined":s(window)]&&window||this,c=l&&r["undefined"==typeof a?"undefined":s(a)]&&a&&!a.nodeType&&"object"==("undefined"==typeof t?"undefined":s(t))&&t;if(!c||c.global!==c&&c.window!==c&&c.self!==c||(u=c),l&&!o)n(u,l);else{var d=u.JSON,f=u.JSON3,p=!1,g=n(u,u.JSON3={noConflict:function(){return p||(p=!0,u.JSON=d,u.JSON3=f,d=f=null),g}});u.JSON={parse:g.parse,stringify:g.stringify}}o&&e(function(){return g})}).call(this)}).call(this,"undefined"!=typeof n?n:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],59:[function(e,t,n){function a(e,t,n){if(!(this instanceof a))return new a(e,t,n);var c,d,f,p,g=l.test(e),m="undefined"==typeof t?"undefined":s(t),v=this,h=0;for("object"!==m&&"string"!==m&&(n=t,t=null),n&&"function"!=typeof n&&(n=r.parse),t=o(t);h<u.length;h++)d=u[h],c=d[0],p=d[1],c!==c?v[p]=e:"string"==typeof c?~(f=e.indexOf(c))&&("number"==typeof d[2]?(v[p]=e.slice(0,f),e=e.slice(f+d[2])):(v[p]=e.slice(f),e=e.slice(0,f))):(f=c.exec(e))&&(v[p]=f[1],e=e.slice(0,e.length-f[0].length)),v[p]=v[p]||(d[3]||"port"===p&&g?t[p]||"":""),d[4]&&(v[p]=v[p].toLowerCase());n&&(v.query=n(v.query)),i(v.port,v.protocol)||(v.host=v.hostname,v.port=""),v.username=v.password="",v.auth&&(d=v.auth.split(":"),v.username=d[0]||"",v.password=d[1]||""),v.href=v.toString()}var i=e("requires-port"),o=e("./lolcation"),r=e("querystringify"),l=/^\/(?!\/)/,u=[["#","hash"],["?","query"],["//","protocol",2,1,1],["/","pathname"],["@","auth",1],[0/0,"host",void 0,1,1],[/\:(\d+)$/,"port"],[0/0,"hostname",void 0,1,1]];a.prototype.set=function(e,t,n){var a=this;return"query"===e?("string"==typeof t&&t.length&&(t=(n||r.parse)(t)),a[e]=t):"port"===e?(a[e]=t,i(t,a.protocol)?t&&(a.host=a.hostname+":"+t):(a.host=a.hostname,a[e]="")):"hostname"===e?(a[e]=t,a.port&&(t+=":"+a.port),a.host=t):"host"===e?(a[e]=t,/\:\d+/.test(t)&&(t=t.split(":"),a.hostname=t[0],a.port=t[1])):a[e]=t,a.href=a.toString(),a},a.prototype.toString=function(e){e&&"function"==typeof e||(e=r.stringify);var t,n=this,a=n.protocol+"//";return n.username&&(a+=n.username,n.password&&(a+=":"+n.password),a+="@"),a+=n.hostname,n.port&&(a+=":"+n.port),a+=n.pathname,t="object"===s(n.query)?e(n.query):n.query,t&&(a+="?"!==t.charAt(0)?"?"+t:t),n.hash&&(a+=n.hash),a},a.qs=r,a.location=o,t.exports=a},{"./lolcation":60,querystringify:61,"requires-port":62}],60:[function(e,t,a){(function(n){var a,i={hash:1,query:1};t.exports=function(t){t=t||n.location||{},a=a||e("./");var o,r={},l="undefined"==typeof t?"undefined":s(t);if("blob:"===t.protocol)r=new a(unescape(t.pathname),{});else if("string"===l){r=new a(t,{});for(o in i)delete r[o]}else if("object"===l)for(o in t)o in i||(r[o]=t[o]);return r}}).call(this,"undefined"!=typeof n?n:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./":59}],61:[function(e,t,n){function a(e){for(var t,n=/([^=?&]+)=([^&]*)/g,a={};t=n.exec(e);a[decodeURIComponent(t[1])]=decodeURIComponent(t[2]));return a}function i(e,t){t=t||"";var n=[];"string"!=typeof t&&(t="?");for(var a in e)o.call(e,a)&&n.push(encodeURIComponent(a)+"="+encodeURIComponent(e[a]));return n.length?t+n.join("&"):""}var o=Object.prototype.hasOwnProperty;n.stringify=i,n.parse=a},{}],62:[function(e,t,n){t.exports=function(e,t){if(t=t.split(":")[0],e=+e,!e)return!1;switch(t){case"http":case"ws":return 80!==e;case"https":case"wss":return 443!==e;case"ftp":return 21!==e;case"gopher":return 70!==e;case"file":return!1}return 0!==e}},{}]},{},[1])(1)})}).call(t,function(){return this}())},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(4),o=a(i);t["default"]=function(e){return o["default"].msgId.indexOf(e)<0?(o["default"].msgId.length>200&&(o["default"].msgId=[]),o["default"].msgId.push(e),!1):!0}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}function i(e){for(var t=0;t<e.length;++t)for(var n=t+1;n<e.length;++n)e[t].id===e[n].id&&e.splice(n--,1);return e}Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),r=a(o);t["default"]=function(e,t){try{var n=window.localStorage,a="unreadMsg-"+r["default"].entId+"-"+r["default"].trackId;if("get"===e)return n.getItem(a);if("set"===e){var o=n.getItem(a);o?(o=JSON.parse(o),t=JSON.parse(t),o=JSON.stringify(i(o.concat(t)))):o=t,n.setItem(a,o)}else"remove"===e&&n.removeItem(a)}catch(s){return null}}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(4),o=a(i);t["default"]=function(e,t){try{var n=window.localStorage,a="unsentMsg-"+o["default"].entId+"-"+o["default"].trackId;if("get"===e)return n.getItem(a);if("set"===e)return n.setItem(a,t),!0;if("remove"===e)return n.removeItem(a),!0}catch(i){return!1}}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(4),o=a(i);t["default"]=function(e,t){var n=o["default"].tpl(e,{intro:t.intro});document.getElementById("evaluationHolder").innerHTML=n}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),o=a(i),r=n(21),s=a(r),l=n(16),u=a(l),c=n(9),d=a(c),f=n(74),p=a(f),g=n(75),m=a(g),v=n(27),h=a(v),b=n(11),y=a(b),_=n(4),w=a(_),k=n(76),x=a(k),T=n(13),E=a(T),C=n(22),I=a(C),S=n(20),j=a(S),M=n(77),O=a(M),B=n(32),A=a(B),L=n(78),N=a(L);t["default"]=function(){w["default"].surveyRendered=!0;var e=function(e){var t=d["default"].get("MEIQIA_HAS_SUBMITTED_FORM"),n=!1;if(t){for(var a=e.form_def.inputs.fields,i=0,o=0;o<a.length;o++)a[o].ignore_returned_customer&&(a[o].ignore=!0,i++);if(i===a.length&&(n=!0),!w["default"].convId&&!w["default"].scheduler&&"close"===e.form_def.menus.status&&n){if(!w["default"].initData.scheduler_after_client_send_msg)return x["default"]("pageChat"),A["default"](),!1;N["default"]()}}var r=w["default"].tpl("survey",e.form_def);document.getElementById("surveyBody").innerHTML=r,"open"===e.form_def.menus.status&&p["default"]("surveyMenus","click",function(t){var a=t.target.title,i=t.target.id.split("_")[0],o=t.target.id.split("_")[1];"agent"===i&&(w["default"].agentToken=w["default"].assignedAgentToken=o),"group"===i&&(w["default"].groupToken=w["default"].assignedGroupToken=o,w["default"].agentToken=w["default"].assignedAgentToken=null);var r=1*new Date;w["default"].agentSchedulingMsg={id:r,content_type:"text",content:a},"open"!==e.form_def.inputs.status||n?w["default"].initData.scheduler_after_client_send_msg?N["default"]():(x["default"]("pageChat"),A["default"]()):(w["default"].menusResult=a,E["default"].removeClass(document.getElementById("surveyStep1"),"active"),E["default"].addClass(document.getElementById("surveyStep2"),"active"))}),"open"===e.form_def.inputs.status&&!function(){var t=function(){var t=n();if(t)if(e.form_def.captcha){var a=document.getElementById("surveyCaptcha").value;a?O["default"](t,{"Captcha-Value":a,"Captcha-Token":w["default"].surveyCaptchaToken}):I["default"](s["default"][w["default"].language].enterVerification,5e3)}else O["default"](t)};e.form_def.captcha&&(j["default"]("surveyCaptchaImg","surveyCaptchaToken"),document.getElementById("surveyCaptchaImg").addEventListener("click",function(){j["default"]("surveyCaptchaImg","surveyCaptchaToken")}),document.getElementById("surveyCaptcha").addEventListener("keydown",function(e){var n=e.which||e.keyCode;return 13===n?(t(),e.preventDefault&&e.preventDefault(),!1):void 0}));var n=function(){for(var t={},n=e.form_def.inputs.fields,a=0;a<n.length;a++)if(!n[a].ignore){var i=n[a].field_name,o=n[a].display_name,r="";r="en"===w["default"].language?n[a].field_name:n[a].display_name;var l=void 0;switch(n[a].type){case"text":if(l=document.getElementsByName(i)[0].value){if(!(l.length>0&&l.length<=100))return I["default"](s["default"][w["default"].language].PleaseControl+"「"+r+"」"+s["default"][w["default"].language].characters,5e3),!1;t[i]=l||null}else if(!n[a].optional)return I["default"](s["default"][w["default"].language].required+"「"+r+"」",5e3),!1;break;case"single_choice":if(l=h["default"](i))t[o]=l[0];else if(!n[a].optional)return I["default"](s["default"][w["default"].language].choose+"「"+r+"」",5e3),!1;break;case"multiple_choice":if(l=h["default"](i))t[o]=l;else if(!n[a].optional)return I["default"](s["default"][w["default"].language].choose+"「"+r+"」",5e3),!1}}return t};document.getElementById("surveySubmit").addEventListener("click",function(){w["default"].initData.scheduler_after_client_send_msg?t():E["default"].hasClass(document.getElementById("surveySubmit"),"disabled")||t()});var a=m["default"]("survey-input-text");if(a&&a.length>0)for(var i=0;i<a.length;i++)a[i].addEventListener("keydown",function(e){var n=e.which||e.keyCode;return 13===n?(t(),e.preventDefault&&e.preventDefault(),!1):void 0}),!y["default"].isMobile()&&y["default"].isSafari()&&a[i].addEventListener("click",function(e){e.target.focus()})}()};u["default"].ajax({url:o["default"].chat+"/client/forms",data:{ent_id:w["default"].entId},type:"get",success:function(t){e(t)},error:function(e){var t={};try{t=JSON.parse(e.responseText)}catch(n){}I["default"](t.message||s["default"][w["default"].language].queryForm,3e3)}})}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e,t,n){var a=document.getElementsByName(e);if(a.length)for(var i=0;i<a.length;i++)a[i].addEventListener(t,n)}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e,t,n){if(document.getElementsByClassName){var a=(t||document).getElementsByClassName(e),i=[];if(n&&"*"!==n)for(var o=0;o<a.length;o++)a[o].tagName===n.toUpperCase()&&i.push(a[o]);else i=a;return i}t=t||document,n=n||"*";for(var r=e.split(" "),s="*"===n&&t.all?t.all:t.getElementsByTagName(n),l=[],u=void 0,c=void 0,d=[],f=r.length;--f>=0;)l.push(new RegExp("(^|\\s)"+r[f]+"(\\s|$)"));for(var p=s.length;--p>=0;){u=s[p],c=!1;for(var g=0,m=l.length;m>g&&(c=l[g].test(u.className),c);g++);c&&d.push(u)}return d}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(24),o=a(i),r=n(34),s=a(r);t["default"]=function(e){for(var t=["pageChat","pageTicket","pageCall","pageSurvey"],n=0;n<t.length;n++)o["default"](document.getElementById(t[n]),t[n]===e?"show":"hide");var a=document.getElementById("evaluationMask");a&&o["default"](a,"hide"),s["default"]()}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),o=a(i),r=n(21),s=a(r),l=n(16),u=a(l),c=n(9),d=a(c),f=n(13),p=a(f),g=n(4),m=a(g),v=n(22),h=a(v),b=n(32),y=a(b),_=n(76),w=a(_),k=n(78),x=a(k);t["default"]=function(e,t){var n=document.getElementById("surveySubmit");u["default"].ajax({url:o["default"].chat+"/client/forms",type:"post",dataType:"json",contentType:"application/json",header:t,data:{ent_id:m["default"].entId,track_id:m["default"].trackId,data:e},beforeSend:function(){p["default"].addClass(n,"disabled")},success:function(){m["default"].initData.scheduler_after_client_send_msg?x["default"]():(w["default"]("pageChat"),y["default"]()),d["default"].set("MEIQIA_HAS_SUBMITTED_FORM","TRUE",{expires:1/0})},error:function(e){var t={};try{t=JSON.parse(e.responseText)}catch(a){}h["default"](t.message||s["default"][m["default"].language].FailedSubmit,3e3),p["default"].removeClass(n,"disabled")}})}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(4),o=a(i),r=n(76),s=a(r),l=n(33),u=a(l),c=n(35),d=a(c);t["default"]=function(){if(o["default"].initData.enterprise_info.avatar=o["default"].initData.enterprise_info.avatar||"https://s3-qcloud.meiqia.com/static-files/default-avatar.jpg","mondeo"===o["default"].style||"fusion"===o["default"].style){var e="header-"+o["default"].style;u["default"](e,"headLeft",{name:o["default"].initData.enterprise_info.public_nickname,signature:o["default"].initData.enterprise_info.public_signature}),u["default"]("profile","profile",{avatar:o["default"].initData.enterprise_info.avatar,name:o["default"].initData.enterprise_info.public_nickname,tel:o["default"].initData.enterprise_info.public_telephone,cellphone:o["default"].initData.enterprise_info.public_cellphone,email:o["default"].initData.enterprise_info.public_email,qq:o["default"].initData.enterprise_info.public_qq,weixin:o["default"].initData.enterprise_info.public_weixin})}else if("customer"===o["default"].style){var t="standalone"===o["default"].type?o["default"].initData.standalone_window_config.desktop:o["default"].initData.widget_settings.desktop.panel;u["default"]("header-customer","headLeft",{photoType:t.customer_photo_type,avatar:o["default"].initData.enterprise_info.avatar,name:o["default"].initData.enterprise_info.public_nickname,signature:o["default"].initData.enterprise_info.public_signature}),u["default"]("profile-customer","profile",{name:o["default"].initData.enterprise_info.public_nickname,photoType:t.customer_photo_type,avatar:o["default"].initData.enterprise_info.avatar,content:t.customer_content,bgColor:t.theme[2]})}else u["default"]("header","headLeft",{avatar:o["default"].initData.enterprise_info.avatar,name:o["default"].initData.enterprise_info.public_nickname,signature:o["default"].initData.enterprise_info.public_signature});if(o["default"].initData.ent_welcome_message&&!o["default"].msgHolderFlag){o["default"].msgHolderFlag=!0;var n=1*new Date;d["default"]([{id:n,from_type:"agent",content_type:"text",content:o["default"].initData.ent_welcome_message,type:"message",agent:{nickname:"",avatar:o["default"].initData.enterprise_info.avatar}}])}s["default"]("pageChat")}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(9),o=a(i),r=n(24),s=a(r),l=n(10),u=(a(l),n(13)),c=a(u),d=n(21),f=a(d),p=n(4),g=a(p),m=n(62),v=a(m),h=n(59),b=a(h),y=n(33),_=a(y),w=n(35),k=a(w),x=n(70),T=a(x),E=n(58),C=a(E),I=n(63),S=a(I),j=n(80),M=a(j),O=n(82),B=a(O),A=n(83),L=a(A),N=n(65),P=a(N),q=n(57),D=a(q),$=n(60),H=a($),R=n(66),z=a(R);t["default"]=function(e){var t="";switch(e.action){case"message":g["default"].isBasic||b["default"]("visible"===o["default"].get("MEIQIA_PANEL_VISIBILITY")?"newMessage":"newChat"),g["default"].lastMsgDate=e.created_on,/^(text|welcome|photo|file|bot|rich_text)$/.test(e.content_type)&&(t=[e]),k["default"](t,"normal"),z["default"](t),g["default"].convId&&!g["default"].isStandalone&&g["default"].initData.widget_settings.desktop.pop&&g["default"].messenger.targets.parent.send("showPanel^@#"),g["default"].messenger.targets.parent.send("newMsg^@#"+JSON.stringify(t)),"redirect"===e.sub_type&&L["default"](),/queueing|manual_redirect/.test(e.sub_type)&&B["default"]("很抱歉没能理解您的提问"),"reply"===e.sub_type&&M["default"]();break;case"end_conv_timeout":case"end_conv_agent":case"end_conv_client":g["default"].isEnd=!0,T["default"]("remove"),g["default"].blacklist||(b["default"]("newChat"),v["default"](),document.activeElement.blur(),document.getElementById("textarea").blur(),g["default"].messenger.targets.parent.send("conversation^@#no"),e.body.evaluation&&(s["default"](document.getElementById("evaluationHolder"),"show"),s["default"](document.getElementById("evaluationMask"),"show")));break;case"agent_visit_inviting":g["default"].convId||g["default"].messenger.targets.parent.send("inviting^@#"+e.body.token);break;case"agent_redirect":case"timeout_redirect":g["default"].isBot=!1,b["default"]("newChat");var n={id:1*new Date,from_type:"redirect",toNickname:e.body.to.nickname};if(k["default"]([n]),g["default"].agent=e.body.to,g["default"].agentToken=e.body.to.token,g["default"].convId=e.body.conversation_id,"mondeo"===g["default"].style)_["default"]("header-mondeo","headLeft",{name:e.body.to.nickname,signature:e.body.to.signature}),_["default"]("profile","profile",{avatar:e.body.to.avatar,name:e.body.to.nickname,tel:e.body.to.telephone,cellphone:e.body.to.public_cellphone,email:e.body.to.public_email,qq:e.body.to.qq,weixin:e.body.to.weixin});else if("customer"===g["default"].style){var a=g["default"].initData.widget_settings.desktop.panel;_["default"]("header-customer","headLeft",{photoType:a.customer_photo_type,avatar:e.body.to.avatar,name:e.body.to.nickname,signature:e.body.to.signature}),_["default"]("profile-customer","profile",{
name:e.body.to.nickname,photoType:a.customer_photo_type,avatar:e.body.to.avatar,content:a.customer_content,bgColor:a.theme[2]})}else _["default"]("header","headLeft",{avatar:e.body.to.avatar,name:e.body.to.nickname,signature:e.body.to.signature});P["default"]("bot"===e.body.to.privilege);break;case"agent_inputting":g["default"].initData.servability&&!function(){clearTimeout(window.AGENT_INPUTTING);var e=document.getElementById("agentInputting");s["default"](e,"show"),window.AGENT_INPUTTING=setTimeout(function(){s["default"](e,"hide")},4e3)}();break;case"invite_evaluation":b["default"]("newChat"),s["default"](document.getElementById("evaluationHolder"),"show"),s["default"](document.getElementById("evaluationMask"),"show");break;case"visit_black_add":b["default"]("newChat"),g["default"].blacklist=!0,g["default"].isEnd&&c["default"].addClass(document.getElementById("chatHasEnd"),"hide"),document.getElementById("blacklistTips").innerHTML=f["default"][g["default"].language].serviceUnavailable,c["default"].removeClass(document.getElementById("blacklistTips"),"hide"),document.activeElement.blur(),document.getElementById("textarea").blur();break;case"visit_black_del":b["default"]("newChat"),g["default"].blacklist=!1,c["default"].addClass(document.getElementById("blacklistTips"),"hide"),g["default"].isEnd&&(v["default"](),document.activeElement.blur(),document.getElementById("textarea").blur());break;case"init_conv":if(g["default"].scheduler=!0,g["default"].messenger.targets.parent.send("conversation^@#yes"),g["default"].convId=e.body.id,g["default"].agentToken=e.body.agent.token,g["default"].agent=e.body.agent,g["default"].isBasic||b["default"]("newChat"),"mondeo"===g["default"].style)_["default"]("header-"+g["default"].style,"headLeft",{name:e.body.agent.nickname,signature:e.body.agent.signature}),_["default"]("profile","profile",{avatar:e.body.agent.avatar,name:e.body.agent.nickname,tel:e.body.agent.telephone,cellphone:e.body.agent.public_cellphone,email:e.body.agent.public_email,qq:e.body.agent.qq,weixin:e.body.agent.weixin});else if("customer"===g["default"].style){var i=g["default"].initData.widget_settings.desktop.panel;_["default"]("header-customer","headLeft",{photoType:i.customer_photo_type,avatar:e.body.agent.avatar,name:e.body.agent.nickname,signature:e.body.agent.signature}),_["default"]("profile-customer","profile",{name:e.body.agent.nickname,photoType:i.customer_photo_type,avatar:e.body.agent.avatar,content:i.customer_content,bgColor:i.theme[2]})}else _["default"]("header","headLeft",{avatar:e.body.agent.avatar,name:e.body.agent.nickname,signature:e.body.agent.signature});D["default"](!0,H["default"]),P["default"]("bot"===e.body.agent.privilege),C["default"]("hide"),S["default"]("hide"),g["default"].initData.in_queue=!1}}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}function i(e){var t=l["default"](e||f["default"][c["default"].language].understand+' <a role="reply" href="javascript:;;">'+f["default"][c["default"].language].message+"</a>");if(!t)return!1;var n=t.getElementsByTagName("a")[0];n&&n.addEventListener("click",function(e){e.preventDefault(),r["default"](document.getElementById("pageChat"),"hide"),r["default"](document.getElementById("pageTicket"),"show")})}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=i;var o=n(24),r=a(o),s=n(81),l=a(s),u=n(4),c=a(u),d=n(21),f=a(d)},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e){if(!e)return!1;var t=document.createElement("div");return t.className="msg-common-tips",t.innerHTML=e,document.getElementById("msgHolder").appendChild(t),o["default"]("msgWrapper"),t};var i=n(10),o=a(i)},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}function i(e){var t=document.getElementById("msgHolder").lastChild;if(!t)return!1;var n=t.getElementsByTagName("a")[0];if(n&&"redirect"===n.getAttribute("role"))return!1;var a=r["default"]('<a role="redirect" href="javascript:;;">'+f["default"][c["default"].language].TurnArtificial+" </a>");if(!a)return!1;var i=a.getElementsByTagName("a")[0];i&&i.addEventListener("click",function(e){e.preventDefault(),l["default"]()})}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=i;var o=n(81),r=a(o),s=n(83),l=a(s),u=n(4),c=a(u),d=n(21),f=a(d)},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(){m["default"](document.getElementById("btnCallAgent"),"hide");var e="redirect-to-agent-tip";if(document.getElementById(e))return!1;var t=d["default"](o["default"][s["default"].language].WaitingTransfer);t.id=e,p["default"].addClass(document.getElementById("chatHasEnd"),"hide"),setTimeout(function(){var e={exclude_agent_tokens:[s["default"].agentToken]};s["default"].assignedAgentToken?e.agentToken=s["default"].assignedAgentToken:s["default"].assignedGroupToken&&(e.groupToken=s["default"].assignedGroupToken),u["default"](e,!0)},2e3)};var i=n(21),o=a(i),r=n(4),s=a(r),l=n(32),u=a(l),c=n(81),d=a(c),f=n(13),p=a(f),g=n(24),m=a(g)},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),o=a(i),r=n(21),s=a(r),l=n(9),u=a(l),c=n(13),d=a(c),f=n(85),p=a(f),g=n(24),m=a(g),v=n(10),h=a(v),b=n(26),y=a(b),_=n(74),w=a(_),k=n(25),x=a(k),T=n(3),E=a(T),C=n(86),I=a(C),S=n(87),j=a(S),M=n(4),O=a(M),B=n(61),A=a(B),L=n(88),N=a(L),P=n(89),q=a(P),D=n(22),$=a(D),H=n(90),R=a(H),z=n(31),U=a(z),F=n(35),Q=a(F),W=n(92),J=a(W),V=n(32),G=a(V),X=n(71),Z=a(X),K=n(94),Y=a(K),ee=n(95),te=a(ee),ne=n(96),ae=a(ne),ie=n(99),oe=a(ie),re=n(100),se=a(re),le=n(83),ue=a(le),ce=n(101),de=a(ce),fe=n(20),pe=a(fe),ge=n(76),me=a(ge),ve=n(102),he=a(ve);t["default"]=function(){window.FormData&&"undefined"!=typeof XMLHttpRequest&&"undefined"!=typeof FileReader&&(O["default"].features.photo=!0,O["default"].features.upload=!0),document.getElementById("featureBtns").innerHTML="en"===O["default"].language?I["default"]("features",O["default"].features):"zh-tw"===O["default"].language?j["default"]("features",O["default"].features):E["default"]("features",O["default"].features),O["default"].features.photo&&!function(){var e=document.getElementById("photoFile");e.addEventListener("click",function(e){O["default"].socket||(e.preventDefault(),$["default"]("服务连接中，请稍候…",5e3))}),e.addEventListener("change",function(){if(m["default"](document.getElementById("emojiHolder"),"hide"),e.value){var t=e.value.split(".");if(t=t[t.length-1].toLowerCase(),"png"===t||"jpg"===t||"jpeg"===t||"gif"===t){var n={id:1*new Date,from_type:"client",content_type:"photo",status:"sending",media_url:o["default"].cdn+"/images/photo-sending.png",file:e.files[0]};Q["default"]([n]),R["default"](n)}else $["default"](s["default"][O["default"].language].onlyPictures+"（png/jpg/jpeg/gif）",5e3)}}),Y["default"](document.getElementById("textarea"))}(),O["default"].features.upload&&!function(){var e=document.getElementById("uploadFile");e.addEventListener("click",function(e){O["default"].socket||(e.preventDefault(),$["default"]("服务连接中，请稍候…",5e3))}),e.addEventListener("change",function(){if(e.value){var t=e.files[0];if(t.size>5e7)$["default"](s["default"][O["default"].language].sendLess,5e3);else{var n={id:1*new Date,from_type:"client",content_type:"file",status:"sending",file:t,uploading:!0,extra:{filename:t.name,size:t.size,type:t.type}};Q["default"]([n]),ae["default"](n)}}})}(),document.getElementById("emojiHolder").innerHTML=E["default"]("emoji",{list:O["default"].emojiGroup}),w["default"]("btnHidePanel","click",function(){O["default"].messenger.targets.parent.send("hidePanel^@#true")}),document.getElementById("btnSend").addEventListener("click",function(){J["default"](),he["default"].remove()}),document.getElementById("textarea").addEventListener("keyup",function(e){var t=document.getElementById("textarea"),n=t.value.trim();n.length>2048&&(t.value=n.substr(0,2048),$["default"](s["default"][O["default"].language].upToOnly,5e3)),N["default"](n),Z["default"]("set",n);var a=e.which||e.keyCode;38!==a&&40!==a&&he["default"].search(n)}),document.getElementById("textarea").addEventListener("keydown",function(e){var t=e.which||e.keyCode;return 13===t?(J["default"](),he["default"].remove(),e.preventDefault&&e.preventDefault(),!1):void(38==t?he["default"].select("prev"):40==t&&he["default"].select("next"))}),document.getElementById("textarea").addEventListener("focus",function(){var e=function t(){clearTimeout(window._TEXTAREA_FOCUS_TIMEOUT),q["default"](document.getElementById("textarea").value.trim()),window._TEXTAREA_FOCUS_TIMEOUT=setTimeout(function(){t()},350)};e()}),document.getElementById("textarea").addEventListener("blur",function(){clearTimeout(window._TEXTAREA_FOCUS_TIMEOUT),setTimeout(function(){he["default"].remove()},300)}),document.getElementById("emojiBtn").addEventListener("click",function(){m["default"](document.getElementById("emojiHolder"))}),window.CHOSE_EMOJI=function(e){m["default"](document.getElementById("emojiHolder"),"hide"),p["default"]("textarea",e);var t=document.getElementById("textarea"),n=t.value.trim();n.length>2048&&(t.value=n.substr(0,2048),$["default"](s["default"][O["default"].language].upToOnly,5e3)),N["default"](n),Z["default"]("set",n)},document.getElementById("msgHolder").addEventListener("click",function(e){if(d["default"].hasClass(e.target,"status-fail")||d["default"].hasClass(e.target,"photo-send-fail")){var t=O["default"].loserClub[e.target.id];t&&A["default"](t)}else if(d["default"].hasClass(e.target,"photo-upload-fail")){var n=O["default"].loserClub[e.target.id];n&&R["default"](n)}else if(d["default"].hasClass(e.target,"btn-download")||d["default"].hasClass(e.target.parentNode,"btn-download")){var a=e.target.name||e.target.parentNode.name;a=a.split(",");var i=+a[0],o=+a[1];oe["default"](i,o)}});var e=!0;document.getElementById("msgHolder").addEventListener("click",function(t){if(d["default"].hasClass(t.target,"menu-item")){var n=t.target.innerHTML.trim().replace(/^\d+\.\s+/,"");n&&e&&(e=!1,setTimeout(function(){e=!0},500),document.getElementById("textarea").value=n,J["default"]())}d["default"].hasClass(t.target,"option")&&se["default"](t.target)}),document.getElementById("ticketAgain").addEventListener("click",function(){document.getElementById("ticketContent").value="",m["default"](document.getElementById("ticketSuccess"),"hide"),m["default"](document.getElementById("ticketForm"),"show")}),document.getElementById("chatHasEnd").addEventListener("click",function(e){"btn-restart-chat"===e.target.className&&(O["default"].convType="newConv",G["default"](),d["default"].addClass(document.getElementById("chatHasEnd"),"hide")),"btn-go-ticket"===e.target.className&&me["default"]("pageTicket")}),document.getElementById("unableService").addEventListener("click",function(e){"btn-go-ticket"===e.target.className&&me["default"]("pageTicket")}),document.getElementById("queueingTips").addEventListener("click",function(e){"btn-go-ticket"===e.target.className&&me["default"]("pageTicket")}),window.SCROLL_TO_LAST=function(){h["default"]("msgWrapper")},O["default"].isBasic||document.getElementById("btnRing").addEventListener("click",function(){O["default"].ring="open"===O["default"].ring?"close":"open",U["default"](O["default"].ring),u["default"].set("MEIQIA_RING",O["default"].ring,{expires:1/0})});var t=document.getElementById("btnCallAgent");t&&t.addEventListener("click",ue["default"]),document.getElementById("evaluationBtn").addEventListener("click",function(){m["default"](document.getElementById("evaluationHolder")),m["default"](document.getElementById("evaluationMask"))}),document.getElementById("evaluationHolder").addEventListener("click",function(e){if(("evaluationHide"===e.target.id||"evaluationHide"===e.target.parentNode.id)&&(m["default"](document.getElementById("evaluationHolder"),"hide"),m["default"](document.getElementById("evaluationMask"),"hide")),("evaluation2"===e.target.id||"evaluation2"===e.target.parentNode.id)&&te["default"].select(2),("evaluation1"===e.target.id||"evaluation1"===e.target.parentNode.id)&&te["default"].select(1),("evaluation0"===e.target.id||"evaluation0"===e.target.parentNode.id)&&te["default"].select(0),"evaluationSubmit"===e.target.id){var t=document.getElementById("evaluationLevel").value,n=document.getElementById("evaluationContent").value.trim();if(""===t)return $["default"](s["default"][O["default"].language].selectRating,5e3),!1;if(n.length>30)return $["default"](s["default"][O["default"].language].upToCharacters,5e3),y["default"](document.getElementById("evaluationContent"),30,n.length),!1;te["default"].submit(+t,n)}}),document.getElementById("captchaImg").addEventListener("click",function(){pe["default"]("captchaImg","callCaptchaToken")});var n=document.getElementById("callTel"),a=document.getElementById("callCaptcha"),i=document.getElementById("callTelGroup"),r=document.getElementById("captchaGroup"),l=document.getElementById("submitCall");n.addEventListener("keyup",function(){n.value?(d["default"].addClass(i,"input-active"),d["default"].hasClass(r,"hide")?x["default"].isPhoneNum(n.value)?d["default"].addClass(l,"submit-active"):d["default"].removeClass(l,"submit-active"):a.value?d["default"].addClass(l,"submit-active"):d["default"].removeClass(l,"submit-active")):(d["default"].removeClass(i,"input-active"),d["default"].removeClass(l,"submit-active"))}),a.addEventListener("keyup",function(){d["default"].hasClass(r,"hide")||(a.value?(d["default"].addClass(r,"input-active"),x["default"].isPhoneNum(n.value)?d["default"].addClass(l,"submit-active"):d["default"].removeClass(l,"submit-active")):(d["default"].removeClass(r,"input-active"),d["default"].removeClass(l,"submit-active")))}),document.getElementById("submitCall").addEventListener("click",function(){de["default"]()})}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(11),o=a(i);t["default"]=function(e,t){var n=document.getElementById(e),a=n.scrollTop;if(document.selection)if(o["default"].isIE(6)||o["default"].isIE(7)||o["default"].isIE(8)||o["default"].isIE(9))n.focus(),n.value+=t;else{n.focus();var i=document.selection.createRange();i.text=t,i.moveStart("character",-n.value.length),i.moveStart("character",i.text.length+t.length),i.moveEnd("character",0)}else if(n.selectionStart||"0"==n.selectionStart){var r=n.selectionStart,s=n.selectionEnd;n.value=n.value.substring(0,r)+t+n.value.substring(s,n.value.length),n.selectionStart=r+t.length,n.selectionEnd=r+t.length,n.focus()}else n.focus(),n.value+=t;n.scrollTop=a}},function(e,t,n){var a,i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function o(e,t){return(/string|function/.test("undefined"==typeof t?"undefined":i(t))?f:d)(e,t)}function r(e,t){return"string"!=typeof e&&(t="undefined"==typeof e?"undefined":i(e),"number"===t?e+="":e="function"===t?r(e.call(e)):""),e}function s(e){return v[e]}function l(e){return r(e).replace(/&(?![\w#]+;)|[<>"']/g,s)}function u(e,t){if(h(e))for(var n=0,a=e.length;a>n;n++)t.call(e,e[n],n,e);else for(n in e)t.call(e,e[n],n)}function c(e,t){var n=/(\/)[^\/]+\1\.\.\1/,a=("./"+e).replace(/[^\/]+$/,""),i=a+t;for(i=i.replace(/\/\.\//g,"/");i.match(n);)i=i.replace(n,"/");return i}function d(e,t){var n=o.get(e)||p({filename:e,name:"Render Error",message:"Template not found"});return t?n(t):n}function f(e,t){if("string"==typeof t){var n=t;t=function(){return new m(n)}}var a=g[e]=function(n){try{return new t(n,e)+""}catch(a){return p(a)()}};return a.prototype=t.prototype=b,a.toString=function(){return t+""},a}function p(e){var t="{Template Error}",n=e.stack||"";if(n)n=n.split("\n").slice(0,2).join("\n");else for(var a in e)n+="<"+a+">\n"+e[a]+"\n\n";return function(){return"object"==("undefined"==typeof console?"undefined":i(console))&&console.error(t+"\n\n"+n),t}}var g=o.cache={},m=this.String,v={"<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","&":"&#38;"},h=Array.isArray||function(e){return"[object Array]"==={}.toString.call(e)},b=o.utils={$helpers:{},$include:function(e,t,n){return e=c(n,e),d(e,t)},$string:r,$escape:l,$each:u},y=o.helpers=b.$helpers;o.get=function(e){return g[e.replace(/^\.\//,"")]},o.helper=function(e,t){y[e]=t},a=function(){return o}.call(t,n,t,e),!(void 0!==a&&(e.exports=a)),o("audio",function(e){"use strict";var t=this,n=(t.$helpers,t.$escape),a=e.cdn,i="";return i+='<audio id="newChat" preload="preload"> <source src="',i+=n(a),i+='/audio/new-chat.ogg" type="audio/ogg" /> <source src="',i+=n(a),i+='/audio/new-chat.mp3" type="audio/mpeg" /> </audio> <audio id="newMessage" preload="preload"> <source src="',i+=n(a),i+='/audio/new-message.ogg" type="audio/ogg" /> <source src="',i+=n(a),i+='/audio/new-message.mp3" type="audio/mpeg" /> </audio> <audio id="sentMessage" preload="preload"> <source src="',i+=n(a),i+='/audio/sent-message.ogg" type="audio/ogg" /> <source src="',i+=n(a),i+='/audio/sent-message.mp3" type="audio/mpeg" /> </audio>',new m(i)}),o("chat-has-end",'Conversation has ended<a class="btn-restart-chat">conversation</a>or<a class="btn-go-ticket">message</a>'),o("emoji",function(e){"use strict";var t=this,n=(t.$helpers,t.$each),a=e.list,i=(e.v,e.k,t.$escape),o="";return n(a,function(e){o+=' <i class="emoji-control emoji-',o+=i(e),o+='" onclick="window.CHOSE_EMOJI(\':',o+=i(e),o+=":')\"></i> "}),o+=' <div class="clearfix"></div>',new m(o)}),o("evaluation-basic",function(e){"use strict";var t=this,n=(t.$helpers,t.$escape),a=e.intro,i="";return i+='<div class="evaluation-header"> <a id="evaluationHide"> <i class="icon icon-times"></i> </a> <div class="intro">',i+=n(a),i+='</div> </div> <div class="evaluation-body"> <div class="evaluation-btn-group"> <input id="evaluationLevel" type="hidden" /> <div id="evaluation2" class="evaluation-btn"> <i class="icon icon-smile"></i> <span>Very satisfied</span> </div> <div id="evaluation1" class="evaluation-btn"> <i class="icon icon-neutral"></i> <span>Normal</span> </div> <div id="evaluation0" class="evaluation-btn"> <i class="icon icon-angry"></i> <span>Dissatisfied</span> </div> </div> <div class="evaluation-reason"> <label for="evaluationContent">Please fill in the evaluation(selectivity)</label> <textarea id="evaluationContent"></textarea> <button id="evaluationSubmit">Submit</button> </div> </div> ',new m(i)}),o("evaluation",function(e){"use strict";var t=this,n=(t.$helpers,t.$escape),a=e.intro,i="";return i+='<div class="evaluation-header"> <a id="evaluationHide"> <i class="icon icon-times"></i> </a> <div class="intro">',i+=n(a),i+='</div> </div> <div class="evaluation-body"> <div class="evaluation-btn-group"> <input id="evaluationLevel" type="hidden" /> <div id="evaluation2" class="evaluation-btn"> <i class="icon icon-smile"></i> <span>satisfied</span> </div> <div id="evaluation1" class="evaluation-btn"> <i class="icon icon-neutral"></i> <span>Normal</span> </div> <div id="evaluation0" class="evaluation-btn"> <i class="icon icon-angry"></i> <span>Dissatisfied</span> </div> </div> <div class="evaluation-reason"> <textarea id="evaluationContent" placeholder="Please fill in the evaluation(selectivity)"></textarea> <button id="evaluationSubmit">Submit</button> </div> </div> ',new m(i)}),o("features",function(e){"use strict";var t=this,n=(t.$helpers,e.emoji),a=e.photo,i=e.upload,o=e.evaluation,r="";return n&&(r+=' <a id="emojiBtn" class="feature-btn" title="Emoji"> <i class="icon icon-emoji"></i> </a> '),r+=" ",a&&(r+=' <label id="photoBtn" class="feature-btn" title="Picture"> <i class="icon icon-photo"></i> <input id="photoFile" type="file" accept="image/gif, image/jpeg, image/jpg, image/png"> </label> '),r+=" ",i&&(r+=' <label id="uploadBtn" class="feature-btn" title="File"> <i class="icon icon-upload"></i> <input id="uploadFile" type="file"> </label> '),r+=" ",o&&(r+=' <a id="evaluationBtn" class="feature-btn" title="Service evaluation"> <i class="icon icon-evaluation"></i> </a> '),new m(r)}),o("header-customer",function(e){"use strict";var t=this,n=(t.$helpers,e.photoType),a=t.$escape,i=e.avatar,o=e.signature,r=e.name,s="";return"small"===n&&(s+=' <img class="agent-avatar" src="',s+=a(i),s+='" alt="avatar"> '),s+=" ",s+="small"===n?' <div class="agent-info" style="margin-left: 54px"> ':' <div class="agent-info"> ',s+=' <div class="agent-name ',o||(s+="without-signature"),s+='"> ',s+=a(r),s+=' <span id="agentInputting">The other party enters the message...</span> </div> <div class="agent-signature" title="',s+=a(o),s+='">',s+=a(o),s+="</div> </div> ",new m(s)}),o("header-fusion",function(e){"use strict";var t=this,n=(t.$helpers,e.signature),a=t.$escape,i=e.name,o="";return o+='<div class="agent-info"> <div class="agent-name ',n||(o+="without-signature"),o+='"> ',o+=a(i),o+=' <span id="agentInputting">The other party enters the message...</span> </div> <div class="agent-signature" title="',o+=a(n),o+='">',o+=a(n),o+="</div> </div>",new m(o)}),o("header-loading",'<div id="loading"> connecting<span class="dot1">.</span><span class="dot2">.</span><span class="dot3">.</span> </div>'),o("header-mondeo",function(e){"use strict";var t=this,n=(t.$helpers,e.signature),a=t.$escape,i=e.name,o="";return o+='<div class="agent-info"> <div class="agent-name ',n||(o+="without-signature"),o+='"> ',o+=a(i),o+=' <span id="agentInputting">The other party enters the message...</span> </div> <div class="agent-signature" title="',o+=a(n),o+='">',o+=a(n),o+="</div> </div>",new m(o)}),o("header",function(e){"use strict";var t=this,n=(t.$helpers,t.$escape),a=e.avatar,i=e.signature,o=e.name,r="";return r+='<img class="agent-avatar" src="',r+=n(a),r+='" alt="avatar"> <div class="agent-info"> <div class="agent-name ',i||(r+="without-signature"),r+='"> ',r+=n(o),r+=' <span id="agentInputting">The other party enters the message...</span> </div> <div class="agent-signature" title="',r+=n(i),r+='">',r+=n(i),r+="</div> </div>",new m(r)}),o("msg",function(e){"use strict";var t=this,n=(t.$helpers,t.$each),a=e.list,i=(e.v,e.k,t.$escape),o=t.$string,r=(e.rv,e.rk,e.mv,e.mk,e.historyTimes),s="";return n(a,function(e){s+=" ","bot"===e.from_type?(s+=' <div id="',s+=i(e.id),s+='" class="msg-bot"> <div class="name"> ',s+=i(e.agent.nickname),s+=" ",e.displayDate&&(s+=' <span id="date',s+=i(e.id),s+='" class="date">',s+=o(e.displayDate),s+="</span> "),s+=" </div> ","welcome"===e.content_type?(s+=' <div class="bubble"> <span class="arrow-bg"></span> <span class="arrow"></span> <div class="text"> ',s+=o(e.content),s+=" </div> </div> "):"text"===e.content_type||"bot"===e.content_type?(s+=' <div class="bubble rich-text-bubble"> <span class="arrow-bg"></span> <span class="arrow"></span> ',e.content_robot&&e.content_robot.length?(s+=" ",n(e.content_robot,function(e){s+=" ","text"===e.type?(s+=" ",e.rich_text?(s+=' <div class="text rich_text">',s+=o(e.rich_text),s+="</div> "):(s+=' <div class="text">',s+=o(e.text),s+="</div> "),s+=" "):("menu"===e.type||"related"===e.type)&&(s+=" ",e.text_before&&(s+=' <div class="menu-tips">',s+=i(e.text_before),s+="</div> "),s+=' <div class="menu"> ',e.items&&e.items.length&&(s+=" <ol>",n(e.items,function(e){s+=" <li> ",e.link?(s+=' <a class="menu-item" data-value="',s+=o(e.value),s+='" href="',s+=o(e.link),s+='" target="_blank">',s+=o(e.text),s+="</a> "):(s+=' <span class="menu-item" data-value="',s+=o(e.value),s+='">',s+=o(e.text),s+="</span> "),s+=" </li> "}),s+='</ol> <div class="menu-tips">Select the question or reply the number to get solve your problem.</div> '),s+=" </div> "),s+=" "}),s+=" "):e.content&&(s+=' <div class="text">',s+=o(e.content),s+="</div> "),s+=" ","evaluate"===e.sub_type&&(s+=' <div class="rating" data-question-id="',s+=o(e.question_id),s+='"> <a href="javascript:;;" class="option" data-option="useful">Solve</a> <a href="javascript:;;" class="option" data-option="useless">Unsolve</a> <span class="rated-text">Feedback</span> <span class="pending-text">Submit</span> <span class="split"></span> </div> '),s+=" </div> "):"rich_text"===e.content_type?(s+=' <div class="bubble rich-text-bubble"> <span class="arrow-bg"></span> <span class="arrow"></span> <div class="text rich_text">',s+=o(e.extra.content),s+="</div> ","evaluate"===e.sub_type&&(s+=' <div class="rating" data-question-id="',s+=o(e.question_id),s+='"> <a href="javascript:;;" class="option" data-option="useful">Solve</a> <a href="javascript:;;" class="option" data-option="useless">Unsolve</a> <span class="rated-text">Feedback</span> <span class="pending-text">Submit</span> <span class="split"></span> </div> '),s+=" </div> "):"photo"===e.content_type&&(s+=' <div class="photo"> <a href="',s+=i(e.media_url),s+='" target="_blank"> ',r>1?(s+=' <img src="',s+=i(e.media_url),s+='" /> '):(s+=' <img src="',s+=i(e.media_url),s+='" onload="window.SCROLL_TO_LAST()" /> '),s+=" </a> </div> "),s+=" </div> "):"agent"===e.from_type&&(s+=' <div id="',s+=i(e.id),s+='" class="msg-agent"> <div class="name"> ',s+=i(e.agent.nickname),s+=" ",e.displayDate&&(s+=' <span id="date',s+=i(e.id),s+='" class="date">',s+=o(e.displayDate),s+="</span> "),s+=" </div> ","welcome"===e.content_type?(s+=' <div class="bubble"> <span class="arrow-bg"></span> <span class="arrow"></span> <div class="text">',s+=o(e.content),s+="</div> </div> "):"text"===e.content_type?(s+=' <div class="bubble"> <span class="arrow-bg"></span> <span class="arrow"></span> <div class="text">',s+=o(e.content),s+="</div> </div> "):"rich_text"===e.content_type?(s+=' <div class="bubble rich-text-bubble"> <span class="arrow-bg"></span> <span class="arrow"></span> <div class="text rich_text">',s+=o(e.extra.content),s+="</div> </div> "):"photo"===e.content_type?(s+=' <div class="photo"> <a href="',s+=i(e.media_url),s+='" target="_blank"> ',r>1?(s+=' <img src="',s+=i(e.media_url),s+='" /> '):(s+=' <img src="',s+=i(e.media_url),s+='" onload="window.SCROLL_TO_LAST()" /> '),s+=" </a> </div> "):"file"===e.content_type&&(s+=' <div class="file"> <span class="arrow-bg"></span> <span class="arrow"></span> <i class="icon icon-file"></i> <div class="content"> <div class="title"> <span class="file-name" title="',s+=i(e.extra.filename),s+='">',s+=i(e.extra.filename),s+='</span> <span class="file-size">',s+=i(e.extra.convert_size),s+='</span> </div> <div class="sub"> ',e.extra.cancel?s+=' <span class="file-state">The other party cancels sending</span> ':(s+=" ",e.extra.has_expired?(s+=' <span class="file-state">Expires after',s+=i(e.extra.has_expired),s+='</span> <a class="btn-download" name="',s+=i(e.id),s+=",",s+=i(e.conversation_id),s+='" href="',s+=i(e.media_url),s+='" target="_blank"> <i class="icon icon-download"></i> <span>download</span> </a> '):s+=' <span class="file-state">expired</span> ',s+=" "),s+=" </div> </div> </div> "),s+=" </div> "),s+=" ","client"===e.from_type&&(s+=' <div id="',s+=i(e.id),s+='" class="msg-client"> ',e.displayDate&&(s+=' <div id="date',s+=i(e.id),s+='" class="date">',s+=o(e.displayDate),s+="</div> "),s+=" ","text"===e.content_type?(s+=' <div class="bubble"> <span class="arrow"></span> <div class="text">',s+=o(e.content),s+="</div> ","sending"===e.status&&(s+=' <span id="status',s+=i(e.id),s+='" class="status icon"></span> '),s+=" </div> "):"photo"===e.content_type?(s+=' <div class="photo"> <a href="',s+=i(e.media_url),s+='" target="_blank"> ',r>1?(s+=' <img id="photo',s+=i(e.id),s+='" src="',s+=i(e.media_url),s+='" /> '):(s+=' <img id="photo',s+=i(e.id),s+='" src="',s+=i(e.media_url),s+='" onload="window.SCROLL_TO_LAST()" /> '),s+=" </a> ","sending"===e.status&&(s+=' <span id="status',s+=i(e.id),s+='" class="status icon"></span> '),s+=" </div> "):"file"===e.content_type&&(s+=' <div class="file"> <span class="arrow-bg"></span> <span class="arrow"></span> <i class="icon icon-file"></i> <div class="content"> <div class="title"> <span class="file-name" title="',s+=i(e.extra.filename),s+='">',s+=i(e.extra.filename),s+='</span> <span class="file-size">',s+=i(e.extra.convert_size),s+='</span> </div> <div class="sub"> ',e.uploading?(s+=' <span id="progress',s+=i(e.id),s+='" class="progress-holder"> <span class="progress-bg"> <span id="progressBar',s+=i(e.id),s+='" class="progress-bar"></span> </span> </span> <a id="cancelUpload',s+=i(e.id),s+='" class="btn-cancel-upload"> <i class="icon icon-cancel-upload"></i> </a> <span id="fileState',s+=i(e.id),s+='" class="file-state">uploading&nbsp;<span id="speed',s+=i(e.id),s+='"></span></span> '):(s+=" ",e.extra.cancel?s+=' <span class="file-state">Cancel upload</span> ':(s+=" ",e.extra.has_expired?(s+=' <span class="file-state">Expires after',s+=i(e.extra.has_expired),s+="</span> "):s+=' <span class="file-state">expired</span> ',s+=" "),s+=" "),s+=" </div> </div> </div> "),s+=" </div> "),s+=" ","redirect"===e.from_type&&(s+=' <div id="',s+=i(e.id),s+='" class="msg-redirect"> Next by the<span>',s+=i(e.toNickname),s+="</span>to serve you </div> "),s+=" ","evaluation"===e.from_type&&(s+=' <div id="',s+=i(e.id),s+='" class="msg-evaluation"> You are given <span class="evaluation-level evaluation-level-',s+=i(e.level),s+='">',s+=i(e.levelText),s+="</span> ",e.content&&(s+=' <div class="evaluation-content">',s+=i(e.content),s+="</div> "),s+=" </div> "),s+=" ","blacklist"===e.from_type&&(s+=' <div id="',s+=i(e.id),s+='" class="msg-blacklist">You are removed from the blacklist</div> '),s+=" "}),s+=" ",new m(s)}),o("profile-customer",function(e){"use strict";var t=this,n=(t.$helpers,t.$escape),a=e.bgColor,i=e.photoType,o=e.avatar,r=e.name,s=t.$string,l=e.content,u="";return u+='<div class="profile-contact" style="background-color: #',u+=n(a),u+='"> ',"big"===i&&(u+=' <img class="profile-avatar" src="',u+=n(o),u+='" alt="avatar"> <div class="profile-name">',u+=n(r),u+="</div> "),u+=" ",u+=s(l),u+=" </div> ",new m(u)}),o("profile",function(e){"use strict";var t=this,n=(t.$helpers,t.$escape),a=e.avatar,i=e.name,o=e.tel,r=e.cellphone,s=e.email,l=e.qq,u=e.weixin,c="";return c+='<img class="profile-avatar" src="',c+=n(a),c+='" alt="avatar"> <div class="profile-name">',c+=n(i),c+='</div> <div class="profile-contact"> ',o&&(c+=' <a> <i class="icon icon-tel"></i> <span>',c+=n(o),c+="</span> </a> "),c+=" ",r&&(c+=' <a> <i class="icon icon-cellphone"></i> <span>',c+=n(r),c+="</span> </a> "),c+=" ",s&&(c+=' <a> <i class="icon icon-email"></i> <span>',c+=n(s),c+="</span> </a> "),c+=" ",l&&(c+=' <a> <i class="icon icon-qq"></i> <span>',c+=n(l),c+="</span> </a> "),c+=" ",u&&(c+=' <a> <i class="icon icon-weixin"></i> <span>',c+=n(u),c+="</span> </a> "),c+=" </div>",new m(c)}),o("queueing",function(e){"use strict";var t=this,n=(t.$helpers,t.$escape),a=e.intro,i=e.position,o="";return o+='<div class="queue-header">',o+=n(a),o+='</div> <div class="queue-body"> <div class="queue-position-title">Number of visitors waiting</div> <span id="queueingPosition">',o+=n(i),o+='</span> </div> <div class="queue-footer"> <p>Don’t want to wait? Leave us a message.</p> <a class="btn-go-ticket">Leave us a message</a> </div>',new m(o)}),o("support",function(e){"use strict";var t=this,n=(t.$helpers,e.disableBrandLink),a=t.$escape,i=e.entId,o="";return o+="<a ",n!==!0&&(o+='href="http://meiqia.com?utm_source=widget-badge&utm_term=',o+=a(i),o+='"'),o+=' target="_blank"> <i class="icon icon-logo-gray"></i> <span>Customer service software provided by the Meiqia</span> </a>',new m(o)}),o("survey",function(e){"use strict";var t=this,n=(t.$helpers,e.menus),a=t.$escape,i=t.$each,o=(e.v,e.k,e.inputs),r=e.val,s=(e.key,e.captcha),l="";return"open"===n.status&&(l+=' <div id="surveyStep1" class="active"> <!--<div class="step-title">',l+=a(n.title),l+='</div>--> <div class="step-title">Inquiry</div> ',i(n.assignments,function(e,t){l+=' <div class="menus-item"> <a id="',l+=a(e.target_kind),l+="_",l+=a(e.target),l+='" name="surveyMenus" title="',l+=a(e.description),
l+='">',l+=a(t+1),l+=". ",l+=a(e.description),l+="</a> </div> "}),l+=" </div> "),l+=" ","open"===o.status&&(l+=' <div id="surveyStep2" ',"close"===n.status&&(l+='class="active"'),l+='> <!--<div class="step-title">',l+=a(o.title),l+='</div>--> <div class="step-title">Inquiry</div> ',i(o.fields,function(e){l+=" ",e.ignore||(l+=' <div class="form-group"> <div class="group-title">',l+=a(e.field_name),e.optional||(l+="<span>*</span>"),l+='</div> <div class="group-content"> ',"text"===e.type?(l+=' <input name="',l+=a(e.field_name),l+='" ',l+=e.optional?'class="survey-input-text"':'class="survey-input-text required"',l+=' type="text" value="',l+=a(r),l+='" placeholder="Please enter" /> '):"single_choice"===e.type?(l+=" ",i(e.choices,function(t){l+=' <div class="choice-item"> <label> <input name="',l+=a(e.field_name),l+='" ',e.optional||(l+='class="required"'),l+=' type="radio" value="',l+=a(t),l+='" /> <span>',l+=a(t),l+="</span> </label> </div> "}),l+=" "):"multiple_choice"===e.type&&(l+=" ",i(e.choices,function(t){l+=' <div class="choice-item"> <label> <input name="',l+=a(e.field_name),l+='" ',e.optional||(l+='class="required"'),l+=' type="checkbox" value="',l+=a(t),l+='" /> <span>',l+=a(t),l+="</span> </label> </div> "}),l+=" "),l+=" </div> </div> "),l+=" "}),l+=" ",s&&(l+=' <div class="captcha-group"> <div class="group-title">Verification Code<span>*</span></div> <div class="group-content"> <div class="captcha-input"> <input id="surveyCaptcha" class="required" type="text" /> </div> <div class="captcha-img"> <img id="surveyCaptchaImg" src="" /> </div> </div> </div> '),l+=' <div class="btn-group"> <a id="surveySubmit">Submit</a> </div> </div> '),new m(l)}),o("ticket-basic",function(e){"use strict";var t=this,n=(t.$helpers,e.intro),a=t.$escape,i=e.categories,o=t.$each,r=(e.val,e.key,t.$string),s=e.name,l=e.contactRule,u=e.tel,c=e.email,d=e.wechat,f=e.qq,p=e.defaultTemplate,g=e.defaultTemplateContent,v=e.captcha,h="";return h+='<div id="ticketV2" class="active"> ',n&&(h+=' <div class="step-title">',h+=a(n),h+="</div> "),h+=" ",i&&i.length>0&&(h+=' <div class="form-group"> <div class="group-title">classification<span>*</span></div> <div class="group-content"> ',o(i,function(e){h+=' <div class="choice-item"> <label> <input name="categories" type="radio" value="',h+=r(e.id),h+='" /> <span>',h+=r(e.name),h+="</span> </label> </div> "}),h+=" </div> </div> "),h+=" ","open"===s&&(h+=' <div class="form-group"> <div class="group-title"> name ',"multi"===l&&(h+=" <span>*</span> "),h+=' </div> <div class="group-content"> <input id="ticketName" type="text"> </div> </div> '),h+=" ","open"===u&&(h+=' <div class="form-group"> <div class="group-title"> Phone number ',"multi"===l&&(h+=" <span>*</span> "),h+=' </div> <div class="group-content"> <input id="ticketTel" type="text"> </div> </div> '),h+=" ","open"===c&&(h+=' <div class="form-group"> <div class="group-title"> Email ',"multi"===l&&(h+=" <span>*</span> "),h+=' </div> <div class="group-content"> <input id="ticketEmail" type="text"> </div> </div> '),h+=" ","open"===d&&(h+=' <div class="form-group"> <div class="group-title"> weChat ',"multi"===l&&(h+=" <span>*</span> "),h+=' </div> <div class="group-content"> <input id="ticketWechat" type="text"> </div> </div> '),h+=" ","open"===f&&(h+=' <div class="form-group"> <div class="group-title"> QQ ',"multi"===l&&(h+=" <span>*</span> "),h+=' </div> <div class="group-content"> <input id="ticketQq" type="text"> </div> </div> '),h+=' <div class="form-group"> <div class="group-title">Message<span>*</span></div> <div class="group-content"> ',"open"===p?(h+=' <textarea id="ticketContent">',h+=a(g),h+="</textarea> "):h+=' <textarea id="ticketContent"></textarea> ',h+=" </div> </div> ","open"===v&&(h+=' <div class="captcha-group"> <div class="group-title">Verification Code<span>*</span></div> <div class="group-content"> <div class="captcha-input"> <input id="ticketCaptcha" class="required" type="text"/> </div> <div class="captcha-img"> <img id="ticketCaptchaImg" src="" /> </div> </div> </div> '),h+=' <div class="btn-group"> <a id="ticketSubmit">submit</a> </div> </div> ',new m(h)}),o("ticket",function(e){"use strict";var t=this,n=(t.$helpers,e.intro),a=t.$escape,i=e.categories,o=t.$each,r=(e.val,e.key,t.$string),s=e.name,l=e.contactRule,u=e.tel,c=e.email,d=e.wechat,f=e.qq,p=e.defaultTemplate,g=e.defaultTemplateContent,v=e.captcha,h="";return h+='<div id="ticketV2" class="active"> ',n&&(h+=' <div class="step-title">',h+=a(n),h+="</div> "),h+=" ",i&&i.length>0&&(h+=' <div class="form-group"> <div class="group-title">classification<span>*</span></div> <div class="group-content"> ',o(i,function(e){h+=' <div class="choice-item"> <label> <input name="categories" type="radio" value="',h+=r(e.id),h+='" /> <span>',h+=r(e.name),h+="</span> </label> </div> "}),h+=" </div> </div> "),h+=" ","open"===s&&(h+=' <div class="form-group"> <div class="group-title"> name ',"multi"===l&&(h+=" <span>*</span> "),h+=' </div> <div class="group-content"> <input id="ticketName" type="text" placeholder=" Please enter your name"> </div> </div> '),h+=" ","open"===u&&(h+=' <div class="form-group"> <div class="group-title"> Phone number ',"multi"===l&&(h+=" <span>*</span> "),h+=' </div> <div class="group-content"> <input id="ticketTel" type="text" placeholder=" Please enter your phone number"> </div> </div> '),h+=" ","open"===c&&(h+=' <div class="form-group"> <div class="group-title"> Email ',"multi"===l&&(h+=" <span>*</span> "),h+=' </div> <div class="group-content"> <input id="ticketEmail" type="text" placeholder=" Please enter your email"> </div> </div> '),h+=" ","open"===d&&(h+=' <div class="form-group"> <div class="group-title"> WeChat ',"multi"===l&&(h+=" <span>*</span> "),h+=' </div> <div class="group-content"> <input id="ticketWechat" type="text" placeholder=" Please enter your WeChat number"> </div> </div> '),h+=" ","open"===f&&(h+=' <div class="form-group"> <div class="group-title"> QQ ',"multi"===l&&(h+=" <span>*</span> "),h+=' </div> <div class="group-content"> <input id="ticketQq" type="text" placeholder=" Please enter your QQ number"> </div> </div> '),h+=' <div class="form-group"> <div class="group-title">Message<span>*</span></div> <div class="group-content"> ',"open"===p?(h+=' <textarea id="ticketContent" placeholder="Please enter a message">',h+=a(g),h+="</textarea> "):h+=' <textarea id="ticketContent" placeholder="Please enter a message"></textarea> ',h+=" </div> </div> ","open"===v&&(h+=' <div class="captcha-group"> <div class="group-title">Verification Code<span>*</span></div> <div class="group-content"> <div class="captcha-input"> <input id="ticketCaptcha" class="required" type="text" placeholder=" Verification Code"/> </div> <div class="captcha-img"> <img id="ticketCaptchaImg" src="" /> </div> </div> </div> '),h+=' <div class="btn-group"> <a id="ticketSubmit">submit</a> </div> </div> ',new m(h)}),o("unable-service",function(e){"use strict";var t=this,n=(t.$helpers,t.$escape),a=e.src,i="";return i+='<img src="',i+=n(a),i+='"> <div>Sorry, Our Customer Service is busy, please leave us a message</div> <a class="btn-go-ticket">Leave us a message</a>',new m(i)}),o("icon-css",function(e){"use strict";var t=this,n=(t.$helpers,t.$escape),a=e.cdn,i=e.tail,o="";return o+='.icon { background-image: url("',o+=n(a),o+="/images/icon-desktop.png?v=",o+=n(i),o+='"); background-size: 44px auto; background-repeat: no-repeat; } .emoji-control { background-image: url("',o+=n(a),o+="/images/emoji.png?v=",o+=n(i),o+='"); background-size: 25px auto; background-repeat: no-repeat; } @media only screen and (-webkit-min-device-pixel-ratio: 2), only screen and (min--moz-device-pixel-ratio: 2), only screen and (-o-min-device-pixel-ratio: 2/1), only screen and (min-device-pixel-ratio: 2) { .icon { background-image: url("',o+=n(a),o+="/images/icon-desktop@2x.png?v=",o+=n(i),o+='"); } .emoji-control { background-image: url("',o+=n(a),o+="/images/emoji@2x.png?v=",o+=n(i),o+='"); } } ',new m(o)}),o("theme-css",function(e){"use strict";var t=this,n=(t.$helpers,t.$escape),a=e.bgColor,i=e.textColor,o=e.subTextColor,r=e.color2,s="";return s+="#pageChat .header, #pageTicket .header, #pageCall .header, #pageSurvey .header { background-color: ",s+=n(a),s+="; color: ",s+=n(i),s+="; } #pageChat #agentInputting { background-color: ",s+=n(a),s+="; } #pageChat .agent-signature { color: ",s+=n(o),s+=" } #pageChat .msg-client .bubble { background-color: ",s+=n(a),s+="; color: ",s+=n(i),s+="; } #pageChat .msg-client .bubble a { color: ",s+=n(i),s+="; } #pageChat .msg-client .arrow { border-left: 6px solid ",s+=n(a),s+="; } #pageChat .footer .feature-holder #btnSend.active { background-color: ",s+=n(a),s+="; color: ",s+=n(i),s+="; } #pageChat #unableService .btn-go-ticket { background-color: ",s+=n(a),s+="; color: ",s+=n(i),s+="; } #pageChat #evaluationSubmit { background-color: ",s+=n(a),s+="; color: ",s+=n(i),s+="; } #pageChat #queueingTips .queue-position-title { color: ",s+=n(a),s+="; } #pageChat #queueingTips #queueingPosition { color: ",s+=n(a),s+="; } #pageChat #queueingTips .btn-go-ticket { background-color: ",s+=n(a),s+="; color: ",s+=n(i),s+='; } #pageSurvey .body .menus-item > a, #pageChat .body-left .msg-bot .bubble .menu-item, #pageChat .body-left .msg-bot .rating a, #pageChat .body-left .msg-bot div.rich-text-bubble a, #pageChat .body-left .msg-agent div.rich-text-bubble a, #pageChat .body-left .msg-common-tips a, #autocomplete li em, #autocomplete li a[data-current="true"] { /*color: ',s+=n(a),s+=";*/ color: #6088e6; } #autocomplete li a:hover { background-color: ",s+=n(a),s+="; } ",s+="white"===r?" .icon-angel-down, .icon-ring-open, .icon-ring-close { opacity: .6; filter: alpha(opacity=60); } .icon-angel-down:hover, .icon-ring-open:hover, .icon-ring-close:hover { opacity: .8; filter: alpha(opacity=80); } .icon-angel-down { background-position: -22px -66px; } .icon-ring-open { background-position: -22px -89px; } .icon-ring-close { background-position: -22px -111px; } ":" .icon-angel-down, .icon-ring-open, .icon-ring-close { opacity: .3; filter: alpha(opacity=30); } .icon-angel-down:hover, .icon-ring-open:hover, .icon-ring-close:hover { opacity: .5; filter: alpha(opacity=50); } .icon-angel-down { background-position: 0 -66px; } .icon-ring-open { background-position: 0 -89px; } .icon-ring-close { background-position: 0 -111px; } ",s+=" #pageTicket #ticketSubmit { background-color: ",s+=n(a),s+="; color: ",s+=n(i),s+="; } #pageTicket #ticketDone { background-color: ",s+=n(a),s+="; color: ",s+=n(i),s+="; } #pageCall .input-active { border-color: ",s+=n(a),s+=" !important; } #pageCall .submit-active { background-color: ",s+=n(a),s+=" !important; } #pageCall .submit-intro { color: ",s+=n(a),s+="; } #pageCall .call-success-icon { background-color: ",s+=n(a),s+="; } #pageSurvey .menus-item >a { color: ",s+=n(a),s+="; } #pageSurvey #surveySubmit { background-color: ",s+=n(a),s+="; color: ",s+=n(i),s+="; } ",new m(s)})}()},function(e,t,n){var a,i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function o(e,t){return(/string|function/.test("undefined"==typeof t?"undefined":i(t))?f:d)(e,t)}function r(e,t){return"string"!=typeof e&&(t="undefined"==typeof e?"undefined":i(e),"number"===t?e+="":e="function"===t?r(e.call(e)):""),e}function s(e){return v[e]}function l(e){return r(e).replace(/&(?![\w#]+;)|[<>"']/g,s)}function u(e,t){if(h(e))for(var n=0,a=e.length;a>n;n++)t.call(e,e[n],n,e);else for(n in e)t.call(e,e[n],n)}function c(e,t){var n=/(\/)[^\/]+\1\.\.\1/,a=("./"+e).replace(/[^\/]+$/,""),i=a+t;for(i=i.replace(/\/\.\//g,"/");i.match(n);)i=i.replace(n,"/");return i}function d(e,t){var n=o.get(e)||p({filename:e,name:"Render Error",message:"Template not found"});return t?n(t):n}function f(e,t){if("string"==typeof t){var n=t;t=function(){return new m(n)}}var a=g[e]=function(n){try{return new t(n,e)+""}catch(a){return p(a)()}};return a.prototype=t.prototype=b,a.toString=function(){return t+""},a}function p(e){var t="{Template Error}",n=e.stack||"";if(n)n=n.split("\n").slice(0,2).join("\n");else for(var a in e)n+="<"+a+">\n"+e[a]+"\n\n";return function(){return"object"==("undefined"==typeof console?"undefined":i(console))&&console.error(t+"\n\n"+n),t}}var g=o.cache={},m=this.String,v={"<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","&":"&#38;"},h=Array.isArray||function(e){return"[object Array]"==={}.toString.call(e)},b=o.utils={$helpers:{},$include:function(e,t,n){return e=c(n,e),d(e,t)},$string:r,$escape:l,$each:u},y=o.helpers=b.$helpers;o.get=function(e){return g[e.replace(/^\.\//,"")]},o.helper=function(e,t){y[e]=t},a=function(){return o}.call(t,n,t,e),!(void 0!==a&&(e.exports=a)),o("audio",function(e){"use strict";var t=this,n=(t.$helpers,t.$escape),a=e.cdn,i="";return i+='<audio id="newChat" preload="preload"> <source src="',i+=n(a),i+='/audio/new-chat.ogg" type="audio/ogg" /> <source src="',i+=n(a),i+='/audio/new-chat.mp3" type="audio/mpeg" /> </audio> <audio id="newMessage" preload="preload"> <source src="',i+=n(a),i+='/audio/new-message.ogg" type="audio/ogg" /> <source src="',i+=n(a),i+='/audio/new-message.mp3" type="audio/mpeg" /> </audio> <audio id="sentMessage" preload="preload"> <source src="',i+=n(a),i+='/audio/sent-message.ogg" type="audio/ogg" /> <source src="',i+=n(a),i+='/audio/sent-message.mp3" type="audio/mpeg" /> </audio>',new m(i)}),o("chat-has-end",'對話已結束，您可以<a class="btn-restart-chat">開始新的對話</a>或<a class="btn-go-ticket">留言</a> '),o("emoji",function(e){"use strict";var t=this,n=(t.$helpers,t.$each),a=e.list,i=(e.v,e.k,t.$escape),o="";return n(a,function(e){o+=' <i class="emoji-control emoji-',o+=i(e),o+='" onclick="window.CHOSE_EMOJI(\':',o+=i(e),o+=":')\"></i> "}),o+=' <div class="clearfix"></div>',new m(o)}),o("evaluation-basic",function(e){"use strict";var t=this,n=(t.$helpers,t.$escape),a=e.intro,i="";return i+='<div class="evaluation-header"> <a id="evaluationHide"> <i class="icon icon-times"></i> </a> <div class="intro">',i+=n(a),i+='</div> </div> <div class="evaluation-body"> <div class="evaluation-btn-group"> <input id="evaluationLevel" type="hidden" /> <div id="evaluation2" class="evaluation-btn"> <i class="icon icon-smile"></i> <span>好評</span> </div> <div id="evaluation1" class="evaluation-btn"> <i class="icon icon-neutral"></i> <span>中評</span> </div> <div id="evaluation0" class="evaluation-btn"> <i class="icon icon-angry"></i> <span>差評</span> </div> </div> <div class="evaluation-reason"> <label for="evaluationContent">請填寫評價內容（選填）</label> <textarea id="evaluationContent"></textarea> <button id="evaluationSubmit">提交</button> </div> </div> ',new m(i)}),o("evaluation",function(e){"use strict";var t=this,n=(t.$helpers,t.$escape),a=e.intro,i="";return i+='<div class="evaluation-header"> <a id="evaluationHide"> <i class="icon icon-times"></i> </a> <div class="intro">',i+=n(a),i+='</div> </div> <div class="evaluation-body"> <div class="evaluation-btn-group"> <input id="evaluationLevel" type="hidden" /> <div id="evaluation2" class="evaluation-btn"> <i class="icon icon-smile"></i> <span>好評</span> </div> <div id="evaluation1" class="evaluation-btn"> <i class="icon icon-neutral"></i> <span>中評</span> </div> <div id="evaluation0" class="evaluation-btn"> <i class="icon icon-angry"></i> <span>差評</span> </div> </div> <div class="evaluation-reason"> <textarea id="evaluationContent" placeholder="請填寫評價內容（選填）"></textarea> <button id="evaluationSubmit">提交</button> </div> </div> ',new m(i)}),o("features",function(e){"use strict";var t=this,n=(t.$helpers,e.emoji),a=e.photo,i=e.upload,o=e.evaluation,r="";return n&&(r+=' <a id="emojiBtn" class="feature-btn" title="表情"> <i class="icon icon-emoji"></i> </a> '),r+=" ",a&&(r+=' <label id="photoBtn" class="feature-btn" title="發送圖片"> <i class="icon icon-photo"></i> <input id="photoFile" type="file" accept="image/gif, image/jpeg, image/jpg, image/png"> </label> '),r+=" ",i&&(r+=' <label id="uploadBtn" class="feature-btn" title="發送文件"> <i class="icon icon-upload"></i> <input id="uploadFile" type="file"> </label> '),r+=" ",o&&(r+=' <a id="evaluationBtn" class="feature-btn" title="評價"> <i class="icon icon-evaluation"></i> </a> '),r+=" ",new m(r)}),o("header-customer",function(e){"use strict";var t=this,n=(t.$helpers,e.photoType),a=t.$escape,i=e.avatar,o=e.signature,r=e.name,s="";return"small"===n&&(s+=' <img class="agent-avatar" src="',s+=a(i),s+='" alt="avatar"> '),s+=" ",s+="small"===n?' <div class="agent-info" style="margin-left: 54px"> ':' <div class="agent-info"> ',s+=' <div class="agent-name ',o||(s+="without-signature"),s+='"> ',s+=a(r),s+=' <span id="agentInputting">對方輸入消息中...</span> </div> <div class="agent-signature" title="',s+=a(o),s+='">',s+=a(o),s+="</div> </div> ",new m(s)}),o("header-fusion",function(e){"use strict";var t=this,n=(t.$helpers,e.signature),a=t.$escape,i=e.name,o="";return o+='<div class="agent-info"> <div class="agent-name ',n||(o+="without-signature"),o+='"> ',o+=a(i),o+=' <span id="agentInputting">對方輸入消息中...</span> </div> <div class="agent-signature" title="',o+=a(n),o+='">',o+=a(n),o+="</div> </div> ",new m(o)}),o("header-loading",'<div id="loading"> 連接中<span class="dot1">.</span><span class="dot2">.</span><span class="dot3">.</span> </div> '),o("header-mondeo",function(e){"use strict";var t=this,n=(t.$helpers,e.signature),a=t.$escape,i=e.name,o="";return o+='<div class="agent-info"> <div class="agent-name ',n||(o+="without-signature"),o+='"> ',o+=a(i),o+=' <span id="agentInputting">對方輸入消息中...</span> </div> <div class="agent-signature" title="',o+=a(n),o+='">',o+=a(n),o+="</div> </div> ",new m(o)}),o("header",function(e){"use strict";var t=this,n=(t.$helpers,t.$escape),a=e.avatar,i=e.signature,o=e.name,r="";return r+='<img class="agent-avatar" src="',r+=n(a),r+='" alt="avatar"> <div class="agent-info"> <div class="agent-name ',i||(r+="without-signature"),r+='"> ',r+=n(o),r+=' <span id="agentInputting">對方輸入消息中...</span> </div> <div class="agent-signature" title="',r+=n(i),r+='">',r+=n(i),r+="</div> </div> ",new m(r)}),o("msg",function(e){"use strict";var t=this,n=(t.$helpers,t.$each),a=e.list,i=(e.v,e.k,t.$escape),o=t.$string,r=(e.rv,e.rk,e.mv,e.mk,e.historyTimes),s="";return n(a,function(e){s+=" ","bot"===e.from_type?(s+=' <div id="',s+=i(e.id),s+='" class="msg-bot"> <div class="name"> ',s+=i(e.agent.nickname),s+=" ",e.displayDate&&(s+=' <span id="date',s+=i(e.id),s+='" class="date">',s+=o(e.displayDate),s+="</span> "),s+=" </div> ","welcome"===e.content_type?(s+=' <div class="bubble"> <span class="arrow-bg"></span> <span class="arrow"></span> <div class="text"> ',s+=o(e.content),s+=" </div> </div> "):"text"===e.content_type||"bot"===e.content_type?(s+=' <div class="bubble rich-text-bubble"> <span class="arrow-bg"></span> <span class="arrow"></span> ',e.content_robot&&e.content_robot.length?(s+=" ",n(e.content_robot,function(e){s+=" ","text"===e.type?(s+=" ",e.rich_text?(s+=' <div class="text rich_text">',s+=o(e.rich_text),s+="</div> "):(s+=' <div class="text">',s+=o(e.text),s+="</div> "),s+=" "):("menu"===e.type||"related"===e.type)&&(s+=" ",e.text_before&&(s+=' <div class="menu-tips">',s+=i(e.text_before),s+="</div> "),s+=' <div class="menu"> ',e.items&&e.items.length&&(s+=" <ol>",n(e.items,function(e){s+=" <li> ",e.link?(s+=' <a class="menu-item" data-value="',s+=o(e.value),s+='" href="',s+=o(e.link),s+='" target="_blank">',s+=o(e.text),s+="</a> "):(s+=' <span class="menu-item" data-value="',s+=o(e.value),s+='">',s+=o(e.text),s+="</span> "),s+=" </li> "}),s+='</ol> <div class="menu-tips">點擊問題或回覆數字查看答案</div> '),s+=" </div> "),s+=" "}),s+=" "):e.content&&(s+=' <div class="text">',s+=o(e.content),s+="</div> "),s+=" ","evaluate"===e.sub_type&&(s+=' <div class="rating" data-question-id="',s+=o(e.question_id),s+='"> <a href="javascript:;;" class="option" data-option="useful">解決</a> <a href="javascript:;;" class="option" data-option="useless">未解決</a> <span class="rated-text">已反饋</span> <span class="pending-text">提交中</span> <span class="split"></span> </div> '),s+=" </div> "):"rich_text"===e.content_type?(s+=' <div class="bubble rich-text-bubble"> <span class="arrow-bg"></span> <span class="arrow"></span> <div class="text rich_text">',s+=o(e.extra.content),s+="</div> ","evaluate"===e.sub_type&&(s+=' <div class="rating" data-question-id="',s+=o(e.question_id),s+='"> <a href="javascript:;;" class="option" data-option="useful">解决</a> <a href="javascript:;;" class="option" data-option="useless">未解决</a> <span class="rated-text">已反饋</span> <span class="pending-text">提交中</span> <span class="split"></span> </div> '),s+=" </div> "):"photo"===e.content_type&&(s+=' <div class="photo"> <a href="',s+=i(e.media_url),s+='" target="_blank"> ',r>1?(s+=' <img src="',s+=i(e.media_url),s+='" /> '):(s+=' <img src="',s+=i(e.media_url),s+='" onload="window.SCROLL_TO_LAST()" /> '),s+=" </a> </div> "),s+=" </div> "):"agent"===e.from_type&&(s+=' <div id="',s+=i(e.id),s+='" class="msg-agent"> <div class="name"> ',s+=i(e.agent.nickname),s+=" ",e.displayDate&&(s+=' <span id="date',s+=i(e.id),s+='" class="date">',s+=o(e.displayDate),s+="</span> "),s+=" </div> ","welcome"===e.content_type?(s+=' <div class="bubble"> <span class="arrow-bg"></span> <span class="arrow"></span> <div class="text">',s+=o(e.content),s+="</div> </div> "):"text"===e.content_type?(s+=' <div class="bubble"> <span class="arrow-bg"></span> <span class="arrow"></span> <div class="text">',s+=o(e.content),s+="</div> </div> "):"rich_text"===e.content_type?(s+=' <div class="bubble rich-text-bubble"> <span class="arrow-bg"></span> <span class="arrow"></span> <div class="text rich_text">',s+=o(e.extra.content),s+="</div> </div> "):"photo"===e.content_type?(s+=' <div class="photo"> <a href="',s+=i(e.media_url),s+='" target="_blank"> ',r>1?(s+=' <img src="',s+=i(e.media_url),s+='" /> '):(s+=' <img src="',s+=i(e.media_url),s+='" onload="window.SCROLL_TO_LAST()" /> '),s+=" </a> </div> "):"file"===e.content_type&&(s+=' <div class="file"> <span class="arrow-bg"></span> <span class="arrow"></span> <i class="icon icon-file"></i> <div class="content"> <div class="title"> <span class="file-name" title="',s+=i(e.extra.filename),s+='">',s+=i(e.extra.filename),s+='</span> <span class="file-size">',s+=i(e.extra.convert_size),s+='</span> </div> <div class="sub"> ',e.extra.cancel?s+=' <span class="file-state">對方取消發送</span> ':(s+=" ",e.extra.has_expired?(s+=' <span class="file-state">',s+=i(e.extra.has_expired),s+='後過期</span> <a class="btn-download" name="',s+=i(e.id),s+=",",s+=i(e.conversation_id),s+='" href="',s+=i(e.media_url),s+='" target="_blank"> <i class="icon icon-download"></i> <span>下載</span> </a> '):s+=' <span class="file-state">已過期</span> ',s+=" "),s+=" </div> </div> </div> "),s+=" </div> "),s+=" ","client"===e.from_type&&(s+=' <div id="',s+=i(e.id),s+='" class="msg-client"> ',e.displayDate&&(s+=' <div id="date',s+=i(e.id),s+='" class="date">',s+=o(e.displayDate),s+="</div> "),s+=" ","text"===e.content_type?(s+=' <div class="bubble"> <span class="arrow"></span> <div class="text">',s+=o(e.content),s+="</div> ","sending"===e.status&&(s+=' <span id="status',s+=i(e.id),s+='" class="status icon"></span> '),s+=" </div> "):"photo"===e.content_type?(s+=' <div class="photo"> <a href="',s+=i(e.media_url),s+='" target="_blank"> ',r>1?(s+=' <img id="photo',s+=i(e.id),s+='" src="',s+=i(e.media_url),s+='" /> '):(s+=' <img id="photo',s+=i(e.id),s+='" src="',s+=i(e.media_url),s+='" onload="window.SCROLL_TO_LAST()" /> '),s+=" </a> ","sending"===e.status&&(s+=' <span id="status',s+=i(e.id),s+='" class="status icon"></span> '),s+=" </div> "):"file"===e.content_type&&(s+=' <div class="file"> <span class="arrow-bg"></span> <span class="arrow"></span> <i class="icon icon-file"></i> <div class="content"> <div class="title"> <span class="file-name" title="',s+=i(e.extra.filename),s+='">',s+=i(e.extra.filename),s+='</span> <span class="file-size">',s+=i(e.extra.convert_size),s+='</span> </div> <div class="sub"> ',e.uploading?(s+=' <span id="progress',s+=i(e.id),s+='" class="progress-holder"> <span class="progress-bg"> <span id="progressBar',s+=i(e.id),s+='" class="progress-bar"></span> </span> </span> <a id="cancelUpload',s+=i(e.id),s+='" class="btn-cancel-upload"> <i class="icon icon-cancel-upload"></i> </a> <span id="fileState',s+=i(e.id),s+='" class="file-state">上傳中&nbsp;<span id="speed',s+=i(e.id),s+='"></span></span> '):(s+=" ",e.extra.cancel?s+=' <span class="file-state">取消上傳</span> ':(s+=" ",e.extra.has_expired?(s+=' <span class="file-state">',s+=i(e.extra.has_expired),s+="後過期</span> "):s+=' <span class="file-state">已過期</span> ',s+=" "),s+=" "),s+=" </div> </div> </div> "),s+=" </div> "),s+=" ","redirect"===e.from_type&&(s+=' <div id="',s+=i(e.id),s+='" class="msg-redirect"> 接下來由<span>',s+=i(e.toNickname),s+="</span>為您服務 </div> "),s+=" ","evaluation"===e.from_type&&(s+=' <div id="',s+=i(e.id),s+='" class="msg-evaluation"> 你給出了 <span class="evaluation-level evaluation-level-',s+=i(e.level),s+='">',s+=i(e.levelText),s+="</span> ",e.content&&(s+=' <div class="evaluation-content">',s+=i(e.content),s+="</div> "),s+=" </div> "),s+=" ","blacklist"===e.from_type&&(s+=' <div id="',s+=i(e.id),s+='" class="msg-blacklist">你被移出了黑名單</div> '),s+=" "}),s+=" ",new m(s)}),o("profile-customer",function(e){"use strict";var t=this,n=(t.$helpers,t.$escape),a=e.bgColor,i=e.photoType,o=e.avatar,r=e.name,s=t.$string,l=e.content,u="";return u+='<div class="profile-contact" style="background-color: #',u+=n(a),u+='"> ',"big"===i&&(u+=' <img class="profile-avatar" src="',u+=n(o),u+='" alt="avatar"> <div class="profile-name">',u+=n(r),u+="</div> "),u+=" ",u+=s(l),u+=" </div> ",new m(u)}),o("profile",function(e){"use strict";var t=this,n=(t.$helpers,t.$escape),a=e.avatar,i=e.name,o=e.tel,r=e.cellphone,s=e.email,l=e.qq,u=e.weixin,c="";return c+='<img class="profile-avatar" src="',c+=n(a),c+='" alt="avatar"> <div class="profile-name">',c+=n(i),c+='</div> <div class="profile-contact"> ',o&&(c+=' <a> <i class="icon icon-tel"></i> <span>',c+=n(o),c+="</span> </a> "),c+=" ",r&&(c+=' <a> <i class="icon icon-cellphone"></i> <span>',c+=n(r),c+="</span> </a> "),c+=" ",s&&(c+=' <a> <i class="icon icon-email"></i> <span>',c+=n(s),c+="</span> </a> "),c+=" ",l&&(c+=' <a> <i class="icon icon-qq"></i> <span>',c+=n(l),c+="</span> </a> "),c+=" ",u&&(c+=' <a> <i class="icon icon-weixin"></i> <span>',c+=n(u),c+="</span> </a> "),c+=" </div>",new m(c)}),o("queueing",function(e){"use strict";var t=this,n=(t.$helpers,t.$escape),a=e.intro,i=e.position,o="";return o+='<div class="queue-header">',o+=n(a),o+='</div> <div class="queue-body"> <div class="queue-position-title">當前等待人數</div> <span id="queueingPosition">',o+=n(i),o+='</span> </div> <div class="queue-footer"> <p>如果等不及，可以選擇</p> <a class="btn-go-ticket">給我們留言</a> </div> ',new m(o)}),o("support",function(e){"use strict";var t=this,n=(t.$helpers,e.disableBrandLink),a=t.$escape,i=e.entId,o="";return o+="<a ",n!==!0&&(o+='href="http://meiqia.com?utm_source=widget-badge&utm_term=',o+=a(i),o+='"'),o+=' target="_blank"> <i class="icon icon-logo-gray"></i> <span>客服系統由美洽提供</span> </a> ',new m(o)}),o("survey",function(e){"use strict";var t=this,n=(t.$helpers,e.menus),a=t.$escape,i=t.$each,o=(e.v,e.k,e.inputs),r=e.val,s=(e.key,e.captcha),l="";return"open"===n.status&&(l+=' <div id="surveyStep1" class="active"> <div class="step-title">',l+=a(n.title),l+="</div> ",i(n.assignments,function(e,t){l+=' <div class="menus-item"> <a id="',l+=a(e.target_kind),l+="_",l+=a(e.target),l+='" name="surveyMenus" title="',l+=a(e.description),l+='">',l+=a(t+1),l+=". ",l+=a(e.description),l+="</a> </div> "}),l+=" </div> "),l+=" ","open"===o.status&&(l+=' <div id="surveyStep2" ',"close"===n.status&&(l+='class="active"'),l+='> <div class="step-title">',l+=a(o.title),l+="</div> ",i(o.fields,function(e){l+=" ",e.ignore||(l+=' <div class="form-group"> <div class="group-title">',l+=a(e.display_name),e.optional||(l+="<span>*</span>"),l+='</div> <div class="group-content"> ',"text"===e.type?(l+=' <input name="',l+=a(e.field_name),l+='" ',l+=e.optional?' class="survey-input-text"':'class="survey-input-text required"',l+=' type="text" value="',l+=a(r),l+='" placeholder="請輸入" /> '):"single_choice"===e.type?(l+=" ",i(e.choices,function(t){l+=' <div class="choice-item"> <label> <input name="',l+=a(e.field_name),l+='" ',e.optional||(l+='class="required"'),l+=' type="radio" value="',l+=a(t),l+='" /> <span>',l+=a(t),l+="</span> </label> </div> "}),l+=" "):"multiple_choice"===e.type&&(l+=" ",i(e.choices,function(t){l+=' <div class="choice-item"> <label> <input name="',l+=a(e.field_name),l+='" ',e.optional||(l+='class="required"'),l+=' type="checkbox" value="',l+=a(t),l+='" /> <span>',l+=a(t),l+="</span> </label> </div> "}),l+=" "),l+=" </div> </div> "),l+=" "}),l+=" ",s&&(l+=' <div class="captcha-group"> <div class="group-title">驗證碼<span>*</span></div> <div class="group-content"> <div class="captcha-input"> <input id="surveyCaptcha" class="required" type="text" /> </div> <div class="captcha-img"> <img id="surveyCaptchaImg" src="" /> </div> </div> </div> '),l+=' <div class="btn-group"> <a id="surveySubmit">提交</a> </div> </div> '),l+=" ",new m(l)}),o("ticket-basic",function(e){"use strict";var t=this,n=(t.$helpers,e.intro),a=t.$escape,i=e.categories,o=t.$each,r=(e.val,e.key,t.$string),s=e.name,l=e.contactRule,u=e.tel,c=e.email,d=e.wechat,f=e.qq,p=e.defaultTemplate,g=e.defaultTemplateContent,v=e.captcha,h="";return h+='<div id="ticketV2" class="active"> ',n&&(h+=' <div class="step-title">',h+=a(n),h+="</div> "),h+=" ",i&&i.length>0&&(h+=' <div class="form-group"> <div class="group-title">分類<span>*</span></div> <div class="group-content"> ',o(i,function(e){h+=' <div class="choice-item"> <label> <input name="categories" type="radio" value="',h+=r(e.id),h+='" /> <span>',h+=r(e.name),h+="</span> </label> </div> "}),h+=" </div> </div> "),h+=" ","open"===s&&(h+=' <div class="form-group"> <div class="group-title"> 姓名 ',"multi"===l&&(h+=" <span>*</span> "),h+=' </div> <div class="group-content"> <input id="ticketName" type="text"> </div> </div> '),h+=" ","open"===u&&(h+=' <div class="form-group"> <div class="group-title"> 手機 ',"multi"===l&&(h+=" <span>*</span> "),h+=' </div> <div class="group-content"> <input id="ticketTel" type="text"> </div> </div> '),h+=" ","open"===c&&(h+=' <div class="form-group"> <div class="group-title"> 郵箱 ',"multi"===l&&(h+=" <span>*</span> "),h+=' </div> <div class="group-content"> <input id="ticketEmail" type="text"> </div> </div> '),h+=" ","open"===d&&(h+=' <div class="form-group"> <div class="group-title"> 微信 ',"multi"===l&&(h+=" <span>*</span> "),h+=' </div> <div class="group-content"> <input id="ticketWechat" type="text"> </div> </div> '),h+=" ","open"===f&&(h+=' <div class="form-group"> <div class="group-title"> QQ ',"multi"===l&&(h+=" <span>*</span> "),h+=' </div> <div class="group-content"> <input id="ticketQq" type="text"> </div> </div> '),h+=' <div class="form-group"> <div class="group-title">留言內容<span>*</span></div> <div class="group-content"> ',"open"===p?(h+=' <textarea id="ticketContent">',h+=a(g),h+="</textarea> "):h+=' <textarea id="ticketContent"></textarea> ',h+=" </div> </div> ","open"===v&&(h+=' <div class="captcha-group"> <div class="group-title">驗證碼<span>*</span></div> <div class="group-content"> <div class="captcha-input"> <input id="ticketCaptcha" class="required" type="text"/> </div> <div class="captcha-img"> <img id="ticketCaptchaImg" src="" /> </div> </div> </div> '),h+=' <div class="btn-group"> <a id="ticketSubmit">提交</a> </div> </div> ',new m(h)}),o("ticket",function(e){"use strict";var t=this,n=(t.$helpers,e.intro),a=t.$escape,i=e.categories,o=t.$each,r=(e.val,e.key,t.$string),s=e.name,l=e.contactRule,u=e.tel,c=e.email,d=e.wechat,f=e.qq,p=e.defaultTemplate,g=e.defaultTemplateContent,v=e.captcha,h="";return h+='<div id="ticketV2" class="active"> ',n&&(h+=' <div class="step-title">',h+=a(n),h+="</div> "),h+=" ",i&&i.length>0&&(h+=' <div class="form-group"> <div class="group-title">分類<span>*</span></div> <div class="group-content"> ',
o(i,function(e){h+=' <div class="choice-item"> <label> <input name="categories" type="radio" value="',h+=r(e.id),h+='" /> <span>',h+=r(e.name),h+="</span> </label> </div> "}),h+=" </div> </div> "),h+=" ","open"===s&&(h+=' <div class="form-group"> <div class="group-title"> 姓名 ',"multi"===l&&(h+=" <span>*</span> "),h+=' </div> <div class="group-content"> <input id="ticketName" type="text" placeholder=" 請輸入姓名"> </div> </div> '),h+=" ","open"===u&&(h+=' <div class="form-group"> <div class="group-title"> 手機 ',"multi"===l&&(h+=" <span>*</span> "),h+=' </div> <div class="group-content"> <input id="ticketTel" type="text" placeholder=" 請輸入手機號"> </div> </div> '),h+=" ","open"===c&&(h+=' <div class="form-group"> <div class="group-title"> 郵箱 ',"multi"===l&&(h+=" <span>*</span> "),h+=' </div> <div class="group-content"> <input id="ticketEmail" type="text" placeholder=" 請輸入郵箱"> </div> </div> '),h+=" ","open"===d&&(h+=' <div class="form-group"> <div class="group-title"> 微信 ',"multi"===l&&(h+=" <span>*</span> "),h+=' </div> <div class="group-content"> <input id="ticketWechat" type="text" placeholder=" 請輸入微信號"> </div> </div> '),h+=" ","open"===f&&(h+=' <div class="form-group"> <div class="group-title"> QQ ',"multi"===l&&(h+=" <span>*</span> "),h+=' </div> <div class="group-content"> <input id="ticketQq" type="text" placeholder=" 請輸入QQ號"> </div> </div> '),h+=' <div class="form-group"> <div class="group-title">留言內容<span>*</span></div> <div class="group-content"> ',"open"===p?(h+=' <textarea id="ticketContent" placeholder="請輸入留言內容">',h+=a(g),h+="</textarea> "):h+=' <textarea id="ticketContent" placeholder="請輸入留言內容"></textarea> ',h+=" </div> </div> ","open"===v&&(h+=' <div class="captcha-group"> <div class="group-title">驗證碼<span>*</span></div> <div class="group-content"> <div class="captcha-input"> <input id="ticketCaptcha" class="required" type="text" placeholder=" 請輸入右側驗證碼"/> </div> <div class="captcha-img"> <img id="ticketCaptchaImg" src="" /> </div> </div> </div> '),h+=' <div class="btn-group"> <a id="ticketSubmit">提交</a> </div> </div> ',new m(h)}),o("unable-service",function(e){"use strict";var t=this,n=(t.$helpers,t.$escape),a=e.src,i="";return i+='<img src="',i+=n(a),i+='"> <div>客服繁忙或已離線，給我們留言吧</div> <a class="btn-go-ticket">給我們留言</a> ',new m(i)}),o("icon-css",function(e){"use strict";var t=this,n=(t.$helpers,t.$escape),a=e.cdn,i=e.tail,o="";return o+='.icon { background-image: url("',o+=n(a),o+="/images/icon-desktop.png?v=",o+=n(i),o+='"); background-size: 44px auto; background-repeat: no-repeat; } .emoji-control { background-image: url("',o+=n(a),o+="/images/emoji.png?v=",o+=n(i),o+='"); background-size: 25px auto; background-repeat: no-repeat; } @media only screen and (-webkit-min-device-pixel-ratio: 2), only screen and (min--moz-device-pixel-ratio: 2), only screen and (-o-min-device-pixel-ratio: 2/1), only screen and (min-device-pixel-ratio: 2) { .icon { background-image: url("',o+=n(a),o+="/images/icon-desktop@2x.png?v=",o+=n(i),o+='"); } .emoji-control { background-image: url("',o+=n(a),o+="/images/emoji@2x.png?v=",o+=n(i),o+='"); } } ',new m(o)}),o("theme-css",function(e){"use strict";var t=this,n=(t.$helpers,t.$escape),a=e.bgColor,i=e.textColor,o=e.subTextColor,r=e.color2,s="";return s+="#pageChat .header, #pageTicket .header, #pageCall .header, #pageSurvey .header { background-color: ",s+=n(a),s+="; color: ",s+=n(i),s+="; } #pageChat #agentInputting { background-color: ",s+=n(a),s+="; } #pageChat .agent-signature { color: ",s+=n(o),s+=" } #pageChat .msg-client .bubble { background-color: ",s+=n(a),s+="; color: ",s+=n(i),s+="; } #pageChat .msg-client .bubble a { color: ",s+=n(i),s+="; } #pageChat .msg-client .arrow { border-left: 6px solid ",s+=n(a),s+="; } #pageChat .footer .feature-holder #btnSend.active { background-color: ",s+=n(a),s+="; color: ",s+=n(i),s+="; } #pageChat #unableService .btn-go-ticket { background-color: ",s+=n(a),s+="; color: ",s+=n(i),s+="; } #pageChat #evaluationSubmit { background-color: ",s+=n(a),s+="; color: ",s+=n(i),s+="; } #pageChat #queueingTips .queue-position-title { color: ",s+=n(a),s+="; } #pageChat #queueingTips #queueingPosition { color: ",s+=n(a),s+="; } #pageChat #queueingTips .btn-go-ticket { background-color: ",s+=n(a),s+="; color: ",s+=n(i),s+='; } #pageSurvey .body .menus-item > a, #pageChat .body-left .msg-bot .bubble .menu-item, #pageChat .body-left .msg-bot .rating a, #pageChat .body-left .msg-bot div.rich-text-bubble a, #pageChat .body-left .msg-agent div.rich-text-bubble a, #pageChat .body-left .msg-common-tips a, #autocomplete li em, #autocomplete li a[data-current="true"] { /*color: ',s+=n(a),s+=";*/ color: #6088e6; } #autocomplete li a:hover { background-color: ",s+=n(a),s+="; } ",s+="white"===r?" .icon-angel-down, .icon-ring-open, .icon-ring-close { opacity: .6; filter: alpha(opacity=60); } .icon-angel-down:hover, .icon-ring-open:hover, .icon-ring-close:hover { opacity: .8; filter: alpha(opacity=80); } .icon-angel-down { background-position: -22px -66px; } .icon-ring-open { background-position: -22px -89px; } .icon-ring-close { background-position: -22px -111px; } ":" .icon-angel-down, .icon-ring-open, .icon-ring-close { opacity: .3; filter: alpha(opacity=30); } .icon-angel-down:hover, .icon-ring-open:hover, .icon-ring-close:hover { opacity: .5; filter: alpha(opacity=50); } .icon-angel-down { background-position: 0 -66px; } .icon-ring-open { background-position: 0 -89px; } .icon-ring-close { background-position: 0 -111px; } ",s+=" #pageTicket #ticketSubmit { background-color: ",s+=n(a),s+="; color: ",s+=n(i),s+="; } #pageTicket #ticketDone { background-color: ",s+=n(a),s+="; color: ",s+=n(i),s+="; } #pageCall .input-active { border-color: ",s+=n(a),s+=" !important; } #pageCall .submit-active { background-color: ",s+=n(a),s+=" !important; } #pageCall .submit-intro { color: ",s+=n(a),s+="; } #pageCall .call-success-icon { background-color: ",s+=n(a),s+="; } #pageSurvey .menus-item >a { color: ",s+=n(a),s+="; } #pageSurvey #surveySubmit { background-color: ",s+=n(a),s+="; color: ",s+=n(i),s+="; } ",new m(s)})}()},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),o=a(i),r=n(16),s=a(r),l=n(4),u=a(l),c=function d(e){u["default"].inputting||!u["default"].scheduler||u["default"].isEnd||(e=e?e:document.getElementById("textarea").value.trim(),s["default"].ajax({url:o["default"].chat+"/client/inputting",type:"post",dataType:"json",contentType:"application/json",data:{ent_id:u["default"].entId,track_id:u["default"].trackId,content:e},beforeSend:function(){u["default"].inputting=!0},success:function(){setTimeout(function(){u["default"].inputting=!1,e!==document.getElementById("textarea").value.trim()&&d()},3e3)}}))};t["default"]=function(e){c(e)}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(13),o=a(i);t["default"]=function(e){var t=document.getElementById("btnSend");e?o["default"].addClass(t,"active"):o["default"].removeClass(t,"active")}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),o=a(i),r=n(16),s=a(r),l=n(13),u=a(l),c=n(4),d=a(c),f=n(61),p=a(f),g=n(32),m=(a(g),n(91)),v=a(m);t["default"]=function(e){var t=document.getElementById("photo"+e.id),n={client_id:d["default"].trackId,agent_id:d["default"].agentToken,conv_id:d["default"].convId,from:"client"},a=function(){s["default"].upload({url:o["default"].upload+"/upload",dataType:"json",data:n,beforeSend:function(){u["default"].removeClass(t,"photo-upload-fail"),t.src=o["default"].cdn+"/images/photo-sending.png"},success:function(n){n.success?d["default"].initData.scheduler_after_client_send_msg&&!d["default"].scheduler?(v["default"](),d["default"].fakeSentMsg.push({id:e.id,content_type:"photo",media_url:n.photo_url,content:n.photo_key}),document.getElementById("photoFile").value="",d["default"].loserClub[t.id]="",d["default"].schedulerMsg=!0,d["default"].initData.scheduler_after_client_send_msg=!1):d["default"].chatHasEnd?(v["default"](),d["default"].fakeSentMsg.push({id:e.id,content_type:"photo",media_url:n.photo_url,content:n.photo_key}),document.getElementById("photoFile").value="",d["default"].loserClub[t.id]="",d["default"].schedulerMsg=!0):(p["default"]({id:e.id,content_type:"photo",media_url:n.photo_url,content:n.photo_key}),document.getElementById("photoFile").value="",d["default"].loserClub[t.id]=""):(u["default"].addClass(t,"photo-upload-fail"),t.src=o["default"].cdn+"/images/photo-fail.png",d["default"].loserClub[t.id]=e)},error:function(){u["default"].addClass(t,"photo-upload-fail"),t.src=o["default"].cdn+"/images/photo-fail.png",d["default"].loserClub[t.id]=e}})};e.base64?(n.b64encoded=e.base64,n.filename=e.fileName,a()):document.createElement("canvas").getContext&&window.FileReader&&"mobile"===d["default"].device?!function(){var t=800,i=800,o=new FileReader;o.onload=function(o){var r=new Image;r.onload=function(){var o=r.width,s=r.height;if(o>t||s>i){var l=document.createElement("canvas");o>s?o>t&&(s*=t/o,o=t):s>i&&(o*=i/s,s=i),l.width=o,l.height=s,l.getContext("2d").drawImage(r,0,0,o,s),e.base64=l.toDataURL("image/png").split(",")[1],e.fileName=Math.random().toString(36).substr(2)+".png",n.b64encoded=e.base64,n.filename=e.fileName}else n.file=e.file;a()},r.src=o.target.result},o.readAsDataURL(e.file)}():(n.file=e.file,a())}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}function i(){r["default"].initData.agentTokens?l["default"]({agentToken:r["default"].initData.agentTokens}):r["default"].agentToken?l["default"]({agentToken:r["default"].agentToken}):r["default"].groupToken?l["default"]({groupToken:r["default"].groupToken}):l["default"]()}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=i;var o=n(4),r=a(o),s=n(32),l=a(s)},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(13),o=a(i),r=n(93),s=a(r),l=n(4),u=a(l),c=n(61),d=a(c),f=n(35),p=a(f),g=n(71),m=a(g),v=n(22),h=a(v),b=n(91),y=a(b);t["default"]=s["default"](function(){var e=document.getElementById("textarea"),t=e.value.trim();if(t){if(!u["default"].socket)return void h["default"]("服务连接中，请稍候…",5e3);e.value="",m["default"]("remove"),o["default"].removeClass(document.getElementById("btnSend"),"active");var n=1*new Date;u["default"].initData.scheduler_after_client_send_msg||u["default"].chatHasEnd||p["default"]([{id:n,from_type:"client",content_type:"text",status:"sending",content:t,type:"text"}]),u["default"].convId?u["default"].chatHasEnd?(y["default"](),u["default"].fakeSentMsg.push({id:n,content_type:"text",content:t}),u["default"].schedulerMsg=!0):d["default"]({id:n,content_type:"text",content:t}):u["default"].initData.scheduler_after_client_send_msg&&!u["default"].scheduler?(y["default"](),u["default"].fakeSentMsg.push({id:n,content_type:"text",content:t}),document.getElementById("msgHolder").innerHTML="",u["default"].initData.scheduler_after_client_send_msg=!1,u["default"].schedulerMsg=!0):u["default"].fakeSentMsg.push({id:n,content_type:"text",content:t})}},300,!0)},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=arguments;t["default"]=function(e,t,a){var i=void 0;return function(){var o=void 0,r=n,s=function(){i=null,a||e.apply(o,r)},l=a&&!i;clearTimeout(i),i=setTimeout(s,t),l&&e.apply(o,r)}}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),o=a(i),r=n(21),s=a(r),l=n(11),u=a(l),c=n(4),d=a(c),f=n(90),p=a(f),g=n(35),m=a(g),v=n(22),h=a(v);t["default"]=function(e){"desktop"===d["default"].device&&u["default"].isThisDevice("chrome")&&e.addEventListener("paste",function(e){if(e.clipboardData.items)for(var t=e.clipboardData.items,n=0,a=t.length;a>n;n++)t[n].type.match(/^image\//)&&!function(){var e=new FileReader,a=t[n].getAsFile();e.onload=function(e){var t=e.target.result.split(",")[1],n=/^image\/(.+)$/.exec(a.type);n=n?n[1]:"png";var i=Math.random().toString(36).substr(2)+"."+n;if(t&&i){var r={id:1*new Date,from_type:"client",content_type:"photo",status:"sending",media_url:o["default"].cdn+"/images/photo-sending.png",base64:t,fileName:i};m["default"]([r]),p["default"](r)}else h["default"](s["default"][d["default"].language].PastePictureFailed)},e.readAsDataURL(a)}()})}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),o=a(i),r=n(21),s=a(r),l=n(16),u=a(l),c=n(13),d=a(c),f=n(24),p=a(f),g=n(4),m=a(g),v=n(22),h=a(v),b=n(35),y=a(b),_=function(e,t){u["default"].ajax({url:o["default"].chat+"/conversation/"+m["default"].convId+"/evaluation",type:"post",contentType:"application/json",data:{level:e,content:t},beforeSend:function(){p["default"](document.getElementById("evaluationHolder"),"hide"),p["default"](document.getElementById("evaluationMask"),"hide")},success:function(n){if(n.success){var a=s["default"][m["default"].language].satisfied;0===e&&(a=s["default"][m["default"].language].Dissatisfied),1===e&&(a=s["default"][m["default"].language].Normal);var i={id:1*new Date,from_type:"evaluation",level:e,levelText:a,content:t};y["default"]([i])}else h["default"](s["default"][m["default"].language].EvaluationFailed,3e3)},error:function(){h["default"](s["default"][m["default"].language].EvaluationFailed,3e3)}})},w=function(e){document.getElementById("evaluationLevel").value=e,document.getElementById("evaluationHolder").className="",d["default"].addClass(document.getElementById("evaluationHolder"),"evaluation-active-"+e)};t["default"]={submit:_,select:w}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),o=a(i),r=n(21),s=a(r),l=n(16),u=a(l),c=n(49),d=a(c),f=n(97),p=a(f),g=n(61),m=a(g),v=n(98),h=a(v),b=n(4),y=a(b),_=n(32),w=(a(_),n(91)),k=a(w);t["default"]=function(e){var t=function(t){var n=document.getElementById("cancelUpload"+e.id),a=document.getElementById("fileState"+e.id),i=document.getElementById("progress"+e.id);n.addEventListener("click",function(){t.abort(),h["default"](e.extra),a.innerHTML=s["default"][y["default"].language].CancelUpload,i.style.display="none",n.style.display="none"})};u["default"].ajax({url:o["default"].chat+"/upload/policies",contentType:"application/json",type:"POST",data:{filename:e.extra.filename},success:function(n){var a={};for(var i in n.policy.fields)"Content-Type"!==i&&(a[i]=n.policy.fields[i]);a.file=e.file;var o=(new Date).getTime();u["default"].upload({url:n.policy.url,data:a,beforeSend:function(e){t(e),document.getElementById("uploadFile").value=""},progress:function(t){var n=t.position||t.loaded,a=t.totalSize||t.total,i=((new Date).getTime()-o)/1e3,r=d["default"](i?n/i:0);document.getElementById("progressBar"+e.id).style.width=Math.round(n/a*100)+"%",document.getElementById("speed"+e.id).innerHTML=r+"/s"},success:function(){y["default"].initData.scheduler_after_client_send_msg&&!y["default"].scheduler?(k["default"](),y["default"].fakeSentMsg.push({id:e.id,content_type:"file",content:n.policy.fields.key,extra:{filename:e.extra.filename,size:e.extra.size,type:e.extra.type,expire_at:p["default"]((new Date).setDate((new Date).getDate()+1))}}),y["default"].initData.scheduler_after_client_send_msg=!1):y["default"].chatHasEnd?(k["default"](),y["default"].fakeSentMsg.push({id:e.id,content_type:"file",content:n.policy.fields.key,extra:{filename:e.extra.filename,size:e.extra.size,type:e.extra.type,expire_at:p["default"]((new Date).setDate((new Date).getDate()+1))}}),y["default"].schedulerMsg=!0):m["default"]({id:e.id,content_type:"file",content:n.policy.fields.key,extra:{filename:e.extra.filename,size:e.extra.size,type:e.extra.type,expire_at:p["default"]((new Date).setDate((new Date).getDate()+1))}})},error:function(){document.getElementById("fileState"+e.id).innerHTML=s["default"][y["default"].language].UploadFailed,document.getElementById("cancelUpload"+e.id).style.display="none",document.getElementById("progress"+e.id).style.display="none"}})},error:function(){}})}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){return e.getUTCFullYear||(e=new Date(e)),e.getUTCFullYear()+"-"+a(e.getUTCMonth()+1)+"-"+a(e.getUTCDate())+"T"+a(e.getUTCHours())+":"+a(e.getUTCMinutes())+":"+a(e.getUTCSeconds())+"."+(e.getUTCMilliseconds()/1e6).toFixed(6).slice(2)};t["default"]=n;var a=function(e){return 10>e?"0"+e:e}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),o=a(i),r=n(16),s=a(r),l=n(4),u=a(l);t["default"]=function(e){s["default"].ajax({url:o["default"].chat+"/client/cancel_upload",type:"post",dataType:"json",contentType:"application/json",data:{ent_id:u["default"].entId,track_id:u["default"].trackId,conversation_id:u["default"].convId,browser_id:u["default"].browserId,type:e.type,size:e.size,filename:e.filename}})}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),o=a(i),r=n(16),s=a(r),l=n(4),u=a(l);t["default"]=function(e,t){s["default"].ajax({url:o["default"].chat+"/client/file_downloaded",type:"post",dataType:"json",contentType:"application/json",data:{ent_id:u["default"].entId,track_id:u["default"].trackId,conversation_id:t,msg_id:e}})}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),o=a(i),r=n(21),s=a(r),l=n(16),u=a(l),c=n(13),d=a(c),f=n(4),p=a(f),g=n(22),m=a(g),v=n(82),h=a(v),b=n(35),y=a(b);t["default"]=function(e){if(!e)return!1;var t=e.parentNode,n=t.getAttribute("data-question-id"),a="useful"===e.getAttribute("data-option")?1:0;if(!n)return!1;var i={ent_id:p["default"].entId,track_id:p["default"].trackId,useful:a,conv_id:p["default"].convId};u["default"].ajax({url:o["default"].chat+"/knowledge/questions/"+n+"/evaluate",type:"post",dataType:"json",contentType:"application/json",data:i,beforeSend:function(){d["default"].addClass(t,"pending")},success:function(e){d["default"].removeClass(t,"pending"),d["default"].addClass(t,"rated"),e.message&&y["default"]([{id:Math.random(),from_type:"bot",agent:{nickname:""},content_type:"text",content:e.message}]),i.useful||h["default"](s["default"][p["default"].language].dissatisfaction)},error:function(e){var n={};try{n=JSON.parse(e.responseText)}catch(a){}setTimeout(function(){m["default"](n.message||s["default"][p["default"].language].FailedSubmit,3e3),d["default"].removeClass(t,"pending")},1e3)}})}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),o=a(i),r=n(21),s=a(r),l=n(16),u=a(l),c=n(13),d=a(c),f=n(24),p=a(f),g=n(25),m=a(g),v=n(4),h=a(v),b=n(22),y=a(b);t["default"]=function(){function e(){u["default"].ajax({url:o["default"].chat+"/web_callback/calls",type:"post",dataType:"json",contentType:"application/json",header:l,data:r,beforeSend:function(){d["default"].addClass(t,"disabled")},success:function(){p["default"](document.getElementById("callForm"),"hide"),p["default"](document.getElementById("callSuccess"),"show"),d["default"].removeClass(t,"disabled")},error:function(e){var n={};try{n=JSON.parse(e.responseText),n.captcha_token&&(h["default"].callCaptchaToken=n.captcha_token,document.getElementById("captchaImg").src=n.captcha_image_url,d["default"].removeClass(a,"hide"))}catch(i){}y["default"](n.message||s["default"][h["default"].language].FailedSubmit,3e3),d["default"].removeClass(t,"disabled")}})}var t=document.getElementById("submitCall"),n=document.getElementById("callTel"),a=document.getElementById("captchaGroup"),i=document.getElementById("callCaptcha"),r={ent_id:h["default"].entId,track_id:h["default"].trackId},l=void 0;if(!m["default"].isPhoneNum(n.value))return y["default"](s["default"][h["default"].language].enterPhoneNumber,3e3),!1;if(r.phone=n.value,!d["default"].hasClass(a,"hide")){if(!i.value)return y["default"](s["default"][h["default"].language].correctVerification,3e3),!1;l={"Captcha-Value":i.value,"Captcha-Token":h["default"].callCaptchaToken}}d["default"].hasClass(t,"disabled")||e()}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}function i(){k&&k.abort&&k.abort()}function o(e,t){if(e>t){var n=[t,e];e=n[0],t=n[1]}var a=e-1;return{curr:function(){return a},prev:function(){return e>=a?a=t:a-=1},next:function(){return a>=t?a=e:a+=1}}}function r(e){e&&e.getAttribute&&(document.getElementById("textarea").value=(e.getAttribute("data-question")||"").replace(/<em>|<\/em>/g,""))}function s(e){if(!e.length)return!1;var t=h.map(e.slice(0,8),function(e){return'\n        <li>\n            <a class="autocomplete-item" data-question="'+e.question+'">\n                '+e.question+"\n            </a>\n        </li>\n    "}).join(""),n=document.getElementById("autocomplete");if(!n){n=document.createElement("div"),n.id="autocomplete",I&&(n.style.border="1px solid #f0f0f0");var a=document.getElementById("msgWrapper");a&&a.parentNode&&a.parentNode.appendChild(n)}n.innerHTML="<ul>"+t+"</ul>",E=n.getElementsByTagName("a");for(var i=0;i<E.length;++i)!function(e){e.onclick=function(){r(e),S.remove(),y["default"]()},e.onmouseenter=function(){var e=E[T.curr()];T&&e&&e.removeAttribute("data-current")}}(E[i]);T=o(0,E.length-1)}function l(e,t){return i(),x[e]?t(x[e]):void(k=g["default"].ajax({url:c["default"].chat+"/robot/auto_complete",type:"get",data:{text:e,ent_id:f["default"].entId},success:function(n){n&&n.success&&t(x[e]=n.data||[])}}))}Object.defineProperty(t,"__esModule",{value:!0});var u=n(2),c=a(u),d=n(4),f=a(d),p=n(16),g=a(p),m=n(51),v=a(m),h=n(50),b=n(92),y=a(b),_=n(103),w=a(_),k=null,x={},T=null,E=[],C="",I=!w["default"]("box-shadow"),S={search:function(e){return C===e?!1:f["default"].isBot?v["default"].string(e)&&e.length?(C=e,void l(e,s)):S.remove():!1},remove:function(){i();var e=document.getElementById("autocomplete");return e&&e.parentNode.removeChild(e),T=null,E=[],C="",!1},select:function(e){var t=document.getElementById("autocomplete");if(t&&T&&E.length){var n=E[T.curr()];n&&n.removeAttribute("data-current"),/^(prev|next)$/.test(e)&&T[e](),r(n=E[T.curr()]),n&&n.setAttribute("data-current","true")}}};t["default"]=S},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e){var t=document.createElement("div"),n="Ms O Moz Webkit".split(" "),a=n.length;if(e in t.style)return!0;for(e=e.replace(/^[a-z]/,function(e){return e.toUpperCase()});a--;)if(n[a]+e in t.style)return!0;return!1}},,,,,,,,,,,,,,,function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}var i=n(2),o=a(i),r=n(3),s=a(r),l=n(4),u=a(l),c=n(5),d=a(c),f=n(7),p=a(f),g=n(79),m=a(g),v=n(84),h=a(v);u["default"].type="normal",u["default"].style="fiesta",u["default"].device="desktop",u["default"].isBasic=!1,u["default"].tpl=s["default"],u["default"].language="zh",u["default"].handleSocketMsg=m["default"],document.getElementById("audioHolder").innerHTML=u["default"].tpl("audio",{cdn:o["default"].cdn}),d["default"].loadBtnBgi("icon-css"),p["default"](),h["default"](),u["default"].messenger.targets.parent.send("chatReady^@#true")}]);